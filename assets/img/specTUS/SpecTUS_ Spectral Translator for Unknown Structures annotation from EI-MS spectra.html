<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra</title>
<!--Generated on Fri Feb  7 17:32:54 2025 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2502.05114v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A1" title="In SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A1.SS1" title="In Appendix A Results ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Baseline results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A1.SS2" title="In Appendix A Results ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>SpecTUS results</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A2" title="In SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Methods</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A3" title="In SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A3.SS1" title="In Appendix C Experiments ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.1 </span>Experiment 1: Intensity binning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A3.SS2" title="In Appendix C Experiments ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.2 </span>Experiment 2: Molecular Representations and Tokenization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A3.SS3" title="In Appendix C Experiments ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.3 </span>Experiment 3: Pretraining dataset mixing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A3.SS4" title="In Appendix C Experiments ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.4 </span>Experiment 4: Source indication</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A3.SS5" title="In Appendix C Experiments ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.5 </span>Experiment 5: Training length and dataset size</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_fleqn">
<div class="ltx_para" id="p1">
<p class="ltx_p" id="p1.1">[1]<span class="ltx_ERROR undefined" id="p1.1.1">\fnm</span>Aleš <span class="ltx_ERROR undefined" id="p1.1.2">\sur</span>Křenek</p>
</div>
<div class="ltx_para" id="p2">
<p class="ltx_p" id="p2.1">1]<span class="ltx_ERROR undefined" id="p2.1.1">\orgdiv</span>Institute of Computer Science, <span class="ltx_ERROR undefined" id="p2.1.2">\orgname</span>Masaryk University,<span class="ltx_ERROR undefined" id="p2.1.3">\orgaddress</span>Šumavská 525/33, <span class="ltx_ERROR undefined" id="p2.1.4">\city</span>Brno, <span class="ltx_ERROR undefined" id="p2.1.5">\postcode</span>602 00, <span class="ltx_ERROR undefined" id="p2.1.6">\country</span>Czech Republic
2]<span class="ltx_ERROR undefined" id="p2.1.7">\orgdiv</span>RECETOX, Faculty of Science, <span class="ltx_ERROR undefined" id="p2.1.8">\orgname</span>Masaryk University, <span class="ltx_ERROR undefined" id="p2.1.9">\orgaddress</span>Kotlářská 2, <span class="ltx_ERROR undefined" id="p2.1.10">\city</span>Brno, <span class="ltx_ERROR undefined" id="p2.1.11">\postcode</span>611 37, <span class="ltx_ERROR undefined" id="p2.1.12">\country</span>Czech Republic</p>
</div>
<h1 class="ltx_title ltx_title_document">SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_ERROR undefined" id="id1.1.id1">\fnm</span>Adam <span class="ltx_ERROR undefined" id="id2.2.id2">\sur</span>Hájek
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:ahajek@mail.muni.cz">ahajek@mail.muni.cz</a>
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_ERROR undefined" id="id3.1.id1">\fnm</span>Helge <span class="ltx_ERROR undefined" id="id4.2.id2">\sur</span>Hecht
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:helge.hecht@recetox.muni.cz">helge.hecht@recetox.muni.cz</a>
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_ERROR undefined" id="id5.1.id1">\fnm</span>Elliott J. <span class="ltx_ERROR undefined" id="id6.2.id2">\sur</span>Price
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:elliott.price@recetox.muni.cz">elliott.price@recetox.muni.cz</a>
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:ljocha@ics.muni.cz">ljocha@ics.muni.cz</a>
</span>
<span class="ltx_contact ltx_role_affiliation">[
</span>
<span class="ltx_contact ltx_role_affiliation">[
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id7.id1">Compound identification and structure annotation from mass spectra is a well-established task widely applied in drug detection, criminal forensics, small molecule biomarker discovery and chemical engineering.</p>
<p class="ltx_p" id="id8.id2">We propose SpecTUS: Spectral Translator for Unknown Structures, a deep neural model that addresses the task of structural annotation of small molecules from low-resolution gas chromatography electron ionization mass spectra (GC-EI-MS). Our model analyzes the spectra in <span class="ltx_text ltx_font_italic" id="id8.id2.1">de novo</span> manner – a direct translation from the spectra into 2D-structural representation. Our approach is particularly useful for analyzing compounds unavailable in spectral libraries.</p>
<p class="ltx_p" id="id9.id3">In a rigorous evaluation of our model on the novel structure annotation task across different libraries, we outperformed standard database search techniques by a wide margin. On a held-out testing set, including <span class="ltx_text ltx_number" id="id9.id3.1">28 267</span> spectra from the NIST database, we show that our model’s single suggestion perfectly reconstructs 43% of the subset’s compounds.
This single suggestion is strictly better than the candidate of the database hybrid search (common method among practitioners)
in 76% of cases.
In a still affordable scenario of 10 suggestions, perfect reconstruction is achieved in 65%, and 84% are better than
the hybrid search.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>GC-EI-MS, GC-MS, mass spectrometry, gas chromatography, transformer, electron ionization, NMT, deep learning, machine learning, spectra reconstruction, compound annotation
</div>
<div class="ltx_para" id="p3">
<p class="ltx_p" id="p3.1">Gas chromatography-mass spectrometry (GC-MS) is a widely used method for identifying compounds, particularly those that are volatile and thermally stable. In the first stage, compounds are separated via gas chromatography. Next, neutral molecules are ionized, generating charged ions for analysis. The MS then measures the mass-to-charge ratio (m/z) of each fragment, along with the abundance of fragments at each m/z value. After processing, this analysis produces a mass spectrum for each compound, represented as a series of peaks. Each peak corresponds to a unique fragment mass and is encoded as a pair of m/z value and its relative intensity, reflecting the fragment’s abundance in the sample.
</p>
</div>
<div class="ltx_para" id="p4">
<p class="ltx_p" id="p4.1">Different mass spectrometry methods produce spectra with distinct characteristics based on, amongst other factors, the ionization technique and the number of spectrometry iterations. One of the most widely used, established methods is GC-EI-MS, where EI stands for electron ionization. A standard electron energy of 70 eV has been used for decades, ensuring relative consistency across spectra and compatibility of different spectral libraries. However, the variation in spectra still persists <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib1" title="">1</a>]</cite>. As this approach is central to our research, GC-EI-MS will be the focus of this study.</p>
</div>
<div class="ltx_para" id="p5">
<p class="ltx_p" id="p5.1">Compound identification from GC-EI-MS spectra has been approached in three main ways: <span class="ltx_text ltx_font_italic" id="p5.1.1">database search, extended database search,</span> and <span class="ltx_text ltx_font_italic" id="p5.1.2">de novo generation.</span></p>
</div>
<div class="ltx_para" id="p6">
<p class="ltx_p" id="p6.1">In a standard database search, we compare the spectrum against a library of experimentally measured reference spectra using either simple similarity search (SSS) or hybrid similarity search (HSS) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib3" title="">3</a>]</cite>. SSS, which matches only peaks with the same (similar) m/z value, is effective when the compound being analyzed is present in the spectral library, a scenario known as the <span class="ltx_text ltx_font_italic" id="p6.1.1">spectral match</span> task. When the compound is absent from the library – the <span class="ltx_text ltx_font_italic" id="p6.1.2">closest structure identification</span> task – HSS typically performs better. This method incorporates structural information by matching neutral losses in addition to fragment ions. HSS calculates these neutral losses by shifting one of the spectra based on the molecular weight difference (DeltaMass) between the query and library compounds. However, for HSS to work accurately, a precise DeltaMass is required, which depends on the molecular weight of the query compound — a value that is not always reliably estimated from GC-EI-MS spectra.
A widely used GCMS-ID webserver <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib4" title="">4</a>]</cite> implements similar search approach combined with scoring on retention index;
together with an impressive collection of curated references spectra
it represents the state-of-the-art in standard database search.</p>
</div>
<div class="ltx_para" id="p7">
<p class="ltx_p" id="p7.1">Extended search approaches aim to address the limited size of spectral databases by expanding the scope of references available for comparison.
One extreme from among these methods is an <em class="ltx_emph ltx_font_italic" id="p7.1.1">ab-initio</em> generation of synthetic EI-MS spectra, as implemented in QCEIMS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib5" title="">5</a>]</cite>,
by simulating the fragmentation with quantum-chemical calculation.
However, achieving sufficient accuracy requires high-level methods (e.g., DFT), making this approach impractical for large-scale database generation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib6" title="">6</a>]</cite>.</p>
</div>
<div class="ltx_para" id="p8">
<p class="ltx_p" id="p8.1">Another approach to EI spectra generation is rule-based prediction <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib7" title="">7</a>]</cite>. In this family of approaches commercial software such as MS-Fragmenter <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib8" title="">8</a>]</cite> exists, but those lack open source code and algorithm transparency.</p>
</div>
<div class="ltx_para" id="p9">
<p class="ltx_p" id="p9.1">Machine learning-based methods offer a faster alternative for generating synthetic spectra, though often at the cost of losing some accuracy. NEIMS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib9" title="">9</a>]</cite> algorithmically computes the extended connectivity fingerprints (ECFP) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib10" title="">10</a>]</cite> of a molecular structure and feeds it into a smartly designed multilayer perceptron to generate a low-resolution synthetic EI-MS spectrum. The model, trained on <span class="ltx_text ltx_number" id="p9.1.1">240 000</span> experimental spectra from the NIST-17 dataset, is known for its simplicity and reasonable reliability, making it the foundation of several other methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib12" title="">12</a>]</cite>. A more sophisticated alternative, RASSP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib13" title="">13</a>]</cite>,
processes the structural formula augmented by atomic features with a graph neural network (GNN).
The GNN output is passed to an attention-equipped neural network to predict fragments and their relative abundances. These fragments are then transformed into an EI-MS spectrum using exact atomic masses and isotopic patterns, producing high-resolution outputs. Compared to NEIMS, RASSP generates more accurate spectra but is limited to a small set of atom types (8 in the published version) and by the number of possible fragment formulae (4096).</p>
</div>
<div class="ltx_para" id="p10">
<p class="ltx_p" id="p10.1">To improve accuracy and search speed in extended spectral databases, recent methods leverage machine learning to map EI-MS spectra into alternative vector spaces. DeepEI <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib11" title="">11</a>]</cite> is a model trained to translate spectra into molecular fingerprints
which can be rapidly computed for vast structural libraries such as ZINC or PubChem, moving the similarity search into the space of fingerprints. FastEI <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib12" title="">12</a>]</cite> combines NEIMS with a spectral embedding method inspired by Word2Vec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib14" title="">14</a>]</cite>, producing vector representations (embeddings) of spectra that later serve for rapid library searching.</p>
</div>
<div class="ltx_para" id="p11">
<p class="ltx_p" id="p11.1">To address the challenges of coverage and information loss from intermediate translations, recent <span class="ltx_text ltx_font_italic" id="p11.1.1">de novo</span> methods directly translate spectra into molecular structures. Inspired by neural machine translation architectures, these methods typically generate SMILES <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib15" title="">15</a>]</cite> strings autoregressively based on encoded spectral information.</p>
</div>
<div class="ltx_para" id="p12">
<p class="ltx_p" id="p12.1">So far, all the <span class="ltx_text ltx_font_italic" id="p12.1.1">de novo</span> models have been exclusively trained on tandem mass spectrometry spectra (LC-MS/MS) resulting from a two-staged fragmentation process. In the first stage, the method uses soft ionization process (ESI) that enables extracting the precursor ion mass (approximately the molecular mass of the analyzed compound). The precursor ion is further fragmented by hard ionization process in the second stage yielding a mass spectrum similar, yet not comparable, to EI-MS.</p>
</div>
<div class="ltx_para" id="p13">
<p class="ltx_p" id="p13.1">For instance, MassGenie <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib16" title="">16</a>]</cite>, a <math alttext="\sim" class="ltx_Math" display="inline" id="p13.1.m1.1"><semantics id="p13.1.m1.1a"><mo id="p13.1.m1.1.1" xref="p13.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="p13.1.m1.1b"><csymbol cd="latexml" id="p13.1.m1.1.1.cmml" xref="p13.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="p13.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="p13.1.m1.1d">∼</annotation></semantics></math>400 million parameter encoder-decoder transformer, maps MS/MS spectra, represented as embeddings of m/z values combined with positional encoding into SMILES strings. It was pretrained on 4.7 million synthetic spectra and finetuned on approximately <span class="ltx_text ltx_number" id="p13.1.1">200 000</span> experimental spectra from the GNPS dataset. Similarly, Spec2Mol <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib17" title="">17</a>]</cite> separately trains a GRU autoencoder on 138 million SMILES strings, creating a latent space of molecular structures. Further, the trained GRU decoder is combined with a CNN encoder that learns to map experimental MS/MS spectra to the GRU’s molecular latent space using <span class="ltx_text ltx_number" id="p13.1.2">28 000</span> examples from the NIST library. MSNovelist <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib18" title="">18</a>]</cite> employs an RNN encoder-decoder architecture relying on SIRIUS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib19" title="">19</a>]</cite> to predict a molecular formula and structural fingerprint from MS/MS spectra. The encoder maps these inputs onto a latent space vector used further by an LSTM decoder to generate a SMILES string character-by-character, aided by a continuously updated molecular subformula representing remaining atoms. The model was trained on a dataset combining HMDB, COCONUT, and DSSTox databases comprising 1.2 million molecular structures. Another method, MS2Mol <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib20" title="">20</a>]</cite>, employs an encoder-decoder transformer enhanced with precursor mass information trained on around 1 million MS/MS spectra. The model emphasizes output ordering optimization with a dedicated re-ranking model. Finally, Mass2SMILES <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib21" title="">21</a>]</cite> utilizes a smaller transformer encoder paired with a TCN decoder and explores variational autoencoders with continuous latent space generation trained on <span class="ltx_text ltx_number" id="p13.1.3">83 000</span> experimental MS/MS spectra from the GNPS dataset.</p>
</div>
<div class="ltx_para" id="p14">
<p class="ltx_p" id="p14.1">While tandem MS enables richer analysis and can yield precursor ion weights or even formulas of compounds, the method’s increased complexity introduces more adjustable parameters. Due to the lack of consensus on standard settings, its variability can reduce consistency across spectral libraries.</p>
</div>
<div class="ltx_para" id="p15">
<p class="ltx_p" id="p15.1">We argue that despite missing precursor ion weight, the character and consistency of EI-MS spectra make them a well-suited representation for machine learning models focused on molecular structure annotation. In this paper, we introduce SpecTUS: a <em class="ltx_emph ltx_font_italic" id="p15.1.1">Spectral Translator for Unknown Structure reconstruction from low-resolution EI-MS spectra</em>. At its core, SpecTUS is a 354 million parameter encoder-decoder transformer model that takes encoded mass spectrum as input and directly generates molecular structure as a SMILES string. The model can produce an arbitrary number of candidate structures, each accompanied by an inherent certainty score.</p>
</div>
<div class="ltx_para" id="p16">
<p class="ltx_p" id="p16.1">Our training process began with pretraining on a synthetic dataset of <math alttext="2\times 8.6" class="ltx_Math" display="inline" id="p16.1.m1.1"><semantics id="p16.1.m1.1a"><mrow id="p16.1.m1.1.1" xref="p16.1.m1.1.1.cmml"><mn id="p16.1.m1.1.1.2" xref="p16.1.m1.1.1.2.cmml">2</mn><mo id="p16.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="p16.1.m1.1.1.1.cmml">×</mo><mn id="p16.1.m1.1.1.3" xref="p16.1.m1.1.1.3.cmml">8.6</mn></mrow><annotation-xml encoding="MathML-Content" id="p16.1.m1.1b"><apply id="p16.1.m1.1.1.cmml" xref="p16.1.m1.1.1"><times id="p16.1.m1.1.1.1.cmml" xref="p16.1.m1.1.1.1"></times><cn id="p16.1.m1.1.1.2.cmml" type="integer" xref="p16.1.m1.1.1.2">2</cn><cn id="p16.1.m1.1.1.3.cmml" type="float" xref="p16.1.m1.1.1.3">8.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="p16.1.m1.1c">2\times 8.6</annotation><annotation encoding="application/x-llamapun" id="p16.1.m1.1d">2 × 8.6</annotation></semantics></math> million spectra generated by NEIMS and RASSP models, believed to capture sufficient foundation knowledge on the structure-spectra relationships.
We then finetuned SpecTUS on <span class="ltx_text ltx_number" id="p16.1.1">232 025</span> clean, experimentally measured spectra from NIST20 (NIST/EPA/NIH Mass Spectral Library of electron ionization spectra, 2020 version) to adjust to true experimental data. Additionally, we conducted experiments to assess the impact of various pretraining strategies, tokenization schemes, and input encoding methods, adapting the model to suit the spectra-to-molecules translation task as closely as possible. Our evaluation demonstrates that SpecTUS effectively identifies unseen compounds, showcasing its potential for accurate, rapid structure annotation from EI-MS spectra.</p>
</div>
<div class="ltx_para" id="p17">
<p class="ltx_p" id="p17.1">Alongside the paper, we release two datasets containing the synthetic spectra generated by NEIMS and RASSP models, NIST20 splits used for training, the pretrained SpecTUS model, and all necessary training and evaluation scripts, accompanied by a detailed tutorial. These scripts allow fine-tuning of the model on selected data and, with the necessary permissions, enable the reproduction of results using NIST20.</p>
</div>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Results</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">SpecTUS evaluation was driven by the motivation to demonstrate that the method is capable of <span class="ltx_text ltx_font_italic" id="Sx1.p1.1.1">generalization</span>,
i.e. it captures knowledge contained in the training data and is able to apply it to unseen spectra of unseen compounds.</p>
</div>
<div class="ltx_para" id="Sx1.p2">
<p class="ltx_p" id="Sx1.p2.1">Moreover, we show that SpecTUS outperformed traditional database search methods when identifying compounds not present in the reference database. This highlights its capability to address the limitations of existing approaches in the compound identification task.</p>
</div>
<section class="ltx_subsection" id="Sx1.SSx1">
<h3 class="ltx_title ltx_title_subsection">Baselines</h3>
<div class="ltx_para" id="Sx1.SSx1.p1">
<p class="ltx_p" id="Sx1.SSx1.p1.1">We compared SpecTUS against database search methods using the NIST20 dataset, where the SpecTUS training set (<span class="ltx_text ltx_number" id="Sx1.SSx1.p1.1.1">232 035</span> spectra, see Sect. <a class="ltx_ref ltx_refmacro_nameref" href="https://arxiv.org/html/2502.05114v1#Sx3.SSx4" title="In Methods ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_title">Finetuning dataset</span></a> for details) served as the reference library for database search and disjoint testing sets were used as queries. The reference library did not overlap with any test or validation data, it remained representative for practical applications in terms of size.</p>
</div>
<div class="ltx_para" id="Sx1.SSx1.p2">
<p class="ltx_p" id="Sx1.SSx1.p2.1">Our evaluation included the following baselines:</p>
<ul class="ltx_itemize" id="Sx1.I1">
<li class="ltx_item" id="Sx1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I1.i1.p1">
<p class="ltx_p" id="Sx1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="Sx1.I1.i1.p1.1.1">Simple Similarity Search (SSS)</span>:
This method is universally applicable for database searches as it does not rely on any additional measurements or precise molecular weight (MW) estimates. It matches query spectra to the library based purely on spectral similarity, computed as augmented cosine similarity on a set of matching peak pairs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib3" title="">3</a>]</cite>.</p>
</div>
</li>
<li class="ltx_item" id="Sx1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I1.i2.p1">
<p class="ltx_p" id="Sx1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="Sx1.I1.i2.p1.1.1">Hybrid Similarity Search (HSS)</span>:
The most commonly used method for closest structure identification from a database. HSS combines fragment ion matching with neutral loss analysis and incorporates the molecular weight of the query compound into the computation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib3" title="">3</a>]</cite>. While effective, HSS depends on knowing the molecular weight information, which is not always reliably determined from EI-MS spectra.
However, for our evaluation purposes, we provide the weight available in the testing sets, which biases the results towards better HSS performance compared to the real-world scenario.</p>
</div>
</li>
<li class="ltx_item" id="Sx1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I1.i3.p1">
<p class="ltx_p" id="Sx1.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="Sx1.I1.i3.p1.1.1">Best Database Candidate (BDC)</span>:
For this baseline, the best candidate is selected based on structural similarity between the query compound and reference compounds, measured by Tanimoto similarity over Morgan fingerprints <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib10" title="">10</a>]</cite>.
This approach is artificial and we don’t have access to it in real-world scenarios, because the analyte’s structure is precisely what we aim to determine.
We use BDC to determine the upper bound for database search methods.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="Sx1.SSx1.p2.2">These baselines reflect both standard practices and theoretical limits of conventional methods for spectra identification.
Therefore we are on the safe side; in a real-world scenario, better results are unlikely (if possible at all) to be achieved.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx1.SSx2">
<h3 class="ltx_title ltx_title_subsection">Metrics</h3>
<div class="ltx_para" id="Sx1.SSx2.p1">
<p class="ltx_p" id="Sx1.SSx2.p1.1">Evaluation of SpecTUS performance, its comparison with the baseline, as well as with other solutions is based on
several metrics we describe briefly in this section.
Detailed formal definitions of those can be found in Sect. <a class="ltx_ref ltx_refmacro_nameref" href="https://arxiv.org/html/2502.05114v1#Sx3" title="In SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_title">Methods</span></a>.
All the metrics assume they are applied on a given test set of spectra for which the structures (ground truth) are known.</p>
</div>
<div class="ltx_para" id="Sx1.SSx2.p2">
<p class="ltx_p" id="Sx1.SSx2.p2.4">For a given set of test spectra,
<span class="ltx_text ltx_font_bold" id="Sx1.SSx2.p2.1.1">top-<math alttext="k" class="ltx_Math" display="inline" id="Sx1.SSx2.p2.1.1.m1.1"><semantics id="Sx1.SSx2.p2.1.1.m1.1a"><mi id="Sx1.SSx2.p2.1.1.m1.1.1" xref="Sx1.SSx2.p2.1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx1.SSx2.p2.1.1.m1.1b"><ci id="Sx1.SSx2.p2.1.1.m1.1.1.cmml" xref="Sx1.SSx2.p2.1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx1.SSx2.p2.1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="Sx1.SSx2.p2.1.1.m1.1d">italic_k</annotation></semantics></math> accuracy</span> (<math alttext="\text{Acc}_{k}" class="ltx_Math" display="inline" id="Sx1.SSx2.p2.2.m1.1"><semantics id="Sx1.SSx2.p2.2.m1.1a"><msub id="Sx1.SSx2.p2.2.m1.1.1" xref="Sx1.SSx2.p2.2.m1.1.1.cmml"><mtext id="Sx1.SSx2.p2.2.m1.1.1.2" xref="Sx1.SSx2.p2.2.m1.1.1.2a.cmml">Acc</mtext><mi id="Sx1.SSx2.p2.2.m1.1.1.3" xref="Sx1.SSx2.p2.2.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="Sx1.SSx2.p2.2.m1.1b"><apply id="Sx1.SSx2.p2.2.m1.1.1.cmml" xref="Sx1.SSx2.p2.2.m1.1.1"><csymbol cd="ambiguous" id="Sx1.SSx2.p2.2.m1.1.1.1.cmml" xref="Sx1.SSx2.p2.2.m1.1.1">subscript</csymbol><ci id="Sx1.SSx2.p2.2.m1.1.1.2a.cmml" xref="Sx1.SSx2.p2.2.m1.1.1.2"><mtext id="Sx1.SSx2.p2.2.m1.1.1.2.cmml" xref="Sx1.SSx2.p2.2.m1.1.1.2">Acc</mtext></ci><ci id="Sx1.SSx2.p2.2.m1.1.1.3.cmml" xref="Sx1.SSx2.p2.2.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.SSx2.p2.2.m1.1c">\text{Acc}_{k}</annotation><annotation encoding="application/x-llamapun" id="Sx1.SSx2.p2.2.m1.1d">Acc start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>)
lets the model predict <math alttext="k" class="ltx_Math" display="inline" id="Sx1.SSx2.p2.3.m2.1"><semantics id="Sx1.SSx2.p2.3.m2.1a"><mi id="Sx1.SSx2.p2.3.m2.1.1" xref="Sx1.SSx2.p2.3.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx1.SSx2.p2.3.m2.1b"><ci id="Sx1.SSx2.p2.3.m2.1.1.cmml" xref="Sx1.SSx2.p2.3.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx1.SSx2.p2.3.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="Sx1.SSx2.p2.3.m2.1d">italic_k</annotation></semantics></math> structures for each spectrum, and it counts the ratio of spectra for which
a structure matching the ground truth exactly is present among the <math alttext="k" class="ltx_Math" display="inline" id="Sx1.SSx2.p2.4.m3.1"><semantics id="Sx1.SSx2.p2.4.m3.1a"><mi id="Sx1.SSx2.p2.4.m3.1.1" xref="Sx1.SSx2.p2.4.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx1.SSx2.p2.4.m3.1b"><ci id="Sx1.SSx2.p2.4.m3.1.1.cmml" xref="Sx1.SSx2.p2.4.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx1.SSx2.p2.4.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="Sx1.SSx2.p2.4.m3.1d">italic_k</annotation></semantics></math> predictions.</p>
</div>
<div class="ltx_para" id="Sx1.SSx2.p3">
<p class="ltx_p" id="Sx1.SSx2.p3.4"><span class="ltx_text ltx_font_bold" id="Sx1.SSx2.p3.1.1">Average top-<math alttext="k" class="ltx_Math" display="inline" id="Sx1.SSx2.p3.1.1.m1.1"><semantics id="Sx1.SSx2.p3.1.1.m1.1a"><mi id="Sx1.SSx2.p3.1.1.m1.1.1" xref="Sx1.SSx2.p3.1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx1.SSx2.p3.1.1.m1.1b"><ci id="Sx1.SSx2.p3.1.1.m1.1.1.cmml" xref="Sx1.SSx2.p3.1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx1.SSx2.p3.1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="Sx1.SSx2.p3.1.1.m1.1d">italic_k</annotation></semantics></math> similarity</span> (Sim<sub class="ltx_sub" id="Sx1.SSx2.p3.4.2"><span class="ltx_text ltx_font_italic" id="Sx1.SSx2.p3.4.2.1">k</span></sub>) quantifies how structurally similar, on average, the most accurate candidate among the first <math alttext="k" class="ltx_Math" display="inline" id="Sx1.SSx2.p3.3.m2.1"><semantics id="Sx1.SSx2.p3.3.m2.1a"><mi id="Sx1.SSx2.p3.3.m2.1.1" xref="Sx1.SSx2.p3.3.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx1.SSx2.p3.3.m2.1b"><ci id="Sx1.SSx2.p3.3.m2.1.1.cmml" xref="Sx1.SSx2.p3.3.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx1.SSx2.p3.3.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="Sx1.SSx2.p3.3.m2.1d">italic_k</annotation></semantics></math> retrieved molecules is to the ground truth molecule. For each query, the similarity is calculated as the highest Tanimoto similarity between the Morgan fingerprints of the ground truth molecule and each of the first <math alttext="k" class="ltx_Math" display="inline" id="Sx1.SSx2.p3.4.m3.1"><semantics id="Sx1.SSx2.p3.4.m3.1a"><mi id="Sx1.SSx2.p3.4.m3.1.1" xref="Sx1.SSx2.p3.4.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx1.SSx2.p3.4.m3.1b"><ci id="Sx1.SSx2.p3.4.m3.1.1.cmml" xref="Sx1.SSx2.p3.4.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx1.SSx2.p3.4.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="Sx1.SSx2.p3.4.m3.1d">italic_k</annotation></semantics></math> retrieved candidates. The similarities are then averaged over all queries in the testing set.</p>
</div>
<div class="ltx_para" id="Sx1.SSx2.p4">
<p class="ltx_p" id="Sx1.SSx2.p4.1">To compare two methods, we introduce <span class="ltx_text ltx_font_bold" id="Sx1.SSx2.p4.1.1">win rate</span> of the first method over the other
as the ratio of spectra in the test set for which the best structure from <math alttext="k" class="ltx_Math" display="inline" id="Sx1.SSx2.p4.1.m1.1"><semantics id="Sx1.SSx2.p4.1.m1.1a"><mi id="Sx1.SSx2.p4.1.m1.1.1" xref="Sx1.SSx2.p4.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx1.SSx2.p4.1.m1.1b"><ci id="Sx1.SSx2.p4.1.m1.1.1.cmml" xref="Sx1.SSx2.p4.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx1.SSx2.p4.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="Sx1.SSx2.p4.1.m1.1d">italic_k</annotation></semantics></math> predictions is strictly better
for the first method than the best structure for the other method.
To overcome certain blindness of Morgan fingerprints, we define that an exact structural match always wins;
otherwise (there is no exact match for either method), better Tanimoto similarity of Morgan fingerprints wins.
Similarly, the <span class="ltx_text ltx_font_bold" id="Sx1.SSx2.p4.1.2">at-least-as-good rate</span> complements the win rate, that is, draws are counted in favor of the first method too.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx1.SSx3">
<h3 class="ltx_title ltx_title_subsection">Scenarios</h3>
<div class="ltx_para" id="Sx1.SSx3.p1">
<p class="ltx_p" id="Sx1.SSx3.p1.1">We evaluated the model’s performance in three scenarios, varying the number of returned candidates: 1, 10, and 50. As the number of candidates increased, the overall top-<math alttext="k" class="ltx_Math" display="inline" id="Sx1.SSx3.p1.1.m1.1"><semantics id="Sx1.SSx3.p1.1.m1.1a"><mi id="Sx1.SSx3.p1.1.m1.1.1" xref="Sx1.SSx3.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx1.SSx3.p1.1.m1.1b"><ci id="Sx1.SSx3.p1.1.m1.1.1.cmml" xref="Sx1.SSx3.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx1.SSx3.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="Sx1.SSx3.p1.1.m1.1d">italic_k</annotation></semantics></math> performance improved, demonstrating the model’s ability to provide more comprehensive predictions. However, while the model assigns sequence probabilities to rank its generated candidates, this ranking is not sufficiently reliable to replace expert evaluation. For instance, the model’s top-ranked candidate from a set of 10 is, on average, slightly less accurate than the one candidate generated in the single-candidate scenario. This suggests that manual expert validation remains crucial for multi-candidate scenarios. Consequently, we did not use the model-based ranking during evaluation. The three evaluated scenarios are as follows:</p>
<ul class="ltx_itemize" id="Sx1.I2">
<li class="ltx_item" id="Sx1.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I2.i1.p1">
<p class="ltx_p" id="Sx1.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="Sx1.I2.i1.p1.1.1">Single-candidate scenario (SpecTUS<sub class="ltx_sub" id="Sx1.I2.i1.p1.1.1.1"><span class="ltx_text ltx_font_medium" id="Sx1.I2.i1.p1.1.1.1.1">1</span></sub>)</span>: Requires no manual intervention but has lower accuracy, making it suitable for high-throughput workflows where speed is prioritized over precision.</p>
</div>
</li>
<li class="ltx_item" id="Sx1.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I2.i2.p1">
<p class="ltx_p" id="Sx1.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="Sx1.I2.i2.p1.1.1">Ten-candidate scenario (SpecTUS<sub class="ltx_sub" id="Sx1.I2.i2.p1.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="Sx1.I2.i2.p1.1.1.1.1">10</span></sub>)</span>: Offers a balanced trade-off, providing sufficient diversity in predictions while keeping manual evaluation manageable. This makes it particularly well-suited for practical use in analysis workflows.</p>
</div>
</li>
<li class="ltx_item" id="Sx1.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I2.i3.p1">
<p class="ltx_p" id="Sx1.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="Sx1.I2.i3.p1.1.1">Fifty-candidate scenario (SpecTUS<sub class="ltx_sub" id="Sx1.I2.i3.p1.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="Sx1.I2.i3.p1.1.1.1.1">50</span></sub>)</span>: Demonstrates the model’s potential for providing highly accurate predictions but at the cost of substantial manual effort to evaluate all candidates.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="Sx1.SSx3.p1.2">By tailoring the number of generated candidates to the specific application, users can leverage the model’s strengths while balancing accuracy and effort.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx1.SSx4">
<h3 class="ltx_title ltx_title_subsection">Datasets</h3>
<div class="ltx_para" id="Sx1.SSx4.p1">
<p class="ltx_p" id="Sx1.SSx4.p1.1">To evaluate SpecTUS, we used a held-out NIST20 test split along with several publicly available libraries, including SWGDRUG, Cayman, and MONA. The NIST20 and SWGDRUG databases provide highly curated spectra, making them ideal for training and validation. In contrast, testing on the Cayman and MONA libraries allowed us to assess the model’s performance on spectra collected and processed with less standardized methods, highlighting the challenges posed by varying spectral acquisition techniques.</p>
</div>
<div class="ltx_para" id="Sx1.SSx4.p2">
<p class="ltx_p" id="Sx1.SSx4.p2.1">To demonstrate the generalization capabilities of SpecTUS, we carefully filtered all test sets to exclude any compounds present in the synthetic or experimental training datasets. Additionally, compounds containing deuterium, which was not included in the training datasets, were removed and model-specific filters were applied – a maximum m/z value of 500, a maximum of 300 peaks per spectrum and maximum SMILES length of 100 characters. The vast majority of spectra removed from SWGDRUG, Cayman library and MONA were excluded due to overlap with NIST20 training set.</p>
</div>
<div class="ltx_para" id="Sx1.SSx4.p3">
<p class="ltx_p" id="Sx1.SSx4.p3.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#Sx1.T1" title="Table 1 ‣ Datasets ‣ Results ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">1</span></a> provides a detailed overview of the final dataset sizes before and after filtering.</p>
</div>
<figure class="ltx_table" id="Sx1.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>The number of spectra in each test library before and after filtering. The filtering included removing overlaps with NIST training set, removing compounds containing deuterium and filtering out datapoints with m/z exceeding 500, more than 300 peaks or SMILES string exceeding 100 characters.</figcaption>
<table class="ltx_tabular ltx_align_middle" id="Sx1.T1.1">
<tr class="ltx_tr" id="Sx1.T1.1.1">
<td class="ltx_td ltx_border_r" id="Sx1.T1.1.1.1"></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="Sx1.T1.1.1.2">NIST test</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="Sx1.T1.1.1.3">SWGDRUG</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="Sx1.T1.1.1.4">Cayman</td>
<td class="ltx_td ltx_align_right" id="Sx1.T1.1.1.5">MONA</td>
</tr>
<tr class="ltx_tr" id="Sx1.T1.1.2">
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="Sx1.T1.1.2.1">original size</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="Sx1.T1.1.2.2">29218</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="Sx1.T1.1.2.3">3589</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="Sx1.T1.1.2.4">2262</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="Sx1.T1.1.2.5">18914</td>
</tr>
<tr class="ltx_tr" id="Sx1.T1.1.3">
<td class="ltx_td ltx_align_right ltx_border_r" id="Sx1.T1.1.3.1">used for testing</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="Sx1.T1.1.3.2">28267</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="Sx1.T1.1.3.3">1640</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="Sx1.T1.1.3.4">469</td>
<td class="ltx_td ltx_align_right" id="Sx1.T1.1.3.5">5015</td>
</tr>
</table>
</figure>
</section>
<section class="ltx_subsection" id="Sx1.SSx5">
<h3 class="ltx_title ltx_title_subsection">Baseline results</h3>
<figure class="ltx_figure" id="Sx1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="240" id="Sx1.F1.g1" src="extracted/6187077/figures/db_comparison.png" width="269"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Percentage of cases where database search methods (SSS and HSS) successfully retrieved the closest structure from the reference database among the top-1, top-10, and top-50 suggested candidates. Performance is evaluated across all test sets: NIST test split, SWGDRUG, Cayman, and MONA.</figcaption>
</figure>
<div class="ltx_para" id="Sx1.SSx5.p1">
<p class="ltx_p" id="Sx1.SSx5.p1.1">First, we compared SSS and HSS, to the upper-bound based on structural similarity (BDC) to quantify the limitations of current database search methods (Figure <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#Sx1.F1" title="Figure 1 ‣ Baseline results ‣ Results ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">1</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A1.T3" title="Table 3 ‣ A.1 Baseline results ‣ Appendix A Results ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">3</span></a>). The analysis focuses on the percentage of cases where the standard database search methods (SSS, HSS) successfully retrieved the most structurally similar compound from the database among their top-<math alttext="k" class="ltx_Math" display="inline" id="Sx1.SSx5.p1.1.m1.1"><semantics id="Sx1.SSx5.p1.1.m1.1a"><mi id="Sx1.SSx5.p1.1.m1.1.1" xref="Sx1.SSx5.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx1.SSx5.p1.1.m1.1b"><ci id="Sx1.SSx5.p1.1.m1.1.1.cmml" xref="Sx1.SSx5.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx1.SSx5.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="Sx1.SSx5.p1.1.m1.1d">italic_k</annotation></semantics></math> candidates. Importantly, this metric does not evaluate the quality of the retrieved candidates relative to the ground truth; rather, it highlights how standard database search methods perform within the inherent constraints of database searching. Across all test sets (NIST test, SWGDRUG, Cayman, and MONA), several patterns emerged.</p>
</div>
<div class="ltx_para" id="Sx1.SSx5.p2">
<p class="ltx_p" id="Sx1.SSx5.p2.1">First, the performance of database search methods was relatively consistent across datasets, except for MONA,
possibly due to higher occurrence of TOF spectra or generally less thorough curation. Surprisingly, results for the NIST test set were lower than those of SWGDRUG and Cayman, despite better curation of the NIST library.</p>
</div>
<div class="ltx_para" id="Sx1.SSx5.p3">
<p class="ltx_p" id="Sx1.SSx5.p3.2">Second, HSS consistently outperformed SSS, demonstrating its superiority across all datasets. However, even HSS struggled to retrieve the best candidate as the top-50 candidate list did not surpass the 60% success rate, and the performance of HSS<sub class="ltx_sub" id="Sx1.SSx5.p3.2.1"><span class="ltx_text ltx_font_italic" id="Sx1.SSx5.p3.2.1.1">10</span></sub> hovered around 50% at maximum. On the other hand, SSS failed to exceed the 30% success rate, even with 50 retrieved candidates, and SSS<sub class="ltx_sub" id="Sx1.SSx5.p3.2.2">1</sub> retrieved the optimal candidate in only around 10% cases.</p>
</div>
<div class="ltx_para" id="Sx1.SSx5.p4">
<p class="ltx_p" id="Sx1.SSx5.p4.1">Finally, the number of retrieved candidates significantly impacts performance. Extending the list from 1 to 10 candidates yields a substantial improvement, but further extending it to 50 candidates offers only marginal additional gains, especially considering the increased workload for experts required to manually evaluate these candidates. For practical purposes, retrieving a single candidate is insufficient, delivering the correct structure in only about 20% cases (HSS), depending on spectrum quality.</p>
</div>
<div class="ltx_para" id="Sx1.SSx5.p5">
<p class="ltx_p" id="Sx1.SSx5.p5.1">These findings confirmed that current standard database search methods, while commonly used in practice, have limits in identifying unknown compounds.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx1.SSx6">
<h3 class="ltx_title ltx_title_subsection">SpecTUS results</h3>
<figure class="ltx_figure" id="Sx1.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="259" id="Sx1.F2.g1" src="extracted/6187077/figures/acc_simk.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Comparison average similarity and accuracy metrics across all tested methods, testing datasets, and three retrieval scenarios (1, 10, and 50 candidates). <span class="ltx_text ltx_font_italic" id="Sx1.F2.12.1">ST</span> represents SpecTUS, while the abbreviations of the baseline database search methods (<span class="ltx_text ltx_font_italic" id="Sx1.F2.13.2">SSS</span>, <span class="ltx_text ltx_font_italic" id="Sx1.F2.14.3">HSS</span>) are explained in the text – Section <a class="ltx_ref ltx_refmacro_nameref" href="https://arxiv.org/html/2502.05114v1#Sx1.SSx1" title="In Results ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_title">Baselines</span></a>. Sim<sub class="ltx_sub" id="Sx1.F2.15.4"><span class="ltx_text ltx_font_italic" id="Sx1.F2.15.4.1">k</span></sub> is displayed by the color bars, similarity of the theoretical upper bound for database search methods (<span class="ltx_text ltx_font_italic" id="Sx1.F2.16.5">BDC</span>) is expressed as a pink dashed line.
<math alttext="\text{Acc}_{k}" class="ltx_Math" display="inline" id="Sx1.F2.5.m2.1"><semantics id="Sx1.F2.5.m2.1b"><msub id="Sx1.F2.5.m2.1.1" xref="Sx1.F2.5.m2.1.1.cmml"><mtext id="Sx1.F2.5.m2.1.1.2" xref="Sx1.F2.5.m2.1.1.2a.cmml">Acc</mtext><mi id="Sx1.F2.5.m2.1.1.3" xref="Sx1.F2.5.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="Sx1.F2.5.m2.1c"><apply id="Sx1.F2.5.m2.1.1.cmml" xref="Sx1.F2.5.m2.1.1"><csymbol cd="ambiguous" id="Sx1.F2.5.m2.1.1.1.cmml" xref="Sx1.F2.5.m2.1.1">subscript</csymbol><ci id="Sx1.F2.5.m2.1.1.2a.cmml" xref="Sx1.F2.5.m2.1.1.2"><mtext id="Sx1.F2.5.m2.1.1.2.cmml" xref="Sx1.F2.5.m2.1.1.2">Acc</mtext></ci><ci id="Sx1.F2.5.m2.1.1.3.cmml" xref="Sx1.F2.5.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.F2.5.m2.1d">\text{Acc}_{k}</annotation><annotation encoding="application/x-llamapun" id="Sx1.F2.5.m2.1e">Acc start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> values for SpecTUS are shown in black lines, they are inherently zero for all the other methods. The three <math alttext="\text{Acc}_{k}" class="ltx_Math" display="inline" id="Sx1.F2.6.m3.1"><semantics id="Sx1.F2.6.m3.1b"><msub id="Sx1.F2.6.m3.1.1" xref="Sx1.F2.6.m3.1.1.cmml"><mtext id="Sx1.F2.6.m3.1.1.2" xref="Sx1.F2.6.m3.1.1.2a.cmml">Acc</mtext><mi id="Sx1.F2.6.m3.1.1.3" xref="Sx1.F2.6.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="Sx1.F2.6.m3.1c"><apply id="Sx1.F2.6.m3.1.1.cmml" xref="Sx1.F2.6.m3.1.1"><csymbol cd="ambiguous" id="Sx1.F2.6.m3.1.1.1.cmml" xref="Sx1.F2.6.m3.1.1">subscript</csymbol><ci id="Sx1.F2.6.m3.1.1.2a.cmml" xref="Sx1.F2.6.m3.1.1.2"><mtext id="Sx1.F2.6.m3.1.1.2.cmml" xref="Sx1.F2.6.m3.1.1.2">Acc</mtext></ci><ci id="Sx1.F2.6.m3.1.1.3.cmml" xref="Sx1.F2.6.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.F2.6.m3.1d">\text{Acc}_{k}</annotation><annotation encoding="application/x-llamapun" id="Sx1.F2.6.m3.1e">Acc start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> values in each column correspond to 1, 10, and 50 candidates, displayed from bottom to top.</figcaption>
</figure>
<div class="ltx_para" id="Sx1.SSx6.p1">
<p class="ltx_p" id="Sx1.SSx6.p1.1">The essential results of SpecTUS comparison with thraditional database search methods are shown in
Fig. <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#Sx1.F2" title="Figure 2 ‣ SpecTUS results ‣ Results ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">2</span></a> and Fig. <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#Sx1.F3" title="Figure 3 ‣ SpecTUS results ‣ Results ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">3</span></a>.
The tables with exact values supporting the figures are included in Sect. <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A1.SS2" title="A.2 SpecTUS results ‣ Appendix A Results ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">A.2</span></a>.</p>
</div>
<div class="ltx_para" id="Sx1.SSx6.p2">
<p class="ltx_p" id="Sx1.SSx6.p2.5">SpecTUS’ capability to generate candidates it has not encountered during training allows it to accurately reconstruct compounds that database search cannot identify precisely.
As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#Sx1.F2" title="Figure 2 ‣ SpecTUS results ‣ Results ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">2</span></a>, with just one candidate, the SpecTUS accuracy (finding the correct compound) Acc<sub class="ltx_sub" id="Sx1.SSx6.p2.5.1">1</sub> is 43% on the NIST test set. With 10 candidates, it reached the accuracy of 65%. For the less curated datasets, the <math alttext="\text{Acc}_{k}" class="ltx_Math" display="inline" id="Sx1.SSx6.p2.2.m2.1"><semantics id="Sx1.SSx6.p2.2.m2.1a"><msub id="Sx1.SSx6.p2.2.m2.1.1" xref="Sx1.SSx6.p2.2.m2.1.1.cmml"><mtext id="Sx1.SSx6.p2.2.m2.1.1.2" xref="Sx1.SSx6.p2.2.m2.1.1.2a.cmml">Acc</mtext><mi id="Sx1.SSx6.p2.2.m2.1.1.3" xref="Sx1.SSx6.p2.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="Sx1.SSx6.p2.2.m2.1b"><apply id="Sx1.SSx6.p2.2.m2.1.1.cmml" xref="Sx1.SSx6.p2.2.m2.1.1"><csymbol cd="ambiguous" id="Sx1.SSx6.p2.2.m2.1.1.1.cmml" xref="Sx1.SSx6.p2.2.m2.1.1">subscript</csymbol><ci id="Sx1.SSx6.p2.2.m2.1.1.2a.cmml" xref="Sx1.SSx6.p2.2.m2.1.1.2"><mtext id="Sx1.SSx6.p2.2.m2.1.1.2.cmml" xref="Sx1.SSx6.p2.2.m2.1.1.2">Acc</mtext></ci><ci id="Sx1.SSx6.p2.2.m2.1.1.3.cmml" xref="Sx1.SSx6.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.SSx6.p2.2.m2.1c">\text{Acc}_{k}</annotation><annotation encoding="application/x-llamapun" id="Sx1.SSx6.p2.2.m2.1d">Acc start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> lowered, but even for the MONA dataset, SpecTUS reached <math alttext="\text{Acc}_{1}" class="ltx_Math" display="inline" id="Sx1.SSx6.p2.3.m3.1"><semantics id="Sx1.SSx6.p2.3.m3.1a"><msub id="Sx1.SSx6.p2.3.m3.1.1" xref="Sx1.SSx6.p2.3.m3.1.1.cmml"><mtext id="Sx1.SSx6.p2.3.m3.1.1.2" xref="Sx1.SSx6.p2.3.m3.1.1.2a.cmml">Acc</mtext><mn id="Sx1.SSx6.p2.3.m3.1.1.3" xref="Sx1.SSx6.p2.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="Sx1.SSx6.p2.3.m3.1b"><apply id="Sx1.SSx6.p2.3.m3.1.1.cmml" xref="Sx1.SSx6.p2.3.m3.1.1"><csymbol cd="ambiguous" id="Sx1.SSx6.p2.3.m3.1.1.1.cmml" xref="Sx1.SSx6.p2.3.m3.1.1">subscript</csymbol><ci id="Sx1.SSx6.p2.3.m3.1.1.2a.cmml" xref="Sx1.SSx6.p2.3.m3.1.1.2"><mtext id="Sx1.SSx6.p2.3.m3.1.1.2.cmml" xref="Sx1.SSx6.p2.3.m3.1.1.2">Acc</mtext></ci><cn id="Sx1.SSx6.p2.3.m3.1.1.3.cmml" type="integer" xref="Sx1.SSx6.p2.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.SSx6.p2.3.m3.1c">\text{Acc}_{1}</annotation><annotation encoding="application/x-llamapun" id="Sx1.SSx6.p2.3.m3.1d">Acc start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> of 21% and <math alttext="\text{Acc}_{10}" class="ltx_Math" display="inline" id="Sx1.SSx6.p2.4.m4.1"><semantics id="Sx1.SSx6.p2.4.m4.1a"><msub id="Sx1.SSx6.p2.4.m4.1.1" xref="Sx1.SSx6.p2.4.m4.1.1.cmml"><mtext id="Sx1.SSx6.p2.4.m4.1.1.2" xref="Sx1.SSx6.p2.4.m4.1.1.2a.cmml">Acc</mtext><mn id="Sx1.SSx6.p2.4.m4.1.1.3" xref="Sx1.SSx6.p2.4.m4.1.1.3.cmml">10</mn></msub><annotation-xml encoding="MathML-Content" id="Sx1.SSx6.p2.4.m4.1b"><apply id="Sx1.SSx6.p2.4.m4.1.1.cmml" xref="Sx1.SSx6.p2.4.m4.1.1"><csymbol cd="ambiguous" id="Sx1.SSx6.p2.4.m4.1.1.1.cmml" xref="Sx1.SSx6.p2.4.m4.1.1">subscript</csymbol><ci id="Sx1.SSx6.p2.4.m4.1.1.2a.cmml" xref="Sx1.SSx6.p2.4.m4.1.1.2"><mtext id="Sx1.SSx6.p2.4.m4.1.1.2.cmml" xref="Sx1.SSx6.p2.4.m4.1.1.2">Acc</mtext></ci><cn id="Sx1.SSx6.p2.4.m4.1.1.3.cmml" type="integer" xref="Sx1.SSx6.p2.4.m4.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.SSx6.p2.4.m4.1c">\text{Acc}_{10}</annotation><annotation encoding="application/x-llamapun" id="Sx1.SSx6.p2.4.m4.1d">Acc start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT</annotation></semantics></math> of 34%. The <math alttext="\text{Acc}_{k}" class="ltx_Math" display="inline" id="Sx1.SSx6.p2.5.m5.1"><semantics id="Sx1.SSx6.p2.5.m5.1a"><msub id="Sx1.SSx6.p2.5.m5.1.1" xref="Sx1.SSx6.p2.5.m5.1.1.cmml"><mtext id="Sx1.SSx6.p2.5.m5.1.1.2" xref="Sx1.SSx6.p2.5.m5.1.1.2a.cmml">Acc</mtext><mi id="Sx1.SSx6.p2.5.m5.1.1.3" xref="Sx1.SSx6.p2.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="Sx1.SSx6.p2.5.m5.1b"><apply id="Sx1.SSx6.p2.5.m5.1.1.cmml" xref="Sx1.SSx6.p2.5.m5.1.1"><csymbol cd="ambiguous" id="Sx1.SSx6.p2.5.m5.1.1.1.cmml" xref="Sx1.SSx6.p2.5.m5.1.1">subscript</csymbol><ci id="Sx1.SSx6.p2.5.m5.1.1.2a.cmml" xref="Sx1.SSx6.p2.5.m5.1.1.2"><mtext id="Sx1.SSx6.p2.5.m5.1.1.2.cmml" xref="Sx1.SSx6.p2.5.m5.1.1.2">Acc</mtext></ci><ci id="Sx1.SSx6.p2.5.m5.1.1.3.cmml" xref="Sx1.SSx6.p2.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.SSx6.p2.5.m5.1c">\text{Acc}_{k}</annotation><annotation encoding="application/x-llamapun" id="Sx1.SSx6.p2.5.m5.1d">Acc start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> for any database search method in this scenario is inherently 0%.</p>
</div>
<div class="ltx_para" id="Sx1.SSx6.p3">
<p class="ltx_p" id="Sx1.SSx6.p3.1">On the NIST test and SWGDRUG datasets, which contain thoroughly curated spectra, SpecTUS achieved an average top-1 similarity of 0.67 and 0.69, respectively,
outperforming HSS even with 50 candidates (62 for NIST and 0.61 for SWGDRUG), and it approached the theoretical best database performance that reached 0.72 for NIST and 0.69 for SWGDRUG.</p>
</div>
<div class="ltx_para" id="Sx1.SSx6.p4">
<p class="ltx_p" id="Sx1.SSx6.p4.1">In the ten-candidate scenario, SpecTUS improved further, achieving average similarities of 0.81 on NIST and 0.82 on SWGDRUG, surpassing even the theoretical limit of database search (BDC); this is an evidence of SpecTUS’ capability to generalize beyond
the search among known structures.</p>
</div>
<div class="ltx_para" id="Sx1.SSx6.p5">
<p class="ltx_p" id="Sx1.SSx6.p5.1">For less curated datasets, such as Cayman Library and MONA, the performance gap between SpecTUS and database search methods has narrowed. However, even on these datasets, a single SpecTUS prediction matched the performance of 10 candidates retrieved by HSS.</p>
</div>
<figure class="ltx_figure" id="Sx1.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="212" id="Sx1.F3.g1" src="extracted/6187077/figures/win_rate_hss.png" width="287"/></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="214" id="Sx1.F3.g2" src="extracted/6187077/figures/win_rate_bdc.png" width="287"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Comparison of win rate and at-least-as-good rate of SpecTUS over database search method HSS (<span class="ltx_text ltx_font_bold" id="Sx1.F3.11.1">A</span>) and a theoretical database search upper bound BDC (<span class="ltx_text ltx_font_bold" id="Sx1.F3.12.2">B</span>) across all testing datasets, and three retrieval scenarios (1, 10, and 50 candidates). The diagram evaluates corresponding retrieval scenarios, such as SpecTUS<sub class="ltx_sub" id="Sx1.F3.13.3"><span class="ltx_text ltx_font_italic" id="Sx1.F3.13.3.1">10</span></sub> versus HSS<sub class="ltx_sub" id="Sx1.F3.14.4"><span class="ltx_text ltx_font_italic" id="Sx1.F3.14.4.1">10</span></sub> (Win<math alttext="(\text{SpecTUS}_{10},\text{HSS}_{10}" class="ltx_math_unparsed" display="inline" id="Sx1.F3.6.m3.1"><semantics id="Sx1.F3.6.m3.1b"><mrow id="Sx1.F3.6.m3.1c"><mo id="Sx1.F3.6.m3.1.1" stretchy="false">(</mo><msub id="Sx1.F3.6.m3.1.2"><mtext id="Sx1.F3.6.m3.1.2.2">SpecTUS</mtext><mn id="Sx1.F3.6.m3.1.2.3">10</mn></msub><mo id="Sx1.F3.6.m3.1.3">,</mo><msub id="Sx1.F3.6.m3.1.4"><mtext id="Sx1.F3.6.m3.1.4.2">HSS</mtext><mn id="Sx1.F3.6.m3.1.4.3">10</mn></msub></mrow><annotation encoding="application/x-tex" id="Sx1.F3.6.m3.1d">(\text{SpecTUS}_{10},\text{HSS}_{10}</annotation><annotation encoding="application/x-llamapun" id="Sx1.F3.6.m3.1e">( SpecTUS start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT , HSS start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT</annotation></semantics></math>), providing a direct comparison of performance under identical conditions.</figcaption>
</figure>
<div class="ltx_para" id="Sx1.SSx6.p6">
<p class="ltx_p" id="Sx1.SSx6.p6.1">The <span class="ltx_text ltx_font_italic" id="Sx1.SSx6.p6.1.1">win</span> and <span class="ltx_text ltx_font_italic" id="Sx1.SSx6.p6.1.2">at least as good</span> rates of SpecTUS compared to HSS and BDC across datasets (Figure <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#Sx1.F3" title="Figure 3 ‣ SpecTUS results ‣ Results ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">3</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A1.T8" title="Table 8 ‣ A.2 SpecTUS results ‣ Appendix A Results ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">8</span></a>) further illustrate the model’s strengths. When compared to HSS (Figure <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#Sx1.F3" title="Figure 3 ‣ SpecTUS results ‣ Results ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">3</span></a>A), SpecTUS consistently performed better on more rigorously curated spectra (NIST test, SWGDRUG) and benefited more from generating additional candidates, except on the MONA dataset. Specifically, SpecTUS achieved win rates of 76–86% on NIST, 72–85% on SWGDRUG, 63–74% on Cayman, and 62–65% on MONA. When draws were included, the <span class="ltx_text ltx_font_italic" id="Sx1.SSx6.p6.1.3">at least as good</span> rate increased further, reaching 80–90% on the NIST test and SWGDRUG datasets. These findings demonstrate that SpecTUS is a far more reliable candidate generator for identifying novel molecules than standard HSS.</p>
</div>
<div class="ltx_para" id="Sx1.SSx6.p7">
<p class="ltx_p" id="Sx1.SSx6.p7.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#Sx1.F3" title="Figure 3 ‣ SpecTUS results ‣ Results ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">3</span></a>B shows SpecTUS’ comparison with BDC, highlighting its ability to outperform even the best candidates in the database. On the NIST test and SWGDRUG datasets, a single SpecTUS candidate was strictly better than BDC in 47% and 45% cases, respectively.
However, with 10 candidates, SpecTUS outperformed BDC in 70% of the cases for both the NIST test and SWGDRUG and in 56% cases for the Cayman library. The <span class="ltx_text ltx_font_italic" id="Sx1.SSx6.p7.1.1">at least as good</span> rate of SpecTUS<sub class="ltx_sub" id="Sx1.SSx6.p7.1.2"><span class="ltx_text ltx_font_italic" id="Sx1.SSx6.p7.1.2.1">10</span></sub> again raised the bar a bit higher, ranging between 72–74% on the NIST test and SWGDRUG datasets. The <span class="ltx_text ltx_font_italic" id="Sx1.SSx6.p7.1.3">win rate</span> on the MONA dataset ranged from 21-40% which mirrors SpecTUS’ decreased performance on less curated spectra. Again, these results show SpecTUS’ ability to effectively generalize over training data and to help mitigate the database coverage issue.</p>
</div>
<div class="ltx_para" id="Sx1.SSx6.p8">
<p class="ltx_p" id="Sx1.SSx6.p8.1">For the complete results comparing SpecTUS with database search methods, refer to the supplementary tables in <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A1.T8" title="Table 8 ‣ A.2 SpecTUS results ‣ Appendix A Results ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx1.SSx7">
<h3 class="ltx_title ltx_title_subsection">Examples</h3>
<div class="ltx_para" id="Sx1.SSx7.p1">
<p class="ltx_p" id="Sx1.SSx7.p1.2">To better understand the predictive performance of SpecTUS and HSS, we analyzed their Sim<sub class="ltx_sub" id="Sx1.SSx7.p1.2.1"><span class="ltx_text ltx_font_italic" id="Sx1.SSx7.p1.2.1.1">10</span></sub> scores on 200 randomly sampled queries from the NIST test set. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#Sx1.F4" title="Figure 4 ‣ Examples ‣ Results ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">4</span></a>, the scatterplot compares the Sim<sub class="ltx_sub" id="Sx1.SSx7.p1.2.2"><span class="ltx_text ltx_font_italic" id="Sx1.SSx7.p1.2.2.1">10</span></sub> scores of both models, with the dashed diagonal indicating equal performance. Notably, SpecTUS achieved a perfect Tanimoto similarity score of 1 in 65% of the queries, highlighting its ability to make accurate predictions more consistently than HSS. Additionally, five examples, highlighted in red on the scatterplot and detailed in the accompanying table, were handpicked to illustrate common error types that occur during predictions.</p>
</div>
<div class="ltx_para" id="Sx1.SSx7.p2">
<p class="ltx_p" id="Sx1.SSx7.p2.1">One frequent error involves extending or shortening repetitive chains, as seen in example 2 for HSS and example 5 for SpecTUS. Another typical issue is the addition of a correct functional group but on an incorrect atom in an aromatic ring, such as in example 1 (SpecTUS) and example 2 (SpecTUS). A third type of error involves accurately decoding large molecular substructures but incorrectly connecting them, as illustrated in example 3 (SpecTUS). These examples serve to visually highlight typical challenges in molecular prediction tasks and provide a sense of how such errors look in practice.</p>
</div>
<div class="ltx_para" id="Sx1.SSx7.p3">
<p class="ltx_p" id="Sx1.SSx7.p3.1">Example 5 also highlights a limitation of the Tanimoto similarity metric when applied to molecular fingerprints. HSS prediction, in this case, achieves a perfect similarity score despite representing a different molecule from the ground truth. This issue arises particularly in long, repetitive chains, where structural differences may not impact the fingerprint representation. Tanimoto similarity is a useful and widely used measure, but its limitations should be considered, especially in cases where structural nuances are critical.</p>
</div>
<figure class="ltx_figure" id="Sx1.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="167" id="Sx1.F4.g1" src="extracted/6187077/figures/examples.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The scatterplot on the <span class="ltx_text ltx_font_bold" id="Sx1.F4.15.1">left</span> illustrates the Sim<sub class="ltx_sub" id="Sx1.F4.16.2"><span class="ltx_text ltx_font_italic" id="Sx1.F4.16.2.1">10</span></sub> scores for 200 randomly sampled queries from the NIST test set, comparing SpecTUS and HSS predictions. Each point represents a single query, with its position determined by the Sim<sub class="ltx_sub" id="Sx1.F4.17.3"><span class="ltx_text ltx_font_italic" id="Sx1.F4.17.3.1">10</span></sub> scores of SpecTUS (x-axis) and HSS (y-axis). The dashed line indicates where both models achieved identical Sim<sub class="ltx_sub" id="Sx1.F4.18.4"><span class="ltx_text ltx_font_italic" id="Sx1.F4.18.4.1">10</span></sub> values. Notably, 65% of the SpecTUS predictions reached a perfect Tanimoto similarity of 1.
Highlighted in red are five specific examples, further detailed in the <span class="ltx_text ltx_font_bold" id="Sx1.F4.19.5">table on the right</span>. For each example, the ground truth molecule (<span class="ltx_text ltx_font_italic" id="Sx1.F4.20.6">Label</span>) and the predictions from HSS and SpecTUS are shown, along with their Tanimoto similarity (T) to the label, computed using Morgan fingerprints. For faster comparison, correctly predicted regions are marked with <span class="ltx_text ltx_font_italic" id="Sx1.F4.21.7">green ellipses</span>, while errors are enclosed in <span class="ltx_text ltx_font_italic" id="Sx1.F4.22.8">red ellipses</span>. These examples were hand-picked to illustrate typical errors and highlight specific regions of the scatterplot.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="Sx1.SSx8">
<h3 class="ltx_title ltx_title_subsection">Inference speed</h3>
<div class="ltx_para" id="Sx1.SSx8.p1">
<p class="ltx_p" id="Sx1.SSx8.p1.1">The size of SpecTUS (354 million parameters) allows the model to be powerful enough to handle the task at hand yet lightweight enough to be meaningfully used in practical applications. To demonstrate its potential usage scenarios, we benchmarked SpecTUS inference on three hardware setups: a high-end GPU, a mid-range GPU, and a laptop-like CPU configuration. While exact prediction speeds depend on the specific hardware used, we provide a general overview in the Table <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#Sx1.T2" title="Table 2 ‣ Inference speed ‣ Results ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_para" id="Sx1.SSx8.p2">
<p class="ltx_p" id="Sx1.SSx8.p2.1">Our benchmarks show that SpecTUS inference can run comfortably on a single CPU with 8 GB of RAM, processing a spectrum in approximately 8 seconds for a single generated candidate or 36 seconds for 10 candidates. Using even an affordable mid-range GPU significantly accelerates inference, enabling spectra to be analyzed within seconds or even fractions of a second.</p>
</div>
<figure class="ltx_table" id="Sx1.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>The time required to generate 1, 10, or 50 candidates for a single query was evaluated across three hardware settings. In the <span class="ltx_text ltx_font_italic" id="Sx1.T2.4.1">H100</span> setting, we used the top tier NVIDIA H100 80 GB graphics card, the <span class="ltx_text ltx_font_italic" id="Sx1.T2.5.2">RTX5000</span> setting used one mid-range NVIDIA Quadro RTX 5000 16GB GPU, and the <span class="ltx_text ltx_font_italic" id="Sx1.T2.6.3">CPU</span> setting uses one Xeon Gold 6130 CPU along with 8 GB of RAM.</figcaption>
<table class="ltx_tabular ltx_align_middle" id="Sx1.T2.7">
<tr class="ltx_tr" id="Sx1.T2.7.1">
<td class="ltx_td ltx_border_r" id="Sx1.T2.7.1.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="Sx1.T2.7.1.2">1 candidate</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="Sx1.T2.7.1.3">10 candidates</td>
<td class="ltx_td ltx_align_left" id="Sx1.T2.7.1.4">50 candidates</td>
</tr>
<tr class="ltx_tr" id="Sx1.T2.7.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="Sx1.T2.7.2.1">H100</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="Sx1.T2.7.2.2">0.2 s</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="Sx1.T2.7.2.3">0.4 s</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="Sx1.T2.7.2.4">1.9 s</td>
</tr>
<tr class="ltx_tr" id="Sx1.T2.7.3">
<td class="ltx_td ltx_align_left ltx_border_r" id="Sx1.T2.7.3.1">RTX5000</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="Sx1.T2.7.3.2">0.5 s</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="Sx1.T2.7.3.3">1.1 s</td>
<td class="ltx_td ltx_align_left" id="Sx1.T2.7.3.4">7.6 s</td>
</tr>
<tr class="ltx_tr" id="Sx1.T2.7.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="Sx1.T2.7.4.1">CPU</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="Sx1.T2.7.4.2">8 s</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="Sx1.T2.7.4.3">36 s</td>
<td class="ltx_td ltx_align_left" id="Sx1.T2.7.4.4">450 s</td>
</tr>
</table>
</figure>
</section>
</section>
<section class="ltx_section" id="Sx2">
<h2 class="ltx_title ltx_title_section">Discussion</h2>
<div class="ltx_para" id="Sx2.p1">
<p class="ltx_p" id="Sx2.p1.1">SpecTUS addresses the problem of <span class="ltx_text ltx_font_italic" id="Sx2.p1.1.1">de novo</span> mass spectra reconstruction, which means a direct translation
from the domain of mass spectra into the domain of molecular structures. It focuses on processing unseen
spectra of unknown compounds and it is the first model specifically designed to elucidate molecular structures
from low-resolution GC-EI-MS spectra without requiring additional supporting information like precursor
ion mass or molecular formula (on the contrary, SpecTUS predicts these even more accurately than recent methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib22" title="">22</a>]</cite>).</p>
</div>
<div class="ltx_para" id="Sx2.p2">
<p class="ltx_p" id="Sx2.p2.1">Our approach was inspired by existing <span class="ltx_text ltx_font_italic" id="Sx2.p2.1.1">de novo</span> MS/MS spectra reconstruction models, such as MSNovelist <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib18" title="">18</a>]</cite> or Spec2Mol <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib17" title="">17</a>]</cite>, and especially MassGenie <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib16" title="">16</a>]</cite> which adopted various
concepts from natural language processing. In addition to adapting our model to a different type of spectra,
we introduced several novel ideas, some inspired by neural machine translation. These include integrating
multiple sources of synthetic spectra, innovative input encoding, and spectra source indication. Each new
approach was experimentally evaluated to ensure the optimal configuration.</p>
</div>
<div class="ltx_para" id="Sx2.p3">
<p class="ltx_p" id="Sx2.p3.1">The SpecTUS’s architecture is an encoder-decoder transformer with 354 million trainable parameters,
based on BART <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib23" title="">23</a>]</cite>, developed for natural language processing originally. .The model was pretrained on a large set of synthetic spectra to
develop a comprehensive understanding of the chemical space of small molecules, followed by finetuning on
NIST 20, a smaller high-quality set of experimental spectra. While this general pretraining-finetuning strategy
has been employed in models like MassGenie and MSNovelist, SpecTUS introduces a unique approach to
generating and integrating synthetic spectra, setting it apart from previous methods.</p>
</div>
<div class="ltx_para" id="Sx2.p4">
<p class="ltx_p" id="Sx2.p4.2">SpecTUS was evaluated on multiple test datasets, including a held-out subset of NIST and subsets of SWDRUG, Cayman, and MONA libraries. To align with the unknown compound identification scenario, the testing compounds were strictly disjoint from all compounds used for training both spectra generators and SpecTUS. Potential data leakage was avoided by excluding conflicting records based on canonicalized SMILES strings with stereoisomeric nuances removed, effectively ensuring no overlap between the training and testing sets. This rigorous data separation allowed us to confidently state that SpecTUS is capable of true generalization on unseen compounds rather than simply memorizing the training sets. Across all the testing datasets, the model achieved molecule reconstruction accuracies ranging from 21–43% (Acc<sub class="ltx_sub" id="Sx2.p4.2.1"><span class="ltx_text ltx_font_italic" id="Sx2.p4.2.1.1">1</span></sub>) and 34–65% (Acc<sub class="ltx_sub" id="Sx2.p4.2.2"><span class="ltx_text ltx_font_italic" id="Sx2.p4.2.2.1">10</span></sub>) as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A1.T4" title="Table 4 ‣ A.2 SpecTUS results ‣ Appendix A Results ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div class="ltx_para" id="Sx2.p5">
<p class="ltx_p" id="Sx2.p5.1">On the other hand, SpecTUS, like many <em class="ltx_emph ltx_font_italic" id="Sx2.p5.1.1">de novo</em> and extended database search approaches, cannot explicitly justify its specific outputs for a given input. It lacks an intermediate representation, such as peak annotations or fragmentation trees (cf. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib24" title="">24</a>, <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib25" title="">25</a>]</cite>), and it does not provide reference spectra for the candidate structures (typical in standard database searches). This limits the possibility of further manual correction of the predicted molecular structures. Additionally, the model’s poorer performance on the Cayman and MONA test sets – compared to the more rigorously curated NIST or SWGDRUG libraries – highlights its sensitivity to the quality of input spectra.</p>
</div>
<div class="ltx_para" id="Sx2.p6">
<p class="ltx_p" id="Sx2.p6.2">We compare SpecTUS with the traditional structure identification approach widely used by practitioners, which relies on searching reference spectra databases. This approach typically involves either exact peak matching (simple similarity search) when the compound is suspected to be present in the database, or a more complex hybrid similarity search (HSS) to identify the closest structure when the compound is absent <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib3" title="">3</a>]</cite>.
Setting aside the combinatorial estimate of the number of all possible small molecules, which is
around <math alttext="10^{60}" class="ltx_Math" display="inline" id="Sx2.p6.1.m1.1"><semantics id="Sx2.p6.1.m1.1a"><msup id="Sx2.p6.1.m1.1.1" xref="Sx2.p6.1.m1.1.1.cmml"><mn id="Sx2.p6.1.m1.1.1.2" xref="Sx2.p6.1.m1.1.1.2.cmml">10</mn><mn id="Sx2.p6.1.m1.1.1.3" xref="Sx2.p6.1.m1.1.1.3.cmml">60</mn></msup><annotation-xml encoding="MathML-Content" id="Sx2.p6.1.m1.1b"><apply id="Sx2.p6.1.m1.1.1.cmml" xref="Sx2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="Sx2.p6.1.m1.1.1.1.cmml" xref="Sx2.p6.1.m1.1.1">superscript</csymbol><cn id="Sx2.p6.1.m1.1.1.2.cmml" type="integer" xref="Sx2.p6.1.m1.1.1.2">10</cn><cn id="Sx2.p6.1.m1.1.1.3.cmml" type="integer" xref="Sx2.p6.1.m1.1.1.3">60</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.p6.1.m1.1c">10^{60}</annotation><annotation encoding="application/x-llamapun" id="Sx2.p6.1.m1.1d">10 start_POSTSUPERSCRIPT 60 end_POSTSUPERSCRIPT</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib26" title="">26</a>]</cite>, structural “spectraless” databases contain roughly <math alttext="10^{9}" class="ltx_Math" display="inline" id="Sx2.p6.2.m2.1"><semantics id="Sx2.p6.2.m2.1a"><msup id="Sx2.p6.2.m2.1.1" xref="Sx2.p6.2.m2.1.1.cmml"><mn id="Sx2.p6.2.m2.1.1.2" xref="Sx2.p6.2.m2.1.1.2.cmml">10</mn><mn id="Sx2.p6.2.m2.1.1.3" xref="Sx2.p6.2.m2.1.1.3.cmml">9</mn></msup><annotation-xml encoding="MathML-Content" id="Sx2.p6.2.m2.1b"><apply id="Sx2.p6.2.m2.1.1.cmml" xref="Sx2.p6.2.m2.1.1"><csymbol cd="ambiguous" id="Sx2.p6.2.m2.1.1.1.cmml" xref="Sx2.p6.2.m2.1.1">superscript</csymbol><cn id="Sx2.p6.2.m2.1.1.2.cmml" type="integer" xref="Sx2.p6.2.m2.1.1.2">10</cn><cn id="Sx2.p6.2.m2.1.1.3.cmml" type="integer" xref="Sx2.p6.2.m2.1.1.3">9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.p6.2.m2.1c">10^{9}</annotation><annotation encoding="application/x-llamapun" id="Sx2.p6.2.m2.1d">10 start_POSTSUPERSCRIPT 9 end_POSTSUPERSCRIPT</annotation></semantics></math> unique molecules. In contrast, commercially available spectral libraries for database searching hold only a few hundred thousand spectra, significantly limiting the pool of potential matches for compound identification.
As we show on the NIST held-out set, in case the analyzed compound is missing from the reference library, the HSS is able to find the library’s closest structure in only 19% cases when retrieving the single best candidate. Practitioners typically refine these candidates through manual analysis and suggest structural corrections. In the same setting, SpecTUS was able to offer a strictly better candidate than HSS in 76% of the cases, and in 43% it correctly identified the exact compound.</p>
</div>
<div class="ltx_para" id="Sx2.p7">
<p class="ltx_p" id="Sx2.p7.2">The extended database search approaches attempt to address the issue of insufficient library coverage by enlarging it artificially.
DeepEI <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib11" title="">11</a>]</cite> achieves Acc<sub class="ltx_sub" id="Sx2.p7.2.1">1</sub> of 27.8% (cf. SpecTUS 21–43%); we argue that their reference library of 170 thousand spectra is
far too small to cover the chemical space sufficiently, hence limited for true unknown structure annotation.
With increasing the library size, the accuracy of similarity search, measured in the same setup,
cannot improve due to the intrinsically higher number of false positives.
Further, DeepEI still needs information on the molecular weight, which may not always be available,
and it is limited to compounds of the 10 most common elements only.
FastEI <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib12" title="">12</a>]</cite> reports even better Acc<sub class="ltx_sub" id="Sx2.p7.2.2">1</sub> of 36.7%,
while improving the coverage to 2.2 million synthetic spectra,
which we argue still not be large enough (cf. 1 billion of known compounds in ZINC)
and it is still limited to 11 elements.
On the contrary, SpecTUS was trained on 17.2 million spectra (of 8.6 million compounds), but because of working <em class="ltx_emph ltx_font_italic" id="Sx2.p7.2.3">de-novo</em>,
its outputs are not limited to those.
Even if the train set size is increased, the negative impact on accuracy is not so straightforward compared
to the search methods, if any.</p>
</div>
<div class="ltx_para" id="Sx2.p8">
<p class="ltx_p" id="Sx2.p8.4">A straightforward comparison of SpecTUS with other <span class="ltx_text ltx_font_italic" id="Sx2.p8.4.1">de novo</span> approaches is challenging, as all existing models were designed and trained for MS/MS spectra. Although MS/MS methods suffer from lower output stability, they provide richer spectral information, allowing for the direct extraction of precursor ion mass. Notably, except for MassGenie, all previously published <span class="ltx_text ltx_font_italic" id="Sx2.p8.4.2">de novo</span> methods rely on precursor ion mass or molecular formula, which serve as valuable cues in the annotation process.
In terms of performance, MassGenie <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib16" title="">16</a>]</cite>, which employs a similar transformer-based architecture as SpecTUS, reported an Acc<sub class="ltx_sub" id="Sx2.p8.4.3"><span class="ltx_text ltx_font_italic" id="Sx2.p8.4.3.1">100</span></sub> of 53%. This was measured on an experimental testing set of 93 spectra filtered from the original 243 spectra in the CASMI 2017 competition using model-specific filters.
MSNovelist <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib18" title="">18</a>]</cite> achieved an Acc<sub class="ltx_sub" id="Sx2.p8.4.4"><span class="ltx_text ltx_font_italic" id="Sx2.p8.4.4.1">128</span></sub> of 57% on the CASMI 2016 competition dataset (127 spectra) and 45% on the GNPS dataset (3863 spectra). However, MSNovelist relies on two streams of input – spectral information encoded as a fingerprint and a precomputed molecular formula. When the authors removed the spectral information from the input, and the model was provided only the molecular formula, the reported Acc<sub class="ltx_sub" id="Sx2.p8.4.5"><span class="ltx_text ltx_font_italic" id="Sx2.p8.4.5.1">128</span></sub> dropped to 52% and 31% for CASMI 2016 and GNPS, respectively. This raises concerns about potential data leakage in the declared results.
Other <span class="ltx_text ltx_font_italic" id="Sx2.p8.4.6">de novo</span> models,
report significantly lower performance and are less comparable to SpecTUS.
MS2Mol <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib20" title="">20</a>]</cite> yields 21% of “close match” accuracy, which is far more relaxed metric.
Mass2SMILES <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib21" title="">21</a>]</cite> appears to be rather premature, having less than 1% of exact matches, and approx. 2% of
close match accuracy.
In the most comparable scenario to existing <span class="ltx_text ltx_font_italic" id="Sx2.p8.4.7">de novo</span> methods, SpecTUS achieved an Acc<sub class="ltx_sub" id="Sx2.p8.4.8"><span class="ltx_text ltx_font_italic" id="Sx2.p8.4.8.1">50</span></sub> of 69% on the NIST test set, which includes <span class="ltx_text ltx_number" id="Sx2.p8.4.9">28 267</span> experimental spectra.</p>
</div>
<div class="ltx_para" id="Sx2.p9">
<p class="ltx_p" id="Sx2.p9.1">To summarize, in this paper, we present SpecTUS, a novel end-to-end model for <span class="ltx_text ltx_font_italic" id="Sx2.p9.1.1">de novo</span> reconstruction of low-resolution GC-EI-MS spectra. Through a series of experiments, we demonstrate the impact of key design choices, offering transferable insights and good practices for future work. These include innovative input and output encoding strategies and the synergistic benefits of leveraging multiple synthetic spectra sources for pretraining. After identifying the optimal model architecture and training configuration, we rigorously compared SpecTUS to widely used database search techniques, showcasing its superior performance in terms of both identification accuracy and the molecular similarity of retrieved candidates.</p>
</div>
<div class="ltx_para" id="Sx2.p10">
<p class="ltx_p" id="Sx2.p10.1">We argue that while low-resolution GC-EI-MS spectra are less informationally rich compared to MS/MS spectra, SpecTUS achieves accuracy levels that are practically applicable in real-world scenarios.</p>
</div>
<div class="ltx_para" id="Sx2.p11">
<p class="ltx_p" id="Sx2.p11.1">Looking forward, we plan to explore how the increasing availability of high-resolution GC-MS data could further enhance molecular structure prediction. Additionally, we aim to investigate the effects of scaling up pretraining datasets to improve performance further.</p>
</div>
</section>
<section class="ltx_section" id="Sx3">
<h2 class="ltx_title ltx_title_section">Methods</h2>
<figure class="ltx_figure" id="Sx3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="290" id="Sx3.F5.g1" src="extracted/6187077/figures/method.png" width="449"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Overview of the SpecTUS method. The diagram illustrates relationships of all models (<span class="ltx_text ltx_font_italic" id="Sx3.F5.5.1">blue</span>), datasets (<span class="ltx_text ltx_font_italic" id="Sx3.F5.6.2">grey</span>) and training stages (<span class="ltx_text ltx_font_italic" id="Sx3.F5.7.3">green</span>) involved in constructing SpecTUS. It also highlights the final inference process (<span class="ltx_text ltx_font_italic" id="Sx3.F5.8.4">red</span>), showing how the model transitioned from training to producing ranked molecular predictions.</figcaption>
</figure>
<div class="ltx_para" id="Sx3.p1">
<p class="ltx_p" id="Sx3.p1.1">Our model is built upon the standard Transformer
architecture <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib27" title="">27</a>]</cite>,
the BART <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib23" title="">23</a>]</cite> in particular,
with certain design modifications and hyperparameters tuned specifically to optimize molecular structure annotation from mass spectra. The training process involved pretraining on large datasets of synthetic spectra generated using custom-trained NEIMS and RASSP models, followed by finetuning on the experimental spectra from the NIST 20 library.</p>
</div>
<section class="ltx_subsection" id="Sx3.SSx1">
<h3 class="ltx_title ltx_title_subsection">Metrics</h3>
<div class="ltx_para" id="Sx3.SSx1.p1">
<p class="ltx_p" id="Sx3.SSx1.p1.1">Overall description of metrics used in SpecTUS evaluation and its comparison
with other models was given in Sect. <a class="ltx_ref ltx_refmacro_nameref" href="https://arxiv.org/html/2502.05114v1#Sx1" title="In SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_title">Results</span></a>.
Here their detailed formal definitions are provided for completeness.</p>
</div>
<div class="ltx_para" id="Sx3.SSx1.p2">
<p class="ltx_p" id="Sx3.SSx1.p2.3"><span class="ltx_text ltx_font_bold" id="Sx3.SSx1.p2.1.1">Top-<math alttext="k" class="ltx_Math" display="inline" id="Sx3.SSx1.p2.1.1.m1.1"><semantics id="Sx3.SSx1.p2.1.1.m1.1a"><mi id="Sx3.SSx1.p2.1.1.m1.1.1" xref="Sx3.SSx1.p2.1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.1.1.m1.1b"><ci id="Sx3.SSx1.p2.1.1.m1.1.1.cmml" xref="Sx3.SSx1.p2.1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p2.1.1.m1.1d">italic_k</annotation></semantics></math> accuracy</span> (<math alttext="\text{Acc}_{k}" class="ltx_Math" display="inline" id="Sx3.SSx1.p2.2.m1.1"><semantics id="Sx3.SSx1.p2.2.m1.1a"><msub id="Sx3.SSx1.p2.2.m1.1.1" xref="Sx3.SSx1.p2.2.m1.1.1.cmml"><mtext id="Sx3.SSx1.p2.2.m1.1.1.2" xref="Sx3.SSx1.p2.2.m1.1.1.2a.cmml">Acc</mtext><mi id="Sx3.SSx1.p2.2.m1.1.1.3" xref="Sx3.SSx1.p2.2.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.2.m1.1b"><apply id="Sx3.SSx1.p2.2.m1.1.1.cmml" xref="Sx3.SSx1.p2.2.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.2.m1.1.1.1.cmml" xref="Sx3.SSx1.p2.2.m1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p2.2.m1.1.1.2a.cmml" xref="Sx3.SSx1.p2.2.m1.1.1.2"><mtext id="Sx3.SSx1.p2.2.m1.1.1.2.cmml" xref="Sx3.SSx1.p2.2.m1.1.1.2">Acc</mtext></ci><ci id="Sx3.SSx1.p2.2.m1.1.1.3.cmml" xref="Sx3.SSx1.p2.2.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.2.m1.1c">\text{Acc}_{k}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p2.2.m1.1d">Acc start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>) measures the percentage of predictions where the correct match is within the first <math alttext="k" class="ltx_Math" display="inline" id="Sx3.SSx1.p2.3.m2.1"><semantics id="Sx3.SSx1.p2.3.m2.1a"><mi id="Sx3.SSx1.p2.3.m2.1.1" xref="Sx3.SSx1.p2.3.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.3.m2.1b"><ci id="Sx3.SSx1.p2.3.m2.1.1.cmml" xref="Sx3.SSx1.p2.3.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.3.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p2.3.m2.1d">italic_k</annotation></semantics></math> retrieved candidates. It is formally defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\text{Acc}_{k}(C_{k},G):=\frac{100}{n}\sum_{i=1}^{n}\mathbbm{1}(G_{i}\in C_{ki})" class="ltx_Math" display="block" id="Sx3.Ex1.m1.3"><semantics id="Sx3.Ex1.m1.3a"><mrow id="Sx3.Ex1.m1.3.3" xref="Sx3.Ex1.m1.3.3.cmml"><mrow id="Sx3.Ex1.m1.2.2.1" xref="Sx3.Ex1.m1.2.2.1.cmml"><msub id="Sx3.Ex1.m1.2.2.1.3" xref="Sx3.Ex1.m1.2.2.1.3.cmml"><mtext id="Sx3.Ex1.m1.2.2.1.3.2" xref="Sx3.Ex1.m1.2.2.1.3.2a.cmml">Acc</mtext><mi id="Sx3.Ex1.m1.2.2.1.3.3" xref="Sx3.Ex1.m1.2.2.1.3.3.cmml">k</mi></msub><mo id="Sx3.Ex1.m1.2.2.1.2" xref="Sx3.Ex1.m1.2.2.1.2.cmml">⁢</mo><mrow id="Sx3.Ex1.m1.2.2.1.1.1" xref="Sx3.Ex1.m1.2.2.1.1.2.cmml"><mo id="Sx3.Ex1.m1.2.2.1.1.1.2" stretchy="false" xref="Sx3.Ex1.m1.2.2.1.1.2.cmml">(</mo><msub id="Sx3.Ex1.m1.2.2.1.1.1.1" xref="Sx3.Ex1.m1.2.2.1.1.1.1.cmml"><mi id="Sx3.Ex1.m1.2.2.1.1.1.1.2" xref="Sx3.Ex1.m1.2.2.1.1.1.1.2.cmml">C</mi><mi id="Sx3.Ex1.m1.2.2.1.1.1.1.3" xref="Sx3.Ex1.m1.2.2.1.1.1.1.3.cmml">k</mi></msub><mo id="Sx3.Ex1.m1.2.2.1.1.1.3" xref="Sx3.Ex1.m1.2.2.1.1.2.cmml">,</mo><mi id="Sx3.Ex1.m1.1.1" xref="Sx3.Ex1.m1.1.1.cmml">G</mi><mo id="Sx3.Ex1.m1.2.2.1.1.1.4" rspace="0.278em" stretchy="false" xref="Sx3.Ex1.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="Sx3.Ex1.m1.3.3.3" rspace="0.278em" xref="Sx3.Ex1.m1.3.3.3.cmml">:=</mo><mrow id="Sx3.Ex1.m1.3.3.2" xref="Sx3.Ex1.m1.3.3.2.cmml"><mfrac id="Sx3.Ex1.m1.3.3.2.3" xref="Sx3.Ex1.m1.3.3.2.3.cmml"><mn id="Sx3.Ex1.m1.3.3.2.3.2" xref="Sx3.Ex1.m1.3.3.2.3.2.cmml">100</mn><mi id="Sx3.Ex1.m1.3.3.2.3.3" xref="Sx3.Ex1.m1.3.3.2.3.3.cmml">n</mi></mfrac><mo id="Sx3.Ex1.m1.3.3.2.2" xref="Sx3.Ex1.m1.3.3.2.2.cmml">⁢</mo><mrow id="Sx3.Ex1.m1.3.3.2.1" xref="Sx3.Ex1.m1.3.3.2.1.cmml"><munderover id="Sx3.Ex1.m1.3.3.2.1.2" xref="Sx3.Ex1.m1.3.3.2.1.2.cmml"><mo id="Sx3.Ex1.m1.3.3.2.1.2.2.2" movablelimits="false" xref="Sx3.Ex1.m1.3.3.2.1.2.2.2.cmml">∑</mo><mrow id="Sx3.Ex1.m1.3.3.2.1.2.2.3" xref="Sx3.Ex1.m1.3.3.2.1.2.2.3.cmml"><mi id="Sx3.Ex1.m1.3.3.2.1.2.2.3.2" xref="Sx3.Ex1.m1.3.3.2.1.2.2.3.2.cmml">i</mi><mo id="Sx3.Ex1.m1.3.3.2.1.2.2.3.1" xref="Sx3.Ex1.m1.3.3.2.1.2.2.3.1.cmml">=</mo><mn id="Sx3.Ex1.m1.3.3.2.1.2.2.3.3" xref="Sx3.Ex1.m1.3.3.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="Sx3.Ex1.m1.3.3.2.1.2.3" xref="Sx3.Ex1.m1.3.3.2.1.2.3.cmml">n</mi></munderover><mrow id="Sx3.Ex1.m1.3.3.2.1.1" xref="Sx3.Ex1.m1.3.3.2.1.1.cmml"><mn id="Sx3.Ex1.m1.3.3.2.1.1.3" xref="Sx3.Ex1.m1.3.3.2.1.1.3.cmml">𝟙</mn><mo id="Sx3.Ex1.m1.3.3.2.1.1.2" xref="Sx3.Ex1.m1.3.3.2.1.1.2.cmml">⁢</mo><mrow id="Sx3.Ex1.m1.3.3.2.1.1.1.1" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.cmml"><mo id="Sx3.Ex1.m1.3.3.2.1.1.1.1.2" stretchy="false" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.cmml"><msub id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.2" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.2.cmml"><mi id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.2.2" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.2.2.cmml">G</mi><mi id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.2.3" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.1" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.1.cmml">∈</mo><msub id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.cmml"><mi id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.2" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.2.cmml">C</mi><mrow id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.3" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.3.cmml"><mi id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.3.2" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.3.2.cmml">k</mi><mo id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.3.1" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.3.3" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.3.3.cmml">i</mi></mrow></msub></mrow><mo id="Sx3.Ex1.m1.3.3.2.1.1.1.1.3" stretchy="false" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex1.m1.3b"><apply id="Sx3.Ex1.m1.3.3.cmml" xref="Sx3.Ex1.m1.3.3"><csymbol cd="latexml" id="Sx3.Ex1.m1.3.3.3.cmml" xref="Sx3.Ex1.m1.3.3.3">assign</csymbol><apply id="Sx3.Ex1.m1.2.2.1.cmml" xref="Sx3.Ex1.m1.2.2.1"><times id="Sx3.Ex1.m1.2.2.1.2.cmml" xref="Sx3.Ex1.m1.2.2.1.2"></times><apply id="Sx3.Ex1.m1.2.2.1.3.cmml" xref="Sx3.Ex1.m1.2.2.1.3"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.2.2.1.3.1.cmml" xref="Sx3.Ex1.m1.2.2.1.3">subscript</csymbol><ci id="Sx3.Ex1.m1.2.2.1.3.2a.cmml" xref="Sx3.Ex1.m1.2.2.1.3.2"><mtext id="Sx3.Ex1.m1.2.2.1.3.2.cmml" xref="Sx3.Ex1.m1.2.2.1.3.2">Acc</mtext></ci><ci id="Sx3.Ex1.m1.2.2.1.3.3.cmml" xref="Sx3.Ex1.m1.2.2.1.3.3">𝑘</ci></apply><interval closure="open" id="Sx3.Ex1.m1.2.2.1.1.2.cmml" xref="Sx3.Ex1.m1.2.2.1.1.1"><apply id="Sx3.Ex1.m1.2.2.1.1.1.1.cmml" xref="Sx3.Ex1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.2.2.1.1.1.1.1.cmml" xref="Sx3.Ex1.m1.2.2.1.1.1.1">subscript</csymbol><ci id="Sx3.Ex1.m1.2.2.1.1.1.1.2.cmml" xref="Sx3.Ex1.m1.2.2.1.1.1.1.2">𝐶</ci><ci id="Sx3.Ex1.m1.2.2.1.1.1.1.3.cmml" xref="Sx3.Ex1.m1.2.2.1.1.1.1.3">𝑘</ci></apply><ci id="Sx3.Ex1.m1.1.1.cmml" xref="Sx3.Ex1.m1.1.1">𝐺</ci></interval></apply><apply id="Sx3.Ex1.m1.3.3.2.cmml" xref="Sx3.Ex1.m1.3.3.2"><times id="Sx3.Ex1.m1.3.3.2.2.cmml" xref="Sx3.Ex1.m1.3.3.2.2"></times><apply id="Sx3.Ex1.m1.3.3.2.3.cmml" xref="Sx3.Ex1.m1.3.3.2.3"><divide id="Sx3.Ex1.m1.3.3.2.3.1.cmml" xref="Sx3.Ex1.m1.3.3.2.3"></divide><cn id="Sx3.Ex1.m1.3.3.2.3.2.cmml" type="integer" xref="Sx3.Ex1.m1.3.3.2.3.2">100</cn><ci id="Sx3.Ex1.m1.3.3.2.3.3.cmml" xref="Sx3.Ex1.m1.3.3.2.3.3">𝑛</ci></apply><apply id="Sx3.Ex1.m1.3.3.2.1.cmml" xref="Sx3.Ex1.m1.3.3.2.1"><apply id="Sx3.Ex1.m1.3.3.2.1.2.cmml" xref="Sx3.Ex1.m1.3.3.2.1.2"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.3.3.2.1.2.1.cmml" xref="Sx3.Ex1.m1.3.3.2.1.2">superscript</csymbol><apply id="Sx3.Ex1.m1.3.3.2.1.2.2.cmml" xref="Sx3.Ex1.m1.3.3.2.1.2"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.3.3.2.1.2.2.1.cmml" xref="Sx3.Ex1.m1.3.3.2.1.2">subscript</csymbol><sum id="Sx3.Ex1.m1.3.3.2.1.2.2.2.cmml" xref="Sx3.Ex1.m1.3.3.2.1.2.2.2"></sum><apply id="Sx3.Ex1.m1.3.3.2.1.2.2.3.cmml" xref="Sx3.Ex1.m1.3.3.2.1.2.2.3"><eq id="Sx3.Ex1.m1.3.3.2.1.2.2.3.1.cmml" xref="Sx3.Ex1.m1.3.3.2.1.2.2.3.1"></eq><ci id="Sx3.Ex1.m1.3.3.2.1.2.2.3.2.cmml" xref="Sx3.Ex1.m1.3.3.2.1.2.2.3.2">𝑖</ci><cn id="Sx3.Ex1.m1.3.3.2.1.2.2.3.3.cmml" type="integer" xref="Sx3.Ex1.m1.3.3.2.1.2.2.3.3">1</cn></apply></apply><ci id="Sx3.Ex1.m1.3.3.2.1.2.3.cmml" xref="Sx3.Ex1.m1.3.3.2.1.2.3">𝑛</ci></apply><apply id="Sx3.Ex1.m1.3.3.2.1.1.cmml" xref="Sx3.Ex1.m1.3.3.2.1.1"><times id="Sx3.Ex1.m1.3.3.2.1.1.2.cmml" xref="Sx3.Ex1.m1.3.3.2.1.1.2"></times><cn id="Sx3.Ex1.m1.3.3.2.1.1.3.cmml" type="integer" xref="Sx3.Ex1.m1.3.3.2.1.1.3">1</cn><apply id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.cmml" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1"><in id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.1.cmml" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.1"></in><apply id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.2.cmml" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.2.1.cmml" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.2">subscript</csymbol><ci id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.2.2.cmml" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.2.2">𝐺</ci><ci id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.2.3.cmml" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.cmml" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.1.cmml" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.2.cmml" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.2">𝐶</ci><apply id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.3.cmml" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.3"><times id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.3.1.cmml" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.3.1"></times><ci id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.3.2.cmml" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.3.2">𝑘</ci><ci id="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.3.3.cmml" xref="Sx3.Ex1.m1.3.3.2.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex1.m1.3c">\text{Acc}_{k}(C_{k},G):=\frac{100}{n}\sum_{i=1}^{n}\mathbbm{1}(G_{i}\in C_{ki})</annotation><annotation encoding="application/x-llamapun" id="Sx3.Ex1.m1.3d">Acc start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( italic_C start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_G ) := divide start_ARG 100 end_ARG start_ARG italic_n end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT blackboard_1 ( italic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ italic_C start_POSTSUBSCRIPT italic_k italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx3.SSx1.p2.14">where <math alttext="k" class="ltx_Math" display="inline" id="Sx3.SSx1.p2.4.m1.1"><semantics id="Sx3.SSx1.p2.4.m1.1a"><mi id="Sx3.SSx1.p2.4.m1.1.1" xref="Sx3.SSx1.p2.4.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.4.m1.1b"><ci id="Sx3.SSx1.p2.4.m1.1.1.cmml" xref="Sx3.SSx1.p2.4.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.4.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p2.4.m1.1d">italic_k</annotation></semantics></math> is the number of candidates considered, <math alttext="n" class="ltx_Math" display="inline" id="Sx3.SSx1.p2.5.m2.1"><semantics id="Sx3.SSx1.p2.5.m2.1a"><mi id="Sx3.SSx1.p2.5.m2.1.1" xref="Sx3.SSx1.p2.5.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.5.m2.1b"><ci id="Sx3.SSx1.p2.5.m2.1.1.cmml" xref="Sx3.SSx1.p2.5.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.5.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p2.5.m2.1d">italic_n</annotation></semantics></math> is the number of queries, <math alttext="C_{k}" class="ltx_Math" display="inline" id="Sx3.SSx1.p2.6.m3.1"><semantics id="Sx3.SSx1.p2.6.m3.1a"><msub id="Sx3.SSx1.p2.6.m3.1.1" xref="Sx3.SSx1.p2.6.m3.1.1.cmml"><mi id="Sx3.SSx1.p2.6.m3.1.1.2" xref="Sx3.SSx1.p2.6.m3.1.1.2.cmml">C</mi><mi id="Sx3.SSx1.p2.6.m3.1.1.3" xref="Sx3.SSx1.p2.6.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.6.m3.1b"><apply id="Sx3.SSx1.p2.6.m3.1.1.cmml" xref="Sx3.SSx1.p2.6.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.6.m3.1.1.1.cmml" xref="Sx3.SSx1.p2.6.m3.1.1">subscript</csymbol><ci id="Sx3.SSx1.p2.6.m3.1.1.2.cmml" xref="Sx3.SSx1.p2.6.m3.1.1.2">𝐶</ci><ci id="Sx3.SSx1.p2.6.m3.1.1.3.cmml" xref="Sx3.SSx1.p2.6.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.6.m3.1c">C_{k}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p2.6.m3.1d">italic_C start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is a list of <math alttext="n" class="ltx_Math" display="inline" id="Sx3.SSx1.p2.7.m4.1"><semantics id="Sx3.SSx1.p2.7.m4.1a"><mi id="Sx3.SSx1.p2.7.m4.1.1" xref="Sx3.SSx1.p2.7.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.7.m4.1b"><ci id="Sx3.SSx1.p2.7.m4.1.1.cmml" xref="Sx3.SSx1.p2.7.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.7.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p2.7.m4.1d">italic_n</annotation></semantics></math> predictions and each prediction <math alttext="C_{ki}" class="ltx_Math" display="inline" id="Sx3.SSx1.p2.8.m5.1"><semantics id="Sx3.SSx1.p2.8.m5.1a"><msub id="Sx3.SSx1.p2.8.m5.1.1" xref="Sx3.SSx1.p2.8.m5.1.1.cmml"><mi id="Sx3.SSx1.p2.8.m5.1.1.2" xref="Sx3.SSx1.p2.8.m5.1.1.2.cmml">C</mi><mrow id="Sx3.SSx1.p2.8.m5.1.1.3" xref="Sx3.SSx1.p2.8.m5.1.1.3.cmml"><mi id="Sx3.SSx1.p2.8.m5.1.1.3.2" xref="Sx3.SSx1.p2.8.m5.1.1.3.2.cmml">k</mi><mo id="Sx3.SSx1.p2.8.m5.1.1.3.1" xref="Sx3.SSx1.p2.8.m5.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p2.8.m5.1.1.3.3" xref="Sx3.SSx1.p2.8.m5.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.8.m5.1b"><apply id="Sx3.SSx1.p2.8.m5.1.1.cmml" xref="Sx3.SSx1.p2.8.m5.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.8.m5.1.1.1.cmml" xref="Sx3.SSx1.p2.8.m5.1.1">subscript</csymbol><ci id="Sx3.SSx1.p2.8.m5.1.1.2.cmml" xref="Sx3.SSx1.p2.8.m5.1.1.2">𝐶</ci><apply id="Sx3.SSx1.p2.8.m5.1.1.3.cmml" xref="Sx3.SSx1.p2.8.m5.1.1.3"><times id="Sx3.SSx1.p2.8.m5.1.1.3.1.cmml" xref="Sx3.SSx1.p2.8.m5.1.1.3.1"></times><ci id="Sx3.SSx1.p2.8.m5.1.1.3.2.cmml" xref="Sx3.SSx1.p2.8.m5.1.1.3.2">𝑘</ci><ci id="Sx3.SSx1.p2.8.m5.1.1.3.3.cmml" xref="Sx3.SSx1.p2.8.m5.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.8.m5.1c">C_{ki}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p2.8.m5.1d">italic_C start_POSTSUBSCRIPT italic_k italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for query <math alttext="i" class="ltx_Math" display="inline" id="Sx3.SSx1.p2.9.m6.1"><semantics id="Sx3.SSx1.p2.9.m6.1a"><mi id="Sx3.SSx1.p2.9.m6.1.1" xref="Sx3.SSx1.p2.9.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.9.m6.1b"><ci id="Sx3.SSx1.p2.9.m6.1.1.cmml" xref="Sx3.SSx1.p2.9.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.9.m6.1c">i</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p2.9.m6.1d">italic_i</annotation></semantics></math> contains at most <math alttext="k" class="ltx_Math" display="inline" id="Sx3.SSx1.p2.10.m7.1"><semantics id="Sx3.SSx1.p2.10.m7.1a"><mi id="Sx3.SSx1.p2.10.m7.1.1" xref="Sx3.SSx1.p2.10.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.10.m7.1b"><ci id="Sx3.SSx1.p2.10.m7.1.1.cmml" xref="Sx3.SSx1.p2.10.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.10.m7.1c">k</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p2.10.m7.1d">italic_k</annotation></semantics></math> candidate molecules. <math alttext="G" class="ltx_Math" display="inline" id="Sx3.SSx1.p2.11.m8.1"><semantics id="Sx3.SSx1.p2.11.m8.1a"><mi id="Sx3.SSx1.p2.11.m8.1.1" xref="Sx3.SSx1.p2.11.m8.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.11.m8.1b"><ci id="Sx3.SSx1.p2.11.m8.1.1.cmml" xref="Sx3.SSx1.p2.11.m8.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.11.m8.1c">G</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p2.11.m8.1d">italic_G</annotation></semantics></math> is the list of ground truth molecules, one for each query, and <math alttext="G_{i}" class="ltx_Math" display="inline" id="Sx3.SSx1.p2.12.m9.1"><semantics id="Sx3.SSx1.p2.12.m9.1a"><msub id="Sx3.SSx1.p2.12.m9.1.1" xref="Sx3.SSx1.p2.12.m9.1.1.cmml"><mi id="Sx3.SSx1.p2.12.m9.1.1.2" xref="Sx3.SSx1.p2.12.m9.1.1.2.cmml">G</mi><mi id="Sx3.SSx1.p2.12.m9.1.1.3" xref="Sx3.SSx1.p2.12.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.12.m9.1b"><apply id="Sx3.SSx1.p2.12.m9.1.1.cmml" xref="Sx3.SSx1.p2.12.m9.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.12.m9.1.1.1.cmml" xref="Sx3.SSx1.p2.12.m9.1.1">subscript</csymbol><ci id="Sx3.SSx1.p2.12.m9.1.1.2.cmml" xref="Sx3.SSx1.p2.12.m9.1.1.2">𝐺</ci><ci id="Sx3.SSx1.p2.12.m9.1.1.3.cmml" xref="Sx3.SSx1.p2.12.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.12.m9.1c">G_{i}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p2.12.m9.1d">italic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is a single ground truth molecule for query <math alttext="i" class="ltx_Math" display="inline" id="Sx3.SSx1.p2.13.m10.1"><semantics id="Sx3.SSx1.p2.13.m10.1a"><mi id="Sx3.SSx1.p2.13.m10.1.1" xref="Sx3.SSx1.p2.13.m10.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.13.m10.1b"><ci id="Sx3.SSx1.p2.13.m10.1.1.cmml" xref="Sx3.SSx1.p2.13.m10.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.13.m10.1c">i</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p2.13.m10.1d">italic_i</annotation></semantics></math>. <math alttext="\mathbbm{1}" class="ltx_Math" display="inline" id="Sx3.SSx1.p2.14.m11.1"><semantics id="Sx3.SSx1.p2.14.m11.1a"><mn id="Sx3.SSx1.p2.14.m11.1.1" xref="Sx3.SSx1.p2.14.m11.1.1.cmml">𝟙</mn><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.14.m11.1b"><cn id="Sx3.SSx1.p2.14.m11.1.1.cmml" type="integer" xref="Sx3.SSx1.p2.14.m11.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.14.m11.1c">\mathbbm{1}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p2.14.m11.1d">blackboard_1</annotation></semantics></math> is an indicator function that returns 1 if the condition inside is true and 0 otherwise.</p>
</div>
<div class="ltx_para" id="Sx3.SSx1.p3">
<p class="ltx_p" id="Sx3.SSx1.p3.4"><span class="ltx_text ltx_font_bold" id="Sx3.SSx1.p3.1.1">Average top-<math alttext="k" class="ltx_Math" display="inline" id="Sx3.SSx1.p3.1.1.m1.1"><semantics id="Sx3.SSx1.p3.1.1.m1.1a"><mi id="Sx3.SSx1.p3.1.1.m1.1.1" xref="Sx3.SSx1.p3.1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p3.1.1.m1.1b"><ci id="Sx3.SSx1.p3.1.1.m1.1.1.cmml" xref="Sx3.SSx1.p3.1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p3.1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p3.1.1.m1.1d">italic_k</annotation></semantics></math> similarity</span> (Sim<sub class="ltx_sub" id="Sx3.SSx1.p3.4.2"><span class="ltx_text ltx_font_italic" id="Sx3.SSx1.p3.4.2.1">k</span></sub>) quantifies how structurally similar, on average, the most accurate candidate among the first <math alttext="k" class="ltx_Math" display="inline" id="Sx3.SSx1.p3.3.m2.1"><semantics id="Sx3.SSx1.p3.3.m2.1a"><mi id="Sx3.SSx1.p3.3.m2.1.1" xref="Sx3.SSx1.p3.3.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p3.3.m2.1b"><ci id="Sx3.SSx1.p3.3.m2.1.1.cmml" xref="Sx3.SSx1.p3.3.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p3.3.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p3.3.m2.1d">italic_k</annotation></semantics></math> retrieved molecules is to the ground truth molecule. For each query, the similarity is calculated as the highest Tanimoto similarity between the Morgan fingerprints of the ground truth molecule and each of the first <math alttext="k" class="ltx_Math" display="inline" id="Sx3.SSx1.p3.4.m3.1"><semantics id="Sx3.SSx1.p3.4.m3.1a"><mi id="Sx3.SSx1.p3.4.m3.1.1" xref="Sx3.SSx1.p3.4.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p3.4.m3.1b"><ci id="Sx3.SSx1.p3.4.m3.1.1.cmml" xref="Sx3.SSx1.p3.4.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p3.4.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p3.4.m3.1d">italic_k</annotation></semantics></math> retrieved candidates. The similarities are then averaged over all queries in the testing set. Mathematically, the metric is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx3.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\text{Sim}_{k}(C_{k},G):=\frac{1}{n}\sum_{i=1}^{n}\max\limits_{c\in C_{ki}}{%
\text{T}(\phi(c),\phi(G_{i}))}" class="ltx_Math" display="block" id="Sx3.Ex2.m1.5"><semantics id="Sx3.Ex2.m1.5a"><mrow id="Sx3.Ex2.m1.5.5" xref="Sx3.Ex2.m1.5.5.cmml"><mrow id="Sx3.Ex2.m1.3.3.1" xref="Sx3.Ex2.m1.3.3.1.cmml"><msub id="Sx3.Ex2.m1.3.3.1.3" xref="Sx3.Ex2.m1.3.3.1.3.cmml"><mtext id="Sx3.Ex2.m1.3.3.1.3.2" xref="Sx3.Ex2.m1.3.3.1.3.2a.cmml">Sim</mtext><mi id="Sx3.Ex2.m1.3.3.1.3.3" xref="Sx3.Ex2.m1.3.3.1.3.3.cmml">k</mi></msub><mo id="Sx3.Ex2.m1.3.3.1.2" xref="Sx3.Ex2.m1.3.3.1.2.cmml">⁢</mo><mrow id="Sx3.Ex2.m1.3.3.1.1.1" xref="Sx3.Ex2.m1.3.3.1.1.2.cmml"><mo id="Sx3.Ex2.m1.3.3.1.1.1.2" stretchy="false" xref="Sx3.Ex2.m1.3.3.1.1.2.cmml">(</mo><msub id="Sx3.Ex2.m1.3.3.1.1.1.1" xref="Sx3.Ex2.m1.3.3.1.1.1.1.cmml"><mi id="Sx3.Ex2.m1.3.3.1.1.1.1.2" xref="Sx3.Ex2.m1.3.3.1.1.1.1.2.cmml">C</mi><mi id="Sx3.Ex2.m1.3.3.1.1.1.1.3" xref="Sx3.Ex2.m1.3.3.1.1.1.1.3.cmml">k</mi></msub><mo id="Sx3.Ex2.m1.3.3.1.1.1.3" xref="Sx3.Ex2.m1.3.3.1.1.2.cmml">,</mo><mi id="Sx3.Ex2.m1.1.1" xref="Sx3.Ex2.m1.1.1.cmml">G</mi><mo id="Sx3.Ex2.m1.3.3.1.1.1.4" rspace="0.278em" stretchy="false" xref="Sx3.Ex2.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="Sx3.Ex2.m1.5.5.4" rspace="0.278em" xref="Sx3.Ex2.m1.5.5.4.cmml">:=</mo><mrow id="Sx3.Ex2.m1.5.5.3" xref="Sx3.Ex2.m1.5.5.3.cmml"><mfrac id="Sx3.Ex2.m1.5.5.3.4" xref="Sx3.Ex2.m1.5.5.3.4.cmml"><mn id="Sx3.Ex2.m1.5.5.3.4.2" xref="Sx3.Ex2.m1.5.5.3.4.2.cmml">1</mn><mi id="Sx3.Ex2.m1.5.5.3.4.3" xref="Sx3.Ex2.m1.5.5.3.4.3.cmml">n</mi></mfrac><mo id="Sx3.Ex2.m1.5.5.3.3" xref="Sx3.Ex2.m1.5.5.3.3.cmml">⁢</mo><mrow id="Sx3.Ex2.m1.5.5.3.2" xref="Sx3.Ex2.m1.5.5.3.2.cmml"><munderover id="Sx3.Ex2.m1.5.5.3.2.3" xref="Sx3.Ex2.m1.5.5.3.2.3.cmml"><mo id="Sx3.Ex2.m1.5.5.3.2.3.2.2" movablelimits="false" xref="Sx3.Ex2.m1.5.5.3.2.3.2.2.cmml">∑</mo><mrow id="Sx3.Ex2.m1.5.5.3.2.3.2.3" xref="Sx3.Ex2.m1.5.5.3.2.3.2.3.cmml"><mi id="Sx3.Ex2.m1.5.5.3.2.3.2.3.2" xref="Sx3.Ex2.m1.5.5.3.2.3.2.3.2.cmml">i</mi><mo id="Sx3.Ex2.m1.5.5.3.2.3.2.3.1" xref="Sx3.Ex2.m1.5.5.3.2.3.2.3.1.cmml">=</mo><mn id="Sx3.Ex2.m1.5.5.3.2.3.2.3.3" xref="Sx3.Ex2.m1.5.5.3.2.3.2.3.3.cmml">1</mn></mrow><mi id="Sx3.Ex2.m1.5.5.3.2.3.3" xref="Sx3.Ex2.m1.5.5.3.2.3.3.cmml">n</mi></munderover><mrow id="Sx3.Ex2.m1.5.5.3.2.2" xref="Sx3.Ex2.m1.5.5.3.2.2.cmml"><mrow id="Sx3.Ex2.m1.5.5.3.2.2.4" xref="Sx3.Ex2.m1.5.5.3.2.2.4.cmml"><munder id="Sx3.Ex2.m1.5.5.3.2.2.4.1" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1.cmml"><mi id="Sx3.Ex2.m1.5.5.3.2.2.4.1.2" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1.2.cmml">max</mi><mrow id="Sx3.Ex2.m1.5.5.3.2.2.4.1.3" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.cmml"><mi id="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.2" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.2.cmml">c</mi><mo id="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.1" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.1.cmml">∈</mo><msub id="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.cmml"><mi id="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.2" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.2.cmml">C</mi><mrow id="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.3" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.3.cmml"><mi id="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.3.2" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.3.2.cmml">k</mi><mo id="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.3.1" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.3.1.cmml">⁢</mo><mi id="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.3.3" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.3.3.cmml">i</mi></mrow></msub></mrow></munder><mo id="Sx3.Ex2.m1.5.5.3.2.2.4a" lspace="0.167em" xref="Sx3.Ex2.m1.5.5.3.2.2.4.cmml">⁡</mo><mtext id="Sx3.Ex2.m1.5.5.3.2.2.4.2" xref="Sx3.Ex2.m1.5.5.3.2.2.4.2a.cmml">T</mtext></mrow><mo id="Sx3.Ex2.m1.5.5.3.2.2.3" xref="Sx3.Ex2.m1.5.5.3.2.2.3.cmml">⁢</mo><mrow id="Sx3.Ex2.m1.5.5.3.2.2.2.2" xref="Sx3.Ex2.m1.5.5.3.2.2.2.3.cmml"><mo id="Sx3.Ex2.m1.5.5.3.2.2.2.2.3" stretchy="false" xref="Sx3.Ex2.m1.5.5.3.2.2.2.3.cmml">(</mo><mrow id="Sx3.Ex2.m1.4.4.2.1.1.1.1.1" xref="Sx3.Ex2.m1.4.4.2.1.1.1.1.1.cmml"><mi id="Sx3.Ex2.m1.4.4.2.1.1.1.1.1.2" xref="Sx3.Ex2.m1.4.4.2.1.1.1.1.1.2.cmml">ϕ</mi><mo id="Sx3.Ex2.m1.4.4.2.1.1.1.1.1.1" xref="Sx3.Ex2.m1.4.4.2.1.1.1.1.1.1.cmml">⁢</mo><mrow id="Sx3.Ex2.m1.4.4.2.1.1.1.1.1.3.2" xref="Sx3.Ex2.m1.4.4.2.1.1.1.1.1.cmml"><mo id="Sx3.Ex2.m1.4.4.2.1.1.1.1.1.3.2.1" stretchy="false" xref="Sx3.Ex2.m1.4.4.2.1.1.1.1.1.cmml">(</mo><mi id="Sx3.Ex2.m1.2.2" xref="Sx3.Ex2.m1.2.2.cmml">c</mi><mo id="Sx3.Ex2.m1.4.4.2.1.1.1.1.1.3.2.2" stretchy="false" xref="Sx3.Ex2.m1.4.4.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.Ex2.m1.5.5.3.2.2.2.2.4" xref="Sx3.Ex2.m1.5.5.3.2.2.2.3.cmml">,</mo><mrow id="Sx3.Ex2.m1.5.5.3.2.2.2.2.2" xref="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.cmml"><mi id="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.3" xref="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.3.cmml">ϕ</mi><mo id="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.2" xref="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.2.cmml">⁢</mo><mrow id="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.1.1" xref="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.1.1.1.cmml"><mo id="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.1.1.2" stretchy="false" xref="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.1.1.1.cmml">(</mo><msub id="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.1.1.1" xref="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.1.1.1.cmml"><mi id="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.1.1.1.2" xref="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.1.1.1.2.cmml">G</mi><mi id="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.1.1.1.3" xref="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.1.1.3" stretchy="false" xref="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.Ex2.m1.5.5.3.2.2.2.2.5" stretchy="false" xref="Sx3.Ex2.m1.5.5.3.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex2.m1.5b"><apply id="Sx3.Ex2.m1.5.5.cmml" xref="Sx3.Ex2.m1.5.5"><csymbol cd="latexml" id="Sx3.Ex2.m1.5.5.4.cmml" xref="Sx3.Ex2.m1.5.5.4">assign</csymbol><apply id="Sx3.Ex2.m1.3.3.1.cmml" xref="Sx3.Ex2.m1.3.3.1"><times id="Sx3.Ex2.m1.3.3.1.2.cmml" xref="Sx3.Ex2.m1.3.3.1.2"></times><apply id="Sx3.Ex2.m1.3.3.1.3.cmml" xref="Sx3.Ex2.m1.3.3.1.3"><csymbol cd="ambiguous" id="Sx3.Ex2.m1.3.3.1.3.1.cmml" xref="Sx3.Ex2.m1.3.3.1.3">subscript</csymbol><ci id="Sx3.Ex2.m1.3.3.1.3.2a.cmml" xref="Sx3.Ex2.m1.3.3.1.3.2"><mtext id="Sx3.Ex2.m1.3.3.1.3.2.cmml" xref="Sx3.Ex2.m1.3.3.1.3.2">Sim</mtext></ci><ci id="Sx3.Ex2.m1.3.3.1.3.3.cmml" xref="Sx3.Ex2.m1.3.3.1.3.3">𝑘</ci></apply><interval closure="open" id="Sx3.Ex2.m1.3.3.1.1.2.cmml" xref="Sx3.Ex2.m1.3.3.1.1.1"><apply id="Sx3.Ex2.m1.3.3.1.1.1.1.cmml" xref="Sx3.Ex2.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex2.m1.3.3.1.1.1.1.1.cmml" xref="Sx3.Ex2.m1.3.3.1.1.1.1">subscript</csymbol><ci id="Sx3.Ex2.m1.3.3.1.1.1.1.2.cmml" xref="Sx3.Ex2.m1.3.3.1.1.1.1.2">𝐶</ci><ci id="Sx3.Ex2.m1.3.3.1.1.1.1.3.cmml" xref="Sx3.Ex2.m1.3.3.1.1.1.1.3">𝑘</ci></apply><ci id="Sx3.Ex2.m1.1.1.cmml" xref="Sx3.Ex2.m1.1.1">𝐺</ci></interval></apply><apply id="Sx3.Ex2.m1.5.5.3.cmml" xref="Sx3.Ex2.m1.5.5.3"><times id="Sx3.Ex2.m1.5.5.3.3.cmml" xref="Sx3.Ex2.m1.5.5.3.3"></times><apply id="Sx3.Ex2.m1.5.5.3.4.cmml" xref="Sx3.Ex2.m1.5.5.3.4"><divide id="Sx3.Ex2.m1.5.5.3.4.1.cmml" xref="Sx3.Ex2.m1.5.5.3.4"></divide><cn id="Sx3.Ex2.m1.5.5.3.4.2.cmml" type="integer" xref="Sx3.Ex2.m1.5.5.3.4.2">1</cn><ci id="Sx3.Ex2.m1.5.5.3.4.3.cmml" xref="Sx3.Ex2.m1.5.5.3.4.3">𝑛</ci></apply><apply id="Sx3.Ex2.m1.5.5.3.2.cmml" xref="Sx3.Ex2.m1.5.5.3.2"><apply id="Sx3.Ex2.m1.5.5.3.2.3.cmml" xref="Sx3.Ex2.m1.5.5.3.2.3"><csymbol cd="ambiguous" id="Sx3.Ex2.m1.5.5.3.2.3.1.cmml" xref="Sx3.Ex2.m1.5.5.3.2.3">superscript</csymbol><apply id="Sx3.Ex2.m1.5.5.3.2.3.2.cmml" xref="Sx3.Ex2.m1.5.5.3.2.3"><csymbol cd="ambiguous" id="Sx3.Ex2.m1.5.5.3.2.3.2.1.cmml" xref="Sx3.Ex2.m1.5.5.3.2.3">subscript</csymbol><sum id="Sx3.Ex2.m1.5.5.3.2.3.2.2.cmml" xref="Sx3.Ex2.m1.5.5.3.2.3.2.2"></sum><apply id="Sx3.Ex2.m1.5.5.3.2.3.2.3.cmml" xref="Sx3.Ex2.m1.5.5.3.2.3.2.3"><eq id="Sx3.Ex2.m1.5.5.3.2.3.2.3.1.cmml" xref="Sx3.Ex2.m1.5.5.3.2.3.2.3.1"></eq><ci id="Sx3.Ex2.m1.5.5.3.2.3.2.3.2.cmml" xref="Sx3.Ex2.m1.5.5.3.2.3.2.3.2">𝑖</ci><cn id="Sx3.Ex2.m1.5.5.3.2.3.2.3.3.cmml" type="integer" xref="Sx3.Ex2.m1.5.5.3.2.3.2.3.3">1</cn></apply></apply><ci id="Sx3.Ex2.m1.5.5.3.2.3.3.cmml" xref="Sx3.Ex2.m1.5.5.3.2.3.3">𝑛</ci></apply><apply id="Sx3.Ex2.m1.5.5.3.2.2.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2"><times id="Sx3.Ex2.m1.5.5.3.2.2.3.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.3"></times><apply id="Sx3.Ex2.m1.5.5.3.2.2.4.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.4"><apply id="Sx3.Ex2.m1.5.5.3.2.2.4.1.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1"><csymbol cd="ambiguous" id="Sx3.Ex2.m1.5.5.3.2.2.4.1.1.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1">subscript</csymbol><max id="Sx3.Ex2.m1.5.5.3.2.2.4.1.2.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1.2"></max><apply id="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1.3"><in id="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.1.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.1"></in><ci id="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.2.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.2">𝑐</ci><apply id="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3"><csymbol cd="ambiguous" id="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.1.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3">subscript</csymbol><ci id="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.2.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.2">𝐶</ci><apply id="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.3.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.3"><times id="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.3.1.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.3.1"></times><ci id="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.3.2.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.3.2">𝑘</ci><ci id="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.3.3.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.4.1.3.3.3.3">𝑖</ci></apply></apply></apply></apply><ci id="Sx3.Ex2.m1.5.5.3.2.2.4.2a.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.4.2"><mtext id="Sx3.Ex2.m1.5.5.3.2.2.4.2.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.4.2">T</mtext></ci></apply><interval closure="open" id="Sx3.Ex2.m1.5.5.3.2.2.2.3.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.2.2"><apply id="Sx3.Ex2.m1.4.4.2.1.1.1.1.1.cmml" xref="Sx3.Ex2.m1.4.4.2.1.1.1.1.1"><times id="Sx3.Ex2.m1.4.4.2.1.1.1.1.1.1.cmml" xref="Sx3.Ex2.m1.4.4.2.1.1.1.1.1.1"></times><ci id="Sx3.Ex2.m1.4.4.2.1.1.1.1.1.2.cmml" xref="Sx3.Ex2.m1.4.4.2.1.1.1.1.1.2">italic-ϕ</ci><ci id="Sx3.Ex2.m1.2.2.cmml" xref="Sx3.Ex2.m1.2.2">𝑐</ci></apply><apply id="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.2.2.2"><times id="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.2.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.2"></times><ci id="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.3.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.3">italic-ϕ</ci><apply id="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.1.1.1.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.1.1.1.1.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.1.1">subscript</csymbol><ci id="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.1.1.1.2.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.1.1.1.2">𝐺</ci><ci id="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.1.1.1.3.cmml" xref="Sx3.Ex2.m1.5.5.3.2.2.2.2.2.1.1.1.3">𝑖</ci></apply></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex2.m1.5c">\text{Sim}_{k}(C_{k},G):=\frac{1}{n}\sum_{i=1}^{n}\max\limits_{c\in C_{ki}}{%
\text{T}(\phi(c),\phi(G_{i}))}</annotation><annotation encoding="application/x-llamapun" id="Sx3.Ex2.m1.5d">Sim start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( italic_C start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_G ) := divide start_ARG 1 end_ARG start_ARG italic_n end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT roman_max start_POSTSUBSCRIPT italic_c ∈ italic_C start_POSTSUBSCRIPT italic_k italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT T ( italic_ϕ ( italic_c ) , italic_ϕ ( italic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx3.SSx1.p3.7">where <math alttext="T(f_{1},f_{2})" class="ltx_Math" display="inline" id="Sx3.SSx1.p3.5.m1.2"><semantics id="Sx3.SSx1.p3.5.m1.2a"><mrow id="Sx3.SSx1.p3.5.m1.2.2" xref="Sx3.SSx1.p3.5.m1.2.2.cmml"><mi id="Sx3.SSx1.p3.5.m1.2.2.4" xref="Sx3.SSx1.p3.5.m1.2.2.4.cmml">T</mi><mo id="Sx3.SSx1.p3.5.m1.2.2.3" xref="Sx3.SSx1.p3.5.m1.2.2.3.cmml">⁢</mo><mrow id="Sx3.SSx1.p3.5.m1.2.2.2.2" xref="Sx3.SSx1.p3.5.m1.2.2.2.3.cmml"><mo id="Sx3.SSx1.p3.5.m1.2.2.2.2.3" stretchy="false" xref="Sx3.SSx1.p3.5.m1.2.2.2.3.cmml">(</mo><msub id="Sx3.SSx1.p3.5.m1.1.1.1.1.1" xref="Sx3.SSx1.p3.5.m1.1.1.1.1.1.cmml"><mi id="Sx3.SSx1.p3.5.m1.1.1.1.1.1.2" xref="Sx3.SSx1.p3.5.m1.1.1.1.1.1.2.cmml">f</mi><mn id="Sx3.SSx1.p3.5.m1.1.1.1.1.1.3" xref="Sx3.SSx1.p3.5.m1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="Sx3.SSx1.p3.5.m1.2.2.2.2.4" xref="Sx3.SSx1.p3.5.m1.2.2.2.3.cmml">,</mo><msub id="Sx3.SSx1.p3.5.m1.2.2.2.2.2" xref="Sx3.SSx1.p3.5.m1.2.2.2.2.2.cmml"><mi id="Sx3.SSx1.p3.5.m1.2.2.2.2.2.2" xref="Sx3.SSx1.p3.5.m1.2.2.2.2.2.2.cmml">f</mi><mn id="Sx3.SSx1.p3.5.m1.2.2.2.2.2.3" xref="Sx3.SSx1.p3.5.m1.2.2.2.2.2.3.cmml">2</mn></msub><mo id="Sx3.SSx1.p3.5.m1.2.2.2.2.5" stretchy="false" xref="Sx3.SSx1.p3.5.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p3.5.m1.2b"><apply id="Sx3.SSx1.p3.5.m1.2.2.cmml" xref="Sx3.SSx1.p3.5.m1.2.2"><times id="Sx3.SSx1.p3.5.m1.2.2.3.cmml" xref="Sx3.SSx1.p3.5.m1.2.2.3"></times><ci id="Sx3.SSx1.p3.5.m1.2.2.4.cmml" xref="Sx3.SSx1.p3.5.m1.2.2.4">𝑇</ci><interval closure="open" id="Sx3.SSx1.p3.5.m1.2.2.2.3.cmml" xref="Sx3.SSx1.p3.5.m1.2.2.2.2"><apply id="Sx3.SSx1.p3.5.m1.1.1.1.1.1.cmml" xref="Sx3.SSx1.p3.5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p3.5.m1.1.1.1.1.1.1.cmml" xref="Sx3.SSx1.p3.5.m1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p3.5.m1.1.1.1.1.1.2.cmml" xref="Sx3.SSx1.p3.5.m1.1.1.1.1.1.2">𝑓</ci><cn id="Sx3.SSx1.p3.5.m1.1.1.1.1.1.3.cmml" type="integer" xref="Sx3.SSx1.p3.5.m1.1.1.1.1.1.3">1</cn></apply><apply id="Sx3.SSx1.p3.5.m1.2.2.2.2.2.cmml" xref="Sx3.SSx1.p3.5.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p3.5.m1.2.2.2.2.2.1.cmml" xref="Sx3.SSx1.p3.5.m1.2.2.2.2.2">subscript</csymbol><ci id="Sx3.SSx1.p3.5.m1.2.2.2.2.2.2.cmml" xref="Sx3.SSx1.p3.5.m1.2.2.2.2.2.2">𝑓</ci><cn id="Sx3.SSx1.p3.5.m1.2.2.2.2.2.3.cmml" type="integer" xref="Sx3.SSx1.p3.5.m1.2.2.2.2.2.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p3.5.m1.2c">T(f_{1},f_{2})</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p3.5.m1.2d">italic_T ( italic_f start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math> denotes the Tanimoto similarity between two molecular fingerprints, and <math alttext="\phi(m)" class="ltx_Math" display="inline" id="Sx3.SSx1.p3.6.m2.1"><semantics id="Sx3.SSx1.p3.6.m2.1a"><mrow id="Sx3.SSx1.p3.6.m2.1.2" xref="Sx3.SSx1.p3.6.m2.1.2.cmml"><mi id="Sx3.SSx1.p3.6.m2.1.2.2" xref="Sx3.SSx1.p3.6.m2.1.2.2.cmml">ϕ</mi><mo id="Sx3.SSx1.p3.6.m2.1.2.1" xref="Sx3.SSx1.p3.6.m2.1.2.1.cmml">⁢</mo><mrow id="Sx3.SSx1.p3.6.m2.1.2.3.2" xref="Sx3.SSx1.p3.6.m2.1.2.cmml"><mo id="Sx3.SSx1.p3.6.m2.1.2.3.2.1" stretchy="false" xref="Sx3.SSx1.p3.6.m2.1.2.cmml">(</mo><mi id="Sx3.SSx1.p3.6.m2.1.1" xref="Sx3.SSx1.p3.6.m2.1.1.cmml">m</mi><mo id="Sx3.SSx1.p3.6.m2.1.2.3.2.2" stretchy="false" xref="Sx3.SSx1.p3.6.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p3.6.m2.1b"><apply id="Sx3.SSx1.p3.6.m2.1.2.cmml" xref="Sx3.SSx1.p3.6.m2.1.2"><times id="Sx3.SSx1.p3.6.m2.1.2.1.cmml" xref="Sx3.SSx1.p3.6.m2.1.2.1"></times><ci id="Sx3.SSx1.p3.6.m2.1.2.2.cmml" xref="Sx3.SSx1.p3.6.m2.1.2.2">italic-ϕ</ci><ci id="Sx3.SSx1.p3.6.m2.1.1.cmml" xref="Sx3.SSx1.p3.6.m2.1.1">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p3.6.m2.1c">\phi(m)</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p3.6.m2.1d">italic_ϕ ( italic_m )</annotation></semantics></math> is the Morgan fingerprint of molecule <math alttext="m" class="ltx_Math" display="inline" id="Sx3.SSx1.p3.7.m3.1"><semantics id="Sx3.SSx1.p3.7.m3.1a"><mi id="Sx3.SSx1.p3.7.m3.1.1" xref="Sx3.SSx1.p3.7.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p3.7.m3.1b"><ci id="Sx3.SSx1.p3.7.m3.1.1.cmml" xref="Sx3.SSx1.p3.7.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p3.7.m3.1c">m</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p3.7.m3.1d">italic_m</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="Sx3.SSx1.p4">
<p class="ltx_p" id="Sx3.SSx1.p4.2">Additionally, we derived two metrics to compare two sets of predictions, <math alttext="C_{k}" class="ltx_Math" display="inline" id="Sx3.SSx1.p4.1.m1.1"><semantics id="Sx3.SSx1.p4.1.m1.1a"><msub id="Sx3.SSx1.p4.1.m1.1.1" xref="Sx3.SSx1.p4.1.m1.1.1.cmml"><mi id="Sx3.SSx1.p4.1.m1.1.1.2" xref="Sx3.SSx1.p4.1.m1.1.1.2.cmml">C</mi><mi id="Sx3.SSx1.p4.1.m1.1.1.3" xref="Sx3.SSx1.p4.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p4.1.m1.1b"><apply id="Sx3.SSx1.p4.1.m1.1.1.cmml" xref="Sx3.SSx1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p4.1.m1.1.1.1.cmml" xref="Sx3.SSx1.p4.1.m1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p4.1.m1.1.1.2.cmml" xref="Sx3.SSx1.p4.1.m1.1.1.2">𝐶</ci><ci id="Sx3.SSx1.p4.1.m1.1.1.3.cmml" xref="Sx3.SSx1.p4.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p4.1.m1.1c">C_{k}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p4.1.m1.1d">italic_C start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="C^{\prime}_{k}" class="ltx_Math" display="inline" id="Sx3.SSx1.p4.2.m2.1"><semantics id="Sx3.SSx1.p4.2.m2.1a"><msubsup id="Sx3.SSx1.p4.2.m2.1.1" xref="Sx3.SSx1.p4.2.m2.1.1.cmml"><mi id="Sx3.SSx1.p4.2.m2.1.1.2.2" xref="Sx3.SSx1.p4.2.m2.1.1.2.2.cmml">C</mi><mi id="Sx3.SSx1.p4.2.m2.1.1.3" xref="Sx3.SSx1.p4.2.m2.1.1.3.cmml">k</mi><mo id="Sx3.SSx1.p4.2.m2.1.1.2.3" xref="Sx3.SSx1.p4.2.m2.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p4.2.m2.1b"><apply id="Sx3.SSx1.p4.2.m2.1.1.cmml" xref="Sx3.SSx1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p4.2.m2.1.1.1.cmml" xref="Sx3.SSx1.p4.2.m2.1.1">subscript</csymbol><apply id="Sx3.SSx1.p4.2.m2.1.1.2.cmml" xref="Sx3.SSx1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p4.2.m2.1.1.2.1.cmml" xref="Sx3.SSx1.p4.2.m2.1.1">superscript</csymbol><ci id="Sx3.SSx1.p4.2.m2.1.1.2.2.cmml" xref="Sx3.SSx1.p4.2.m2.1.1.2.2">𝐶</ci><ci id="Sx3.SSx1.p4.2.m2.1.1.2.3.cmml" xref="Sx3.SSx1.p4.2.m2.1.1.2.3">′</ci></apply><ci id="Sx3.SSx1.p4.2.m2.1.1.3.cmml" xref="Sx3.SSx1.p4.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p4.2.m2.1c">C^{\prime}_{k}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p4.2.m2.1d">italic_C start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, for a common set of queries: <span class="ltx_text ltx_font_italic" id="Sx3.SSx1.p4.2.1">win rate</span> and <span class="ltx_text ltx_font_italic" id="Sx3.SSx1.p4.2.2">at-least-as-good rate</span>.</p>
</div>
<div class="ltx_para" id="Sx3.SSx1.p5">
<p class="ltx_p" id="Sx3.SSx1.p5.6">First, we had to define what it means for a prediction <math alttext="C_{ki}" class="ltx_Math" display="inline" id="Sx3.SSx1.p5.1.m1.1"><semantics id="Sx3.SSx1.p5.1.m1.1a"><msub id="Sx3.SSx1.p5.1.m1.1.1" xref="Sx3.SSx1.p5.1.m1.1.1.cmml"><mi id="Sx3.SSx1.p5.1.m1.1.1.2" xref="Sx3.SSx1.p5.1.m1.1.1.2.cmml">C</mi><mrow id="Sx3.SSx1.p5.1.m1.1.1.3" xref="Sx3.SSx1.p5.1.m1.1.1.3.cmml"><mi id="Sx3.SSx1.p5.1.m1.1.1.3.2" xref="Sx3.SSx1.p5.1.m1.1.1.3.2.cmml">k</mi><mo id="Sx3.SSx1.p5.1.m1.1.1.3.1" xref="Sx3.SSx1.p5.1.m1.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p5.1.m1.1.1.3.3" xref="Sx3.SSx1.p5.1.m1.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p5.1.m1.1b"><apply id="Sx3.SSx1.p5.1.m1.1.1.cmml" xref="Sx3.SSx1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p5.1.m1.1.1.1.cmml" xref="Sx3.SSx1.p5.1.m1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p5.1.m1.1.1.2.cmml" xref="Sx3.SSx1.p5.1.m1.1.1.2">𝐶</ci><apply id="Sx3.SSx1.p5.1.m1.1.1.3.cmml" xref="Sx3.SSx1.p5.1.m1.1.1.3"><times id="Sx3.SSx1.p5.1.m1.1.1.3.1.cmml" xref="Sx3.SSx1.p5.1.m1.1.1.3.1"></times><ci id="Sx3.SSx1.p5.1.m1.1.1.3.2.cmml" xref="Sx3.SSx1.p5.1.m1.1.1.3.2">𝑘</ci><ci id="Sx3.SSx1.p5.1.m1.1.1.3.3.cmml" xref="Sx3.SSx1.p5.1.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p5.1.m1.1c">C_{ki}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p5.1.m1.1d">italic_C start_POSTSUBSCRIPT italic_k italic_i end_POSTSUBSCRIPT</annotation></semantics></math> to be better than a prediction <math alttext="C^{\prime}_{ki}" class="ltx_Math" display="inline" id="Sx3.SSx1.p5.2.m2.1"><semantics id="Sx3.SSx1.p5.2.m2.1a"><msubsup id="Sx3.SSx1.p5.2.m2.1.1" xref="Sx3.SSx1.p5.2.m2.1.1.cmml"><mi id="Sx3.SSx1.p5.2.m2.1.1.2.2" xref="Sx3.SSx1.p5.2.m2.1.1.2.2.cmml">C</mi><mrow id="Sx3.SSx1.p5.2.m2.1.1.3" xref="Sx3.SSx1.p5.2.m2.1.1.3.cmml"><mi id="Sx3.SSx1.p5.2.m2.1.1.3.2" xref="Sx3.SSx1.p5.2.m2.1.1.3.2.cmml">k</mi><mo id="Sx3.SSx1.p5.2.m2.1.1.3.1" xref="Sx3.SSx1.p5.2.m2.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p5.2.m2.1.1.3.3" xref="Sx3.SSx1.p5.2.m2.1.1.3.3.cmml">i</mi></mrow><mo id="Sx3.SSx1.p5.2.m2.1.1.2.3" xref="Sx3.SSx1.p5.2.m2.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p5.2.m2.1b"><apply id="Sx3.SSx1.p5.2.m2.1.1.cmml" xref="Sx3.SSx1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p5.2.m2.1.1.1.cmml" xref="Sx3.SSx1.p5.2.m2.1.1">subscript</csymbol><apply id="Sx3.SSx1.p5.2.m2.1.1.2.cmml" xref="Sx3.SSx1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p5.2.m2.1.1.2.1.cmml" xref="Sx3.SSx1.p5.2.m2.1.1">superscript</csymbol><ci id="Sx3.SSx1.p5.2.m2.1.1.2.2.cmml" xref="Sx3.SSx1.p5.2.m2.1.1.2.2">𝐶</ci><ci id="Sx3.SSx1.p5.2.m2.1.1.2.3.cmml" xref="Sx3.SSx1.p5.2.m2.1.1.2.3">′</ci></apply><apply id="Sx3.SSx1.p5.2.m2.1.1.3.cmml" xref="Sx3.SSx1.p5.2.m2.1.1.3"><times id="Sx3.SSx1.p5.2.m2.1.1.3.1.cmml" xref="Sx3.SSx1.p5.2.m2.1.1.3.1"></times><ci id="Sx3.SSx1.p5.2.m2.1.1.3.2.cmml" xref="Sx3.SSx1.p5.2.m2.1.1.3.2">𝑘</ci><ci id="Sx3.SSx1.p5.2.m2.1.1.3.3.cmml" xref="Sx3.SSx1.p5.2.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p5.2.m2.1c">C^{\prime}_{ki}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p5.2.m2.1d">italic_C start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k italic_i end_POSTSUBSCRIPT</annotation></semantics></math> given ground truth molecule <math alttext="G_{i}" class="ltx_Math" display="inline" id="Sx3.SSx1.p5.3.m3.1"><semantics id="Sx3.SSx1.p5.3.m3.1a"><msub id="Sx3.SSx1.p5.3.m3.1.1" xref="Sx3.SSx1.p5.3.m3.1.1.cmml"><mi id="Sx3.SSx1.p5.3.m3.1.1.2" xref="Sx3.SSx1.p5.3.m3.1.1.2.cmml">G</mi><mi id="Sx3.SSx1.p5.3.m3.1.1.3" xref="Sx3.SSx1.p5.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p5.3.m3.1b"><apply id="Sx3.SSx1.p5.3.m3.1.1.cmml" xref="Sx3.SSx1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p5.3.m3.1.1.1.cmml" xref="Sx3.SSx1.p5.3.m3.1.1">subscript</csymbol><ci id="Sx3.SSx1.p5.3.m3.1.1.2.cmml" xref="Sx3.SSx1.p5.3.m3.1.1.2">𝐺</ci><ci id="Sx3.SSx1.p5.3.m3.1.1.3.cmml" xref="Sx3.SSx1.p5.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p5.3.m3.1c">G_{i}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p5.3.m3.1d">italic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. Tanimoto similarity on Morgan fingerprints is the standard approach to comparing molecules. However, because fingerprints are typically a lossy representation, situations can arise where <math alttext="\text{T}(\phi(m_{1}),\phi(m_{2}))=1" class="ltx_Math" display="inline" id="Sx3.SSx1.p5.4.m4.2"><semantics id="Sx3.SSx1.p5.4.m4.2a"><mrow id="Sx3.SSx1.p5.4.m4.2.2" xref="Sx3.SSx1.p5.4.m4.2.2.cmml"><mrow id="Sx3.SSx1.p5.4.m4.2.2.2" xref="Sx3.SSx1.p5.4.m4.2.2.2.cmml"><mtext id="Sx3.SSx1.p5.4.m4.2.2.2.4" xref="Sx3.SSx1.p5.4.m4.2.2.2.4a.cmml">T</mtext><mo id="Sx3.SSx1.p5.4.m4.2.2.2.3" xref="Sx3.SSx1.p5.4.m4.2.2.2.3.cmml">⁢</mo><mrow id="Sx3.SSx1.p5.4.m4.2.2.2.2.2" xref="Sx3.SSx1.p5.4.m4.2.2.2.2.3.cmml"><mo id="Sx3.SSx1.p5.4.m4.2.2.2.2.2.3" stretchy="false" xref="Sx3.SSx1.p5.4.m4.2.2.2.2.3.cmml">(</mo><mrow id="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1" xref="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.cmml"><mi id="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.3" xref="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.3.cmml">ϕ</mi><mo id="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.2" xref="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.1.1" xref="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.1.1.1.cmml"><mo id="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.1.1.2" stretchy="false" xref="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.1.1.1" xref="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.1.1.1.2" xref="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.1.1.1.2.cmml">m</mi><mn id="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.1.1.1.3" xref="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.1.1.3" stretchy="false" xref="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.SSx1.p5.4.m4.2.2.2.2.2.4" xref="Sx3.SSx1.p5.4.m4.2.2.2.2.3.cmml">,</mo><mrow id="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2" xref="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.cmml"><mi id="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.3" xref="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.3.cmml">ϕ</mi><mo id="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.2" xref="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.2.cmml">⁢</mo><mrow id="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.1.1" xref="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.1.1.1.cmml"><mo id="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.1.1.2" stretchy="false" xref="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.1.1.1.cmml">(</mo><msub id="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.1.1.1" xref="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.1.1.1.cmml"><mi id="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.1.1.1.2" xref="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.1.1.1.2.cmml">m</mi><mn id="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.1.1.1.3" xref="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.1.1.1.3.cmml">2</mn></msub><mo id="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.1.1.3" stretchy="false" xref="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.SSx1.p5.4.m4.2.2.2.2.2.5" stretchy="false" xref="Sx3.SSx1.p5.4.m4.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="Sx3.SSx1.p5.4.m4.2.2.3" xref="Sx3.SSx1.p5.4.m4.2.2.3.cmml">=</mo><mn id="Sx3.SSx1.p5.4.m4.2.2.4" xref="Sx3.SSx1.p5.4.m4.2.2.4.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p5.4.m4.2b"><apply id="Sx3.SSx1.p5.4.m4.2.2.cmml" xref="Sx3.SSx1.p5.4.m4.2.2"><eq id="Sx3.SSx1.p5.4.m4.2.2.3.cmml" xref="Sx3.SSx1.p5.4.m4.2.2.3"></eq><apply id="Sx3.SSx1.p5.4.m4.2.2.2.cmml" xref="Sx3.SSx1.p5.4.m4.2.2.2"><times id="Sx3.SSx1.p5.4.m4.2.2.2.3.cmml" xref="Sx3.SSx1.p5.4.m4.2.2.2.3"></times><ci id="Sx3.SSx1.p5.4.m4.2.2.2.4a.cmml" xref="Sx3.SSx1.p5.4.m4.2.2.2.4"><mtext id="Sx3.SSx1.p5.4.m4.2.2.2.4.cmml" xref="Sx3.SSx1.p5.4.m4.2.2.2.4">T</mtext></ci><interval closure="open" id="Sx3.SSx1.p5.4.m4.2.2.2.2.3.cmml" xref="Sx3.SSx1.p5.4.m4.2.2.2.2.2"><apply id="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.cmml" xref="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1"><times id="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.2.cmml" xref="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.2"></times><ci id="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.3.cmml" xref="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.3">italic-ϕ</ci><apply id="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.1.1.1.2">𝑚</ci><cn id="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="Sx3.SSx1.p5.4.m4.1.1.1.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.cmml" xref="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2"><times id="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.2.cmml" xref="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.2"></times><ci id="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.3.cmml" xref="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.3">italic-ϕ</ci><apply id="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.1.1.1.cmml" xref="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.1.1.1.1.cmml" xref="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.1.1.1.2.cmml" xref="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.1.1.1.2">𝑚</ci><cn id="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.1.1.1.3.cmml" type="integer" xref="Sx3.SSx1.p5.4.m4.2.2.2.2.2.2.1.1.1.3">2</cn></apply></apply></interval></apply><cn id="Sx3.SSx1.p5.4.m4.2.2.4.cmml" type="integer" xref="Sx3.SSx1.p5.4.m4.2.2.4">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p5.4.m4.2c">\text{T}(\phi(m_{1}),\phi(m_{2}))=1</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p5.4.m4.2d">T ( italic_ϕ ( italic_m start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) , italic_ϕ ( italic_m start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ) = 1</annotation></semantics></math> while <math alttext="m_{1}\neq m_{2}" class="ltx_Math" display="inline" id="Sx3.SSx1.p5.5.m5.1"><semantics id="Sx3.SSx1.p5.5.m5.1a"><mrow id="Sx3.SSx1.p5.5.m5.1.1" xref="Sx3.SSx1.p5.5.m5.1.1.cmml"><msub id="Sx3.SSx1.p5.5.m5.1.1.2" xref="Sx3.SSx1.p5.5.m5.1.1.2.cmml"><mi id="Sx3.SSx1.p5.5.m5.1.1.2.2" xref="Sx3.SSx1.p5.5.m5.1.1.2.2.cmml">m</mi><mn id="Sx3.SSx1.p5.5.m5.1.1.2.3" xref="Sx3.SSx1.p5.5.m5.1.1.2.3.cmml">1</mn></msub><mo id="Sx3.SSx1.p5.5.m5.1.1.1" xref="Sx3.SSx1.p5.5.m5.1.1.1.cmml">≠</mo><msub id="Sx3.SSx1.p5.5.m5.1.1.3" xref="Sx3.SSx1.p5.5.m5.1.1.3.cmml"><mi id="Sx3.SSx1.p5.5.m5.1.1.3.2" xref="Sx3.SSx1.p5.5.m5.1.1.3.2.cmml">m</mi><mn id="Sx3.SSx1.p5.5.m5.1.1.3.3" xref="Sx3.SSx1.p5.5.m5.1.1.3.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p5.5.m5.1b"><apply id="Sx3.SSx1.p5.5.m5.1.1.cmml" xref="Sx3.SSx1.p5.5.m5.1.1"><neq id="Sx3.SSx1.p5.5.m5.1.1.1.cmml" xref="Sx3.SSx1.p5.5.m5.1.1.1"></neq><apply id="Sx3.SSx1.p5.5.m5.1.1.2.cmml" xref="Sx3.SSx1.p5.5.m5.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p5.5.m5.1.1.2.1.cmml" xref="Sx3.SSx1.p5.5.m5.1.1.2">subscript</csymbol><ci id="Sx3.SSx1.p5.5.m5.1.1.2.2.cmml" xref="Sx3.SSx1.p5.5.m5.1.1.2.2">𝑚</ci><cn id="Sx3.SSx1.p5.5.m5.1.1.2.3.cmml" type="integer" xref="Sx3.SSx1.p5.5.m5.1.1.2.3">1</cn></apply><apply id="Sx3.SSx1.p5.5.m5.1.1.3.cmml" xref="Sx3.SSx1.p5.5.m5.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx1.p5.5.m5.1.1.3.1.cmml" xref="Sx3.SSx1.p5.5.m5.1.1.3">subscript</csymbol><ci id="Sx3.SSx1.p5.5.m5.1.1.3.2.cmml" xref="Sx3.SSx1.p5.5.m5.1.1.3.2">𝑚</ci><cn id="Sx3.SSx1.p5.5.m5.1.1.3.3.cmml" type="integer" xref="Sx3.SSx1.p5.5.m5.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p5.5.m5.1c">m_{1}\neq m_{2}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p5.5.m5.1d">italic_m start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≠ italic_m start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>. To address such ambiguities, we enhanced the ranking function with a control mechanism that checks for an exact match between candidates and the ground truth. This mechanism ensures that when both predictions achieve perfect similarity, the exact match determines superiority. The ranking function <math alttext="R" class="ltx_Math" display="inline" id="Sx3.SSx1.p5.6.m6.1"><semantics id="Sx3.SSx1.p5.6.m6.1a"><mi id="Sx3.SSx1.p5.6.m6.1.1" xref="Sx3.SSx1.p5.6.m6.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p5.6.m6.1b"><ci id="Sx3.SSx1.p5.6.m6.1.1.cmml" xref="Sx3.SSx1.p5.6.m6.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p5.6.m6.1c">R</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p5.6.m6.1d">italic_R</annotation></semantics></math> is then defined as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx3.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="R(C_{ki},C^{\prime}_{ki},G_{i})=\begin{cases}&amp;1\quad\text{ if }\max\limits_{c%
\in C_{ki}}{\text{T}(\phi(c),\phi(G_{i}))}&gt;\max\limits_{c^{\prime}\in C^{%
\prime}_{ki}}{\text{T}(\phi(c^{\prime}),\phi(G_{i}))}\\[10.00002pt]
&amp;1\quad\text{ if }G_{i}\in C_{ki}\land G_{i}\notin C^{\prime}_{ki}\\[10.00002%
pt]
&amp;0\quad\text{ otherwise }\end{cases}" class="ltx_Math" display="block" id="Sx3.Ex3.m1.6"><semantics id="Sx3.Ex3.m1.6a"><mrow id="Sx3.Ex3.m1.6.6" xref="Sx3.Ex3.m1.6.6.cmml"><mrow id="Sx3.Ex3.m1.6.6.3" xref="Sx3.Ex3.m1.6.6.3.cmml"><mi id="Sx3.Ex3.m1.6.6.3.5" xref="Sx3.Ex3.m1.6.6.3.5.cmml">R</mi><mo id="Sx3.Ex3.m1.6.6.3.4" xref="Sx3.Ex3.m1.6.6.3.4.cmml">⁢</mo><mrow id="Sx3.Ex3.m1.6.6.3.3.3" xref="Sx3.Ex3.m1.6.6.3.3.4.cmml"><mo id="Sx3.Ex3.m1.6.6.3.3.3.4" stretchy="false" xref="Sx3.Ex3.m1.6.6.3.3.4.cmml">(</mo><msub id="Sx3.Ex3.m1.4.4.1.1.1.1" xref="Sx3.Ex3.m1.4.4.1.1.1.1.cmml"><mi id="Sx3.Ex3.m1.4.4.1.1.1.1.2" xref="Sx3.Ex3.m1.4.4.1.1.1.1.2.cmml">C</mi><mrow id="Sx3.Ex3.m1.4.4.1.1.1.1.3" xref="Sx3.Ex3.m1.4.4.1.1.1.1.3.cmml"><mi id="Sx3.Ex3.m1.4.4.1.1.1.1.3.2" xref="Sx3.Ex3.m1.4.4.1.1.1.1.3.2.cmml">k</mi><mo id="Sx3.Ex3.m1.4.4.1.1.1.1.3.1" xref="Sx3.Ex3.m1.4.4.1.1.1.1.3.1.cmml">⁢</mo><mi id="Sx3.Ex3.m1.4.4.1.1.1.1.3.3" xref="Sx3.Ex3.m1.4.4.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="Sx3.Ex3.m1.6.6.3.3.3.5" xref="Sx3.Ex3.m1.6.6.3.3.4.cmml">,</mo><msubsup id="Sx3.Ex3.m1.5.5.2.2.2.2" xref="Sx3.Ex3.m1.5.5.2.2.2.2.cmml"><mi id="Sx3.Ex3.m1.5.5.2.2.2.2.2.2" xref="Sx3.Ex3.m1.5.5.2.2.2.2.2.2.cmml">C</mi><mrow id="Sx3.Ex3.m1.5.5.2.2.2.2.3" xref="Sx3.Ex3.m1.5.5.2.2.2.2.3.cmml"><mi id="Sx3.Ex3.m1.5.5.2.2.2.2.3.2" xref="Sx3.Ex3.m1.5.5.2.2.2.2.3.2.cmml">k</mi><mo id="Sx3.Ex3.m1.5.5.2.2.2.2.3.1" xref="Sx3.Ex3.m1.5.5.2.2.2.2.3.1.cmml">⁢</mo><mi id="Sx3.Ex3.m1.5.5.2.2.2.2.3.3" xref="Sx3.Ex3.m1.5.5.2.2.2.2.3.3.cmml">i</mi></mrow><mo id="Sx3.Ex3.m1.5.5.2.2.2.2.2.3" xref="Sx3.Ex3.m1.5.5.2.2.2.2.2.3.cmml">′</mo></msubsup><mo id="Sx3.Ex3.m1.6.6.3.3.3.6" xref="Sx3.Ex3.m1.6.6.3.3.4.cmml">,</mo><msub id="Sx3.Ex3.m1.6.6.3.3.3.3" xref="Sx3.Ex3.m1.6.6.3.3.3.3.cmml"><mi id="Sx3.Ex3.m1.6.6.3.3.3.3.2" xref="Sx3.Ex3.m1.6.6.3.3.3.3.2.cmml">G</mi><mi id="Sx3.Ex3.m1.6.6.3.3.3.3.3" xref="Sx3.Ex3.m1.6.6.3.3.3.3.3.cmml">i</mi></msub><mo id="Sx3.Ex3.m1.6.6.3.3.3.7" stretchy="false" xref="Sx3.Ex3.m1.6.6.3.3.4.cmml">)</mo></mrow></mrow><mo id="Sx3.Ex3.m1.6.6.4" xref="Sx3.Ex3.m1.6.6.4.cmml">=</mo><mrow id="Sx3.Ex3.m1.3.3" xref="Sx3.Ex3.m1.6.6.5.1.cmml"><mo id="Sx3.Ex3.m1.3.3.4" xref="Sx3.Ex3.m1.6.6.5.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="Sx3.Ex3.m1.3.3.3" rowspacing="0pt" xref="Sx3.Ex3.m1.6.6.5.1.cmml"><mtr id="Sx3.Ex3.m1.3.3.3a" xref="Sx3.Ex3.m1.6.6.5.1.cmml"><mtd id="Sx3.Ex3.m1.3.3.3b" xref="Sx3.Ex3.m1.6.6.5.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.Ex3.m1.3.3.3c" xref="Sx3.Ex3.m1.6.6.5.1.cmml"><mrow id="Sx3.Ex3.m1.1.1.1.1.1.1" xref="Sx3.Ex3.m1.1.1.1.1.1.1.cmml"><mrow id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.2.cmml"><mn id="Sx3.Ex3.m1.1.1.1.1.1.1.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.2.cmml">1</mn><mspace id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.2" width="1em" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.2.cmml"></mspace><mrow id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.cmml"><mtext id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.4" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.4a.cmml"> if </mtext><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.3" lspace="0.167em" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.3.cmml">⁢</mo><mrow id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.cmml"><munder id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.cmml"><mi id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.2.cmml">max</mi><mrow id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.cmml"><mi id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.2.cmml">c</mi><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.1" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.1.cmml">∈</mo><msub id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.cmml"><mi id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.2.cmml">C</mi><mrow id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.3" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.3.cmml"><mi id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.3.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.3.2.cmml">k</mi><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.3.1" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.3.1.cmml">⁢</mo><mi id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.3.3" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.3.3.cmml">i</mi></mrow></msub></mrow></munder><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5a" lspace="0.167em" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.cmml">⁡</mo><mtext id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.2a.cmml">T</mtext></mrow><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.3a" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.3.cmml">⁢</mo><mrow id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.3.cmml"><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.3" stretchy="false" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.3.cmml">(</mo><mrow id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.1.1.1" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.1.1.1.cmml"><mi id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.1.1.1.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.1.1.1.2.cmml">ϕ</mi><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.1.1.1.1" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.1.1.1.1.cmml">⁢</mo><mrow id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.1.1.1.3.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.1.1.1.cmml"><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.1.1.1.3.2.1" stretchy="false" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.1.1.1.cmml">(</mo><mi id="Sx3.Ex3.m1.1.1.1.1.1.1.1" xref="Sx3.Ex3.m1.1.1.1.1.1.1.1.cmml">c</mi><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.1.1.1.3.2.2" stretchy="false" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.4" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.3.cmml">,</mo><mrow id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.cmml"><mi id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.3" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.3.cmml">ϕ</mi><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.2.cmml">⁢</mo><mrow id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.1.1" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.1.1.1.cmml"><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.1.1.2" stretchy="false" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.1.1.1.cmml">(</mo><msub id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.1.1.1" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.1.1.1.cmml"><mi id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.1.1.1.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.1.1.1.2.cmml">G</mi><mi id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.1.1.1.3" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.1.1.3" stretchy="false" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.5" stretchy="false" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.6" xref="Sx3.Ex3.m1.1.1.1.1.1.1.6.cmml">&gt;</mo><mrow id="Sx3.Ex3.m1.1.1.1.1.1.1.5" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.cmml"><mrow id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.cmml"><munder id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.cmml"><mi id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.2.cmml">max</mi><mrow id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.cmml"><msup id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.2.cmml"><mi id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.2.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.2.2.cmml">c</mi><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.2.3" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.2.3.cmml">′</mo></msup><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.1" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.1.cmml">∈</mo><msubsup id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.cmml"><mi id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.2.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.2.2.cmml">C</mi><mrow id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.3" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.3.cmml"><mi id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.3.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.3.2.cmml">k</mi><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.3.1" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.3.1.cmml">⁢</mo><mi id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.3.3" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.3.3.cmml">i</mi></mrow><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.2.3" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.2.3.cmml">′</mo></msubsup></mrow></munder><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4a" lspace="0.167em" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.cmml">⁡</mo><mtext id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.2a.cmml">T</mtext></mrow><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.5.3" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.3.cmml">⁢</mo><mrow id="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.3.cmml"><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.3" stretchy="false" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.3.cmml">(</mo><mrow id="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1" xref="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.cmml"><mi id="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.3" xref="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.3.cmml">ϕ</mi><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.2.cmml">⁢</mo><mrow id="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.1.1" xref="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.1.1.1.cmml"><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.1.1.2" stretchy="false" xref="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.1.1.1.cmml">(</mo><msup id="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.1.1.1" xref="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.1.1.1.cmml"><mi id="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.1.1.1.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.1.1.1.2.cmml">c</mi><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.1.1.1.3" xref="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.1.1.3" stretchy="false" xref="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.4" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.3.cmml">,</mo><mrow id="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.cmml"><mi id="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.3" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.3.cmml">ϕ</mi><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.2.cmml">⁢</mo><mrow id="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.1.1" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.1.1.1.cmml"><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.1.1.2" stretchy="false" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.1.1.1.cmml">(</mo><msub id="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.1.1.1" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.1.1.1.cmml"><mi id="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.1.1.1.2" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.1.1.1.2.cmml">G</mi><mi id="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.1.1.1.3" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.1.1.3" stretchy="false" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.5" stretchy="false" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.3.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="Sx3.Ex3.m1.3.3.3d" xref="Sx3.Ex3.m1.6.6.5.1.cmml"><mtd id="Sx3.Ex3.m1.3.3.3e" xref="Sx3.Ex3.m1.6.6.5.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.Ex3.m1.3.3.3f" xref="Sx3.Ex3.m1.6.6.5.1.cmml"><mrow id="Sx3.Ex3.m1.2.2.2.2.1.1" xref="Sx3.Ex3.m1.2.2.2.2.1.1.cmml"><mrow id="Sx3.Ex3.m1.2.2.2.2.1.1.2.1" xref="Sx3.Ex3.m1.2.2.2.2.1.1.2.2.cmml"><mn id="Sx3.Ex3.m1.2.2.2.2.1.1.1" xref="Sx3.Ex3.m1.2.2.2.2.1.1.1.cmml">1</mn><mspace id="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.2" width="1em" xref="Sx3.Ex3.m1.2.2.2.2.1.1.2.2.cmml"></mspace><mrow id="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1" xref="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.cmml"><mtext id="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.2" xref="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.2a.cmml"> if </mtext><mo id="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.1" xref="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.1.cmml">⁢</mo><msub id="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.3" xref="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.3.cmml"><mi id="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.3.2" xref="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.3.2.cmml">G</mi><mi id="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.3.3" xref="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.3.3.cmml">i</mi></msub></mrow></mrow><mo id="Sx3.Ex3.m1.2.2.2.2.1.1.4" xref="Sx3.Ex3.m1.2.2.2.2.1.1.4.cmml">∈</mo><mrow id="Sx3.Ex3.m1.2.2.2.2.1.1.5" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.cmml"><msub id="Sx3.Ex3.m1.2.2.2.2.1.1.5.2" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.cmml"><mi id="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.2" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.2.cmml">C</mi><mrow id="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.3" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.3.cmml"><mi id="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.3.2" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.3.2.cmml">k</mi><mo id="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.3.1" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.3.1.cmml">⁢</mo><mi id="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.3.3" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.3.3.cmml">i</mi></mrow></msub><mo id="Sx3.Ex3.m1.2.2.2.2.1.1.5.1" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.1.cmml">∧</mo><msub id="Sx3.Ex3.m1.2.2.2.2.1.1.5.3" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.3.cmml"><mi id="Sx3.Ex3.m1.2.2.2.2.1.1.5.3.2" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.3.2.cmml">G</mi><mi id="Sx3.Ex3.m1.2.2.2.2.1.1.5.3.3" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.3.3.cmml">i</mi></msub></mrow><mo id="Sx3.Ex3.m1.2.2.2.2.1.1.6" xref="Sx3.Ex3.m1.2.2.2.2.1.1.6.cmml">∉</mo><msubsup id="Sx3.Ex3.m1.2.2.2.2.1.1.7" xref="Sx3.Ex3.m1.2.2.2.2.1.1.7.cmml"><mi id="Sx3.Ex3.m1.2.2.2.2.1.1.7.2.2" xref="Sx3.Ex3.m1.2.2.2.2.1.1.7.2.2.cmml">C</mi><mrow id="Sx3.Ex3.m1.2.2.2.2.1.1.7.3" xref="Sx3.Ex3.m1.2.2.2.2.1.1.7.3.cmml"><mi id="Sx3.Ex3.m1.2.2.2.2.1.1.7.3.2" xref="Sx3.Ex3.m1.2.2.2.2.1.1.7.3.2.cmml">k</mi><mo id="Sx3.Ex3.m1.2.2.2.2.1.1.7.3.1" xref="Sx3.Ex3.m1.2.2.2.2.1.1.7.3.1.cmml">⁢</mo><mi id="Sx3.Ex3.m1.2.2.2.2.1.1.7.3.3" xref="Sx3.Ex3.m1.2.2.2.2.1.1.7.3.3.cmml">i</mi></mrow><mo id="Sx3.Ex3.m1.2.2.2.2.1.1.7.2.3" xref="Sx3.Ex3.m1.2.2.2.2.1.1.7.2.3.cmml">′</mo></msubsup></mrow></mtd></mtr><mtr id="Sx3.Ex3.m1.3.3.3g" xref="Sx3.Ex3.m1.6.6.5.1.cmml"><mtd id="Sx3.Ex3.m1.3.3.3h" xref="Sx3.Ex3.m1.6.6.5.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx3.Ex3.m1.3.3.3i" xref="Sx3.Ex3.m1.6.6.5.1.cmml"><mrow id="Sx3.Ex3.m1.3.3.3.3.1.1.4" xref="Sx3.Ex3.m1.3.3.3.3.1.1.3.cmml"><mn id="Sx3.Ex3.m1.3.3.3.3.1.1.1" xref="Sx3.Ex3.m1.3.3.3.3.1.1.1.cmml">0</mn><mspace id="Sx3.Ex3.m1.3.3.3.3.1.1.4.1" width="1em" xref="Sx3.Ex3.m1.3.3.3.3.1.1.3.cmml"></mspace><mtext id="Sx3.Ex3.m1.3.3.3.3.1.1.2" xref="Sx3.Ex3.m1.3.3.3.3.1.1.2a.cmml"> otherwise </mtext></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex3.m1.6b"><apply id="Sx3.Ex3.m1.6.6.cmml" xref="Sx3.Ex3.m1.6.6"><eq id="Sx3.Ex3.m1.6.6.4.cmml" xref="Sx3.Ex3.m1.6.6.4"></eq><apply id="Sx3.Ex3.m1.6.6.3.cmml" xref="Sx3.Ex3.m1.6.6.3"><times id="Sx3.Ex3.m1.6.6.3.4.cmml" xref="Sx3.Ex3.m1.6.6.3.4"></times><ci id="Sx3.Ex3.m1.6.6.3.5.cmml" xref="Sx3.Ex3.m1.6.6.3.5">𝑅</ci><vector id="Sx3.Ex3.m1.6.6.3.3.4.cmml" xref="Sx3.Ex3.m1.6.6.3.3.3"><apply id="Sx3.Ex3.m1.4.4.1.1.1.1.cmml" xref="Sx3.Ex3.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex3.m1.4.4.1.1.1.1.1.cmml" xref="Sx3.Ex3.m1.4.4.1.1.1.1">subscript</csymbol><ci id="Sx3.Ex3.m1.4.4.1.1.1.1.2.cmml" xref="Sx3.Ex3.m1.4.4.1.1.1.1.2">𝐶</ci><apply id="Sx3.Ex3.m1.4.4.1.1.1.1.3.cmml" xref="Sx3.Ex3.m1.4.4.1.1.1.1.3"><times id="Sx3.Ex3.m1.4.4.1.1.1.1.3.1.cmml" xref="Sx3.Ex3.m1.4.4.1.1.1.1.3.1"></times><ci id="Sx3.Ex3.m1.4.4.1.1.1.1.3.2.cmml" xref="Sx3.Ex3.m1.4.4.1.1.1.1.3.2">𝑘</ci><ci id="Sx3.Ex3.m1.4.4.1.1.1.1.3.3.cmml" xref="Sx3.Ex3.m1.4.4.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="Sx3.Ex3.m1.5.5.2.2.2.2.cmml" xref="Sx3.Ex3.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.Ex3.m1.5.5.2.2.2.2.1.cmml" xref="Sx3.Ex3.m1.5.5.2.2.2.2">subscript</csymbol><apply id="Sx3.Ex3.m1.5.5.2.2.2.2.2.cmml" xref="Sx3.Ex3.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.Ex3.m1.5.5.2.2.2.2.2.1.cmml" xref="Sx3.Ex3.m1.5.5.2.2.2.2">superscript</csymbol><ci id="Sx3.Ex3.m1.5.5.2.2.2.2.2.2.cmml" xref="Sx3.Ex3.m1.5.5.2.2.2.2.2.2">𝐶</ci><ci id="Sx3.Ex3.m1.5.5.2.2.2.2.2.3.cmml" xref="Sx3.Ex3.m1.5.5.2.2.2.2.2.3">′</ci></apply><apply id="Sx3.Ex3.m1.5.5.2.2.2.2.3.cmml" xref="Sx3.Ex3.m1.5.5.2.2.2.2.3"><times id="Sx3.Ex3.m1.5.5.2.2.2.2.3.1.cmml" xref="Sx3.Ex3.m1.5.5.2.2.2.2.3.1"></times><ci id="Sx3.Ex3.m1.5.5.2.2.2.2.3.2.cmml" xref="Sx3.Ex3.m1.5.5.2.2.2.2.3.2">𝑘</ci><ci id="Sx3.Ex3.m1.5.5.2.2.2.2.3.3.cmml" xref="Sx3.Ex3.m1.5.5.2.2.2.2.3.3">𝑖</ci></apply></apply><apply id="Sx3.Ex3.m1.6.6.3.3.3.3.cmml" xref="Sx3.Ex3.m1.6.6.3.3.3.3"><csymbol cd="ambiguous" id="Sx3.Ex3.m1.6.6.3.3.3.3.1.cmml" xref="Sx3.Ex3.m1.6.6.3.3.3.3">subscript</csymbol><ci id="Sx3.Ex3.m1.6.6.3.3.3.3.2.cmml" xref="Sx3.Ex3.m1.6.6.3.3.3.3.2">𝐺</ci><ci id="Sx3.Ex3.m1.6.6.3.3.3.3.3.cmml" xref="Sx3.Ex3.m1.6.6.3.3.3.3.3">𝑖</ci></apply></vector></apply><apply id="Sx3.Ex3.m1.6.6.5.1.cmml" xref="Sx3.Ex3.m1.3.3"><csymbol cd="latexml" id="Sx3.Ex3.m1.6.6.5.1.1.cmml" xref="Sx3.Ex3.m1.3.3.4">cases</csymbol><ci id="Sx3.Ex3.m1.6.6.5.1.2a.cmml" xref="Sx3.Ex3.m1.3.3"><mtext class="ltx_mathvariant_italic" id="Sx3.Ex3.m1.6.6.5.1.2.cmml" xref="Sx3.Ex3.m1.3.3.4">otherwise</mtext></ci><apply id="Sx3.Ex3.m1.1.1.1.1.1.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1"><gt id="Sx3.Ex3.m1.1.1.1.1.1.1.6.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.6"></gt><list id="Sx3.Ex3.m1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1"><cn id="Sx3.Ex3.m1.1.1.1.1.1.1.2.cmml" type="integer" xref="Sx3.Ex3.m1.1.1.1.1.1.1.2">1</cn><apply id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1"><times id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.3.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.3"></times><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.4a.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.4"><mtext id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.4.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.4"> if </mtext></ci><apply id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5"><apply id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1"><csymbol cd="ambiguous" id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1">subscript</csymbol><max id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.2.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.2"></max><apply id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3"><in id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.1"></in><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.2.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.2">𝑐</ci><apply id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3"><csymbol cd="ambiguous" id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3">subscript</csymbol><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.2.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.2">𝐶</ci><apply id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.3.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.3"><times id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.3.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.3.1"></times><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.3.2.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.3.2">𝑘</ci><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.3.3.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.1.3.3.3.3">𝑖</ci></apply></apply></apply></apply><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.2a.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.2"><mtext id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.2.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.5.2">T</mtext></ci></apply><interval closure="open" id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.3.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2"><apply id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.1.1.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.1.1.1"><times id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.1.1.1.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.1.1.1.1"></times><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.1.1.1.2.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.1.1.1.2">italic-ϕ</ci><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.1">𝑐</ci></apply><apply id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2"><times id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.2.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.2"></times><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.3.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.3">italic-ϕ</ci><apply id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.1.1.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.1.1"><csymbol cd="ambiguous" id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.1.1.1.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.1.1">subscript</csymbol><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.1.1.1.2.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.1.1.1.2">𝐺</ci><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.1.1.1.3.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.3.1.1.2.2.2.1.1.1.3">𝑖</ci></apply></apply></interval></apply></list><apply id="Sx3.Ex3.m1.1.1.1.1.1.1.5.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5"><times id="Sx3.Ex3.m1.1.1.1.1.1.1.5.3.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.3"></times><apply id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4"><apply id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1"><csymbol cd="ambiguous" id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1">subscript</csymbol><max id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.2.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.2"></max><apply id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3"><in id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.1"></in><apply id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.2.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.2"><csymbol cd="ambiguous" id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.2.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.2">superscript</csymbol><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.2.2.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.2.2">𝑐</ci><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.2.3.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.2.3">′</ci></apply><apply id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3"><csymbol cd="ambiguous" id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3">subscript</csymbol><apply id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.2.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3"><csymbol cd="ambiguous" id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.2.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3">superscript</csymbol><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.2.2.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.2.2">𝐶</ci><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.2.3.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.2.3">′</ci></apply><apply id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.3.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.3"><times id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.3.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.3.1"></times><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.3.2.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.3.2">𝑘</ci><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.3.3.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.1.3.3.3.3">𝑖</ci></apply></apply></apply></apply><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.2a.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.2"><mtext id="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.2.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.4.2">T</mtext></ci></apply><interval closure="open" id="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.3.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2"><apply id="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1"><times id="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.2.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.2"></times><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.3.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.3">italic-ϕ</ci><apply id="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.1.1.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.1.1">superscript</csymbol><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.1.1.1.2">𝑐</ci><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.4.1.1.1.1.1.1.3">′</ci></apply></apply><apply id="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2"><times id="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.2.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.2"></times><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.3.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.3">italic-ϕ</ci><apply id="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.1.1.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.1.1"><csymbol cd="ambiguous" id="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.1.1.1.1.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.1.1">subscript</csymbol><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.1.1.1.2.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.1.1.1.2">𝐺</ci><ci id="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.1.1.1.3.cmml" xref="Sx3.Ex3.m1.1.1.1.1.1.1.5.2.2.2.1.1.1.3">𝑖</ci></apply></apply></interval></apply></apply><ci id="Sx3.Ex3.m1.6.6.5.1.4a.cmml" xref="Sx3.Ex3.m1.3.3"><mtext class="ltx_mathvariant_italic" id="Sx3.Ex3.m1.6.6.5.1.4.cmml" xref="Sx3.Ex3.m1.3.3.4">otherwise</mtext></ci><apply id="Sx3.Ex3.m1.2.2.2.2.1.1.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1"><and id="Sx3.Ex3.m1.2.2.2.2.1.1a.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1"></and><apply id="Sx3.Ex3.m1.2.2.2.2.1.1b.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1"><in id="Sx3.Ex3.m1.2.2.2.2.1.1.4.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.4"></in><list id="Sx3.Ex3.m1.2.2.2.2.1.1.2.2.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.2.1"><cn id="Sx3.Ex3.m1.2.2.2.2.1.1.1.cmml" type="integer" xref="Sx3.Ex3.m1.2.2.2.2.1.1.1">1</cn><apply id="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1"><times id="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.1.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.1"></times><ci id="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.2a.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.2"><mtext id="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.2.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.2"> if </mtext></ci><apply id="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.3.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.3.1.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.3">subscript</csymbol><ci id="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.3.2.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.3.2">𝐺</ci><ci id="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.3.3.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.2.1.1.3.3">𝑖</ci></apply></apply></list><apply id="Sx3.Ex3.m1.2.2.2.2.1.1.5.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5"><and id="Sx3.Ex3.m1.2.2.2.2.1.1.5.1.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.1"></and><apply id="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.2"><csymbol cd="ambiguous" id="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.1.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.2">subscript</csymbol><ci id="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.2.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.2">𝐶</ci><apply id="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.3.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.3"><times id="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.3.1.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.3.1"></times><ci id="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.3.2.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.3.2">𝑘</ci><ci id="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.3.3.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.2.3.3">𝑖</ci></apply></apply><apply id="Sx3.Ex3.m1.2.2.2.2.1.1.5.3.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.3"><csymbol cd="ambiguous" id="Sx3.Ex3.m1.2.2.2.2.1.1.5.3.1.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.3">subscript</csymbol><ci id="Sx3.Ex3.m1.2.2.2.2.1.1.5.3.2.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.3.2">𝐺</ci><ci id="Sx3.Ex3.m1.2.2.2.2.1.1.5.3.3.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.5.3.3">𝑖</ci></apply></apply></apply><apply id="Sx3.Ex3.m1.2.2.2.2.1.1c.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1"><notin id="Sx3.Ex3.m1.2.2.2.2.1.1.6.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.6"></notin><share href="https://arxiv.org/html/2502.05114v1#Sx3.Ex3.m1.2.2.2.2.1.1.5.cmml" id="Sx3.Ex3.m1.2.2.2.2.1.1d.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1"></share><apply id="Sx3.Ex3.m1.2.2.2.2.1.1.7.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.7"><csymbol cd="ambiguous" id="Sx3.Ex3.m1.2.2.2.2.1.1.7.1.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.7">subscript</csymbol><apply id="Sx3.Ex3.m1.2.2.2.2.1.1.7.2.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.7"><csymbol cd="ambiguous" id="Sx3.Ex3.m1.2.2.2.2.1.1.7.2.1.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.7">superscript</csymbol><ci id="Sx3.Ex3.m1.2.2.2.2.1.1.7.2.2.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.7.2.2">𝐶</ci><ci id="Sx3.Ex3.m1.2.2.2.2.1.1.7.2.3.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.7.2.3">′</ci></apply><apply id="Sx3.Ex3.m1.2.2.2.2.1.1.7.3.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.7.3"><times id="Sx3.Ex3.m1.2.2.2.2.1.1.7.3.1.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.7.3.1"></times><ci id="Sx3.Ex3.m1.2.2.2.2.1.1.7.3.2.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.7.3.2">𝑘</ci><ci id="Sx3.Ex3.m1.2.2.2.2.1.1.7.3.3.cmml" xref="Sx3.Ex3.m1.2.2.2.2.1.1.7.3.3">𝑖</ci></apply></apply></apply></apply><ci id="Sx3.Ex3.m1.6.6.5.1.6a.cmml" xref="Sx3.Ex3.m1.3.3"><mtext class="ltx_mathvariant_italic" id="Sx3.Ex3.m1.6.6.5.1.6.cmml" xref="Sx3.Ex3.m1.3.3.4">otherwise</mtext></ci><list id="Sx3.Ex3.m1.3.3.3.3.1.1.3.cmml" xref="Sx3.Ex3.m1.3.3.3.3.1.1.4"><cn id="Sx3.Ex3.m1.3.3.3.3.1.1.1.cmml" type="integer" xref="Sx3.Ex3.m1.3.3.3.3.1.1.1">0</cn><ci id="Sx3.Ex3.m1.3.3.3.3.1.1.2a.cmml" xref="Sx3.Ex3.m1.3.3.3.3.1.1.2"><mtext id="Sx3.Ex3.m1.3.3.3.3.1.1.2.cmml" xref="Sx3.Ex3.m1.3.3.3.3.1.1.2"> otherwise </mtext></ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex3.m1.6c">R(C_{ki},C^{\prime}_{ki},G_{i})=\begin{cases}&amp;1\quad\text{ if }\max\limits_{c%
\in C_{ki}}{\text{T}(\phi(c),\phi(G_{i}))}&gt;\max\limits_{c^{\prime}\in C^{%
\prime}_{ki}}{\text{T}(\phi(c^{\prime}),\phi(G_{i}))}\\[10.00002pt]
&amp;1\quad\text{ if }G_{i}\in C_{ki}\land G_{i}\notin C^{\prime}_{ki}\\[10.00002%
pt]
&amp;0\quad\text{ otherwise }\end{cases}</annotation><annotation encoding="application/x-llamapun" id="Sx3.Ex3.m1.6d">italic_R ( italic_C start_POSTSUBSCRIPT italic_k italic_i end_POSTSUBSCRIPT , italic_C start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k italic_i end_POSTSUBSCRIPT , italic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = { start_ROW start_CELL end_CELL start_CELL 1 if roman_max start_POSTSUBSCRIPT italic_c ∈ italic_C start_POSTSUBSCRIPT italic_k italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT T ( italic_ϕ ( italic_c ) , italic_ϕ ( italic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) &gt; roman_max start_POSTSUBSCRIPT italic_c start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ italic_C start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT T ( italic_ϕ ( italic_c start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) , italic_ϕ ( italic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL 1 if italic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ italic_C start_POSTSUBSCRIPT italic_k italic_i end_POSTSUBSCRIPT ∧ italic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∉ italic_C start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k italic_i end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL 0 otherwise end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx3.SSx1.p5.9"><span class="ltx_text ltx_font_bold" id="Sx3.SSx1.p5.9.1">Win rate</span> calculates the percentage of cases where predictions <math alttext="C_{k}" class="ltx_Math" display="inline" id="Sx3.SSx1.p5.7.m1.1"><semantics id="Sx3.SSx1.p5.7.m1.1a"><msub id="Sx3.SSx1.p5.7.m1.1.1" xref="Sx3.SSx1.p5.7.m1.1.1.cmml"><mi id="Sx3.SSx1.p5.7.m1.1.1.2" xref="Sx3.SSx1.p5.7.m1.1.1.2.cmml">C</mi><mi id="Sx3.SSx1.p5.7.m1.1.1.3" xref="Sx3.SSx1.p5.7.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p5.7.m1.1b"><apply id="Sx3.SSx1.p5.7.m1.1.1.cmml" xref="Sx3.SSx1.p5.7.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p5.7.m1.1.1.1.cmml" xref="Sx3.SSx1.p5.7.m1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p5.7.m1.1.1.2.cmml" xref="Sx3.SSx1.p5.7.m1.1.1.2">𝐶</ci><ci id="Sx3.SSx1.p5.7.m1.1.1.3.cmml" xref="Sx3.SSx1.p5.7.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p5.7.m1.1c">C_{k}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p5.7.m1.1d">italic_C start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> are strictly better than predictions <math alttext="C^{\prime}_{k}" class="ltx_Math" display="inline" id="Sx3.SSx1.p5.8.m2.1"><semantics id="Sx3.SSx1.p5.8.m2.1a"><msubsup id="Sx3.SSx1.p5.8.m2.1.1" xref="Sx3.SSx1.p5.8.m2.1.1.cmml"><mi id="Sx3.SSx1.p5.8.m2.1.1.2.2" xref="Sx3.SSx1.p5.8.m2.1.1.2.2.cmml">C</mi><mi id="Sx3.SSx1.p5.8.m2.1.1.3" xref="Sx3.SSx1.p5.8.m2.1.1.3.cmml">k</mi><mo id="Sx3.SSx1.p5.8.m2.1.1.2.3" xref="Sx3.SSx1.p5.8.m2.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p5.8.m2.1b"><apply id="Sx3.SSx1.p5.8.m2.1.1.cmml" xref="Sx3.SSx1.p5.8.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p5.8.m2.1.1.1.cmml" xref="Sx3.SSx1.p5.8.m2.1.1">subscript</csymbol><apply id="Sx3.SSx1.p5.8.m2.1.1.2.cmml" xref="Sx3.SSx1.p5.8.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p5.8.m2.1.1.2.1.cmml" xref="Sx3.SSx1.p5.8.m2.1.1">superscript</csymbol><ci id="Sx3.SSx1.p5.8.m2.1.1.2.2.cmml" xref="Sx3.SSx1.p5.8.m2.1.1.2.2">𝐶</ci><ci id="Sx3.SSx1.p5.8.m2.1.1.2.3.cmml" xref="Sx3.SSx1.p5.8.m2.1.1.2.3">′</ci></apply><ci id="Sx3.SSx1.p5.8.m2.1.1.3.cmml" xref="Sx3.SSx1.p5.8.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p5.8.m2.1c">C^{\prime}_{k}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p5.8.m2.1d">italic_C start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> according to the ranking function <math alttext="R" class="ltx_Math" display="inline" id="Sx3.SSx1.p5.9.m3.1"><semantics id="Sx3.SSx1.p5.9.m3.1a"><mi id="Sx3.SSx1.p5.9.m3.1.1" xref="Sx3.SSx1.p5.9.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p5.9.m3.1b"><ci id="Sx3.SSx1.p5.9.m3.1.1.cmml" xref="Sx3.SSx1.p5.9.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p5.9.m3.1c">R</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p5.9.m3.1d">italic_R</annotation></semantics></math>. It is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx3.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\text{Win}(C_{k},C^{\prime}_{k},G):=\frac{100}{n}\sum_{i=1}^{n}R(C_{ki},C^{%
\prime}_{ki},G_{i})" class="ltx_Math" display="block" id="Sx3.Ex4.m1.6"><semantics id="Sx3.Ex4.m1.6a"><mrow id="Sx3.Ex4.m1.6.6" xref="Sx3.Ex4.m1.6.6.cmml"><mrow id="Sx3.Ex4.m1.3.3.2" xref="Sx3.Ex4.m1.3.3.2.cmml"><mtext id="Sx3.Ex4.m1.3.3.2.4" xref="Sx3.Ex4.m1.3.3.2.4a.cmml">Win</mtext><mo id="Sx3.Ex4.m1.3.3.2.3" xref="Sx3.Ex4.m1.3.3.2.3.cmml">⁢</mo><mrow id="Sx3.Ex4.m1.3.3.2.2.2" xref="Sx3.Ex4.m1.3.3.2.2.3.cmml"><mo id="Sx3.Ex4.m1.3.3.2.2.2.3" stretchy="false" xref="Sx3.Ex4.m1.3.3.2.2.3.cmml">(</mo><msub id="Sx3.Ex4.m1.2.2.1.1.1.1" xref="Sx3.Ex4.m1.2.2.1.1.1.1.cmml"><mi id="Sx3.Ex4.m1.2.2.1.1.1.1.2" xref="Sx3.Ex4.m1.2.2.1.1.1.1.2.cmml">C</mi><mi id="Sx3.Ex4.m1.2.2.1.1.1.1.3" xref="Sx3.Ex4.m1.2.2.1.1.1.1.3.cmml">k</mi></msub><mo id="Sx3.Ex4.m1.3.3.2.2.2.4" xref="Sx3.Ex4.m1.3.3.2.2.3.cmml">,</mo><msubsup id="Sx3.Ex4.m1.3.3.2.2.2.2" xref="Sx3.Ex4.m1.3.3.2.2.2.2.cmml"><mi id="Sx3.Ex4.m1.3.3.2.2.2.2.2.2" xref="Sx3.Ex4.m1.3.3.2.2.2.2.2.2.cmml">C</mi><mi id="Sx3.Ex4.m1.3.3.2.2.2.2.3" xref="Sx3.Ex4.m1.3.3.2.2.2.2.3.cmml">k</mi><mo id="Sx3.Ex4.m1.3.3.2.2.2.2.2.3" xref="Sx3.Ex4.m1.3.3.2.2.2.2.2.3.cmml">′</mo></msubsup><mo id="Sx3.Ex4.m1.3.3.2.2.2.5" xref="Sx3.Ex4.m1.3.3.2.2.3.cmml">,</mo><mi id="Sx3.Ex4.m1.1.1" xref="Sx3.Ex4.m1.1.1.cmml">G</mi><mo id="Sx3.Ex4.m1.3.3.2.2.2.6" rspace="0.278em" stretchy="false" xref="Sx3.Ex4.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow><mo id="Sx3.Ex4.m1.6.6.6" rspace="0.278em" xref="Sx3.Ex4.m1.6.6.6.cmml">:=</mo><mrow id="Sx3.Ex4.m1.6.6.5" xref="Sx3.Ex4.m1.6.6.5.cmml"><mfrac id="Sx3.Ex4.m1.6.6.5.5" xref="Sx3.Ex4.m1.6.6.5.5.cmml"><mn id="Sx3.Ex4.m1.6.6.5.5.2" xref="Sx3.Ex4.m1.6.6.5.5.2.cmml">100</mn><mi id="Sx3.Ex4.m1.6.6.5.5.3" xref="Sx3.Ex4.m1.6.6.5.5.3.cmml">n</mi></mfrac><mo id="Sx3.Ex4.m1.6.6.5.4" xref="Sx3.Ex4.m1.6.6.5.4.cmml">⁢</mo><mrow id="Sx3.Ex4.m1.6.6.5.3" xref="Sx3.Ex4.m1.6.6.5.3.cmml"><munderover id="Sx3.Ex4.m1.6.6.5.3.4" xref="Sx3.Ex4.m1.6.6.5.3.4.cmml"><mo id="Sx3.Ex4.m1.6.6.5.3.4.2.2" movablelimits="false" xref="Sx3.Ex4.m1.6.6.5.3.4.2.2.cmml">∑</mo><mrow id="Sx3.Ex4.m1.6.6.5.3.4.2.3" xref="Sx3.Ex4.m1.6.6.5.3.4.2.3.cmml"><mi id="Sx3.Ex4.m1.6.6.5.3.4.2.3.2" xref="Sx3.Ex4.m1.6.6.5.3.4.2.3.2.cmml">i</mi><mo id="Sx3.Ex4.m1.6.6.5.3.4.2.3.1" xref="Sx3.Ex4.m1.6.6.5.3.4.2.3.1.cmml">=</mo><mn id="Sx3.Ex4.m1.6.6.5.3.4.2.3.3" xref="Sx3.Ex4.m1.6.6.5.3.4.2.3.3.cmml">1</mn></mrow><mi id="Sx3.Ex4.m1.6.6.5.3.4.3" xref="Sx3.Ex4.m1.6.6.5.3.4.3.cmml">n</mi></munderover><mrow id="Sx3.Ex4.m1.6.6.5.3.3" xref="Sx3.Ex4.m1.6.6.5.3.3.cmml"><mi id="Sx3.Ex4.m1.6.6.5.3.3.5" xref="Sx3.Ex4.m1.6.6.5.3.3.5.cmml">R</mi><mo id="Sx3.Ex4.m1.6.6.5.3.3.4" xref="Sx3.Ex4.m1.6.6.5.3.3.4.cmml">⁢</mo><mrow id="Sx3.Ex4.m1.6.6.5.3.3.3.3" xref="Sx3.Ex4.m1.6.6.5.3.3.3.4.cmml"><mo id="Sx3.Ex4.m1.6.6.5.3.3.3.3.4" stretchy="false" xref="Sx3.Ex4.m1.6.6.5.3.3.3.4.cmml">(</mo><msub id="Sx3.Ex4.m1.4.4.3.1.1.1.1.1" xref="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.cmml"><mi id="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.2" xref="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.2.cmml">C</mi><mrow id="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.3" xref="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.3.cmml"><mi id="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.3.2" xref="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.3.2.cmml">k</mi><mo id="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.3.1" xref="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.3.3" xref="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="Sx3.Ex4.m1.6.6.5.3.3.3.3.5" xref="Sx3.Ex4.m1.6.6.5.3.3.3.4.cmml">,</mo><msubsup id="Sx3.Ex4.m1.5.5.4.2.2.2.2.2" xref="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.cmml"><mi id="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.2.2" xref="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.2.2.cmml">C</mi><mrow id="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.3" xref="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.3.cmml"><mi id="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.3.2" xref="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.3.2.cmml">k</mi><mo id="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.3.1" xref="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.3.3" xref="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.3.3.cmml">i</mi></mrow><mo id="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.2.3" xref="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.2.3.cmml">′</mo></msubsup><mo id="Sx3.Ex4.m1.6.6.5.3.3.3.3.6" xref="Sx3.Ex4.m1.6.6.5.3.3.3.4.cmml">,</mo><msub id="Sx3.Ex4.m1.6.6.5.3.3.3.3.3" xref="Sx3.Ex4.m1.6.6.5.3.3.3.3.3.cmml"><mi id="Sx3.Ex4.m1.6.6.5.3.3.3.3.3.2" xref="Sx3.Ex4.m1.6.6.5.3.3.3.3.3.2.cmml">G</mi><mi id="Sx3.Ex4.m1.6.6.5.3.3.3.3.3.3" xref="Sx3.Ex4.m1.6.6.5.3.3.3.3.3.3.cmml">i</mi></msub><mo id="Sx3.Ex4.m1.6.6.5.3.3.3.3.7" stretchy="false" xref="Sx3.Ex4.m1.6.6.5.3.3.3.4.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex4.m1.6b"><apply id="Sx3.Ex4.m1.6.6.cmml" xref="Sx3.Ex4.m1.6.6"><csymbol cd="latexml" id="Sx3.Ex4.m1.6.6.6.cmml" xref="Sx3.Ex4.m1.6.6.6">assign</csymbol><apply id="Sx3.Ex4.m1.3.3.2.cmml" xref="Sx3.Ex4.m1.3.3.2"><times id="Sx3.Ex4.m1.3.3.2.3.cmml" xref="Sx3.Ex4.m1.3.3.2.3"></times><ci id="Sx3.Ex4.m1.3.3.2.4a.cmml" xref="Sx3.Ex4.m1.3.3.2.4"><mtext id="Sx3.Ex4.m1.3.3.2.4.cmml" xref="Sx3.Ex4.m1.3.3.2.4">Win</mtext></ci><vector id="Sx3.Ex4.m1.3.3.2.2.3.cmml" xref="Sx3.Ex4.m1.3.3.2.2.2"><apply id="Sx3.Ex4.m1.2.2.1.1.1.1.cmml" xref="Sx3.Ex4.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex4.m1.2.2.1.1.1.1.1.cmml" xref="Sx3.Ex4.m1.2.2.1.1.1.1">subscript</csymbol><ci id="Sx3.Ex4.m1.2.2.1.1.1.1.2.cmml" xref="Sx3.Ex4.m1.2.2.1.1.1.1.2">𝐶</ci><ci id="Sx3.Ex4.m1.2.2.1.1.1.1.3.cmml" xref="Sx3.Ex4.m1.2.2.1.1.1.1.3">𝑘</ci></apply><apply id="Sx3.Ex4.m1.3.3.2.2.2.2.cmml" xref="Sx3.Ex4.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.Ex4.m1.3.3.2.2.2.2.1.cmml" xref="Sx3.Ex4.m1.3.3.2.2.2.2">subscript</csymbol><apply id="Sx3.Ex4.m1.3.3.2.2.2.2.2.cmml" xref="Sx3.Ex4.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.Ex4.m1.3.3.2.2.2.2.2.1.cmml" xref="Sx3.Ex4.m1.3.3.2.2.2.2">superscript</csymbol><ci id="Sx3.Ex4.m1.3.3.2.2.2.2.2.2.cmml" xref="Sx3.Ex4.m1.3.3.2.2.2.2.2.2">𝐶</ci><ci id="Sx3.Ex4.m1.3.3.2.2.2.2.2.3.cmml" xref="Sx3.Ex4.m1.3.3.2.2.2.2.2.3">′</ci></apply><ci id="Sx3.Ex4.m1.3.3.2.2.2.2.3.cmml" xref="Sx3.Ex4.m1.3.3.2.2.2.2.3">𝑘</ci></apply><ci id="Sx3.Ex4.m1.1.1.cmml" xref="Sx3.Ex4.m1.1.1">𝐺</ci></vector></apply><apply id="Sx3.Ex4.m1.6.6.5.cmml" xref="Sx3.Ex4.m1.6.6.5"><times id="Sx3.Ex4.m1.6.6.5.4.cmml" xref="Sx3.Ex4.m1.6.6.5.4"></times><apply id="Sx3.Ex4.m1.6.6.5.5.cmml" xref="Sx3.Ex4.m1.6.6.5.5"><divide id="Sx3.Ex4.m1.6.6.5.5.1.cmml" xref="Sx3.Ex4.m1.6.6.5.5"></divide><cn id="Sx3.Ex4.m1.6.6.5.5.2.cmml" type="integer" xref="Sx3.Ex4.m1.6.6.5.5.2">100</cn><ci id="Sx3.Ex4.m1.6.6.5.5.3.cmml" xref="Sx3.Ex4.m1.6.6.5.5.3">𝑛</ci></apply><apply id="Sx3.Ex4.m1.6.6.5.3.cmml" xref="Sx3.Ex4.m1.6.6.5.3"><apply id="Sx3.Ex4.m1.6.6.5.3.4.cmml" xref="Sx3.Ex4.m1.6.6.5.3.4"><csymbol cd="ambiguous" id="Sx3.Ex4.m1.6.6.5.3.4.1.cmml" xref="Sx3.Ex4.m1.6.6.5.3.4">superscript</csymbol><apply id="Sx3.Ex4.m1.6.6.5.3.4.2.cmml" xref="Sx3.Ex4.m1.6.6.5.3.4"><csymbol cd="ambiguous" id="Sx3.Ex4.m1.6.6.5.3.4.2.1.cmml" xref="Sx3.Ex4.m1.6.6.5.3.4">subscript</csymbol><sum id="Sx3.Ex4.m1.6.6.5.3.4.2.2.cmml" xref="Sx3.Ex4.m1.6.6.5.3.4.2.2"></sum><apply id="Sx3.Ex4.m1.6.6.5.3.4.2.3.cmml" xref="Sx3.Ex4.m1.6.6.5.3.4.2.3"><eq id="Sx3.Ex4.m1.6.6.5.3.4.2.3.1.cmml" xref="Sx3.Ex4.m1.6.6.5.3.4.2.3.1"></eq><ci id="Sx3.Ex4.m1.6.6.5.3.4.2.3.2.cmml" xref="Sx3.Ex4.m1.6.6.5.3.4.2.3.2">𝑖</ci><cn id="Sx3.Ex4.m1.6.6.5.3.4.2.3.3.cmml" type="integer" xref="Sx3.Ex4.m1.6.6.5.3.4.2.3.3">1</cn></apply></apply><ci id="Sx3.Ex4.m1.6.6.5.3.4.3.cmml" xref="Sx3.Ex4.m1.6.6.5.3.4.3">𝑛</ci></apply><apply id="Sx3.Ex4.m1.6.6.5.3.3.cmml" xref="Sx3.Ex4.m1.6.6.5.3.3"><times id="Sx3.Ex4.m1.6.6.5.3.3.4.cmml" xref="Sx3.Ex4.m1.6.6.5.3.3.4"></times><ci id="Sx3.Ex4.m1.6.6.5.3.3.5.cmml" xref="Sx3.Ex4.m1.6.6.5.3.3.5">𝑅</ci><vector id="Sx3.Ex4.m1.6.6.5.3.3.3.4.cmml" xref="Sx3.Ex4.m1.6.6.5.3.3.3.3"><apply id="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.cmml" xref="Sx3.Ex4.m1.4.4.3.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.1.cmml" xref="Sx3.Ex4.m1.4.4.3.1.1.1.1.1">subscript</csymbol><ci id="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.2.cmml" xref="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.2">𝐶</ci><apply id="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.3.cmml" xref="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.3"><times id="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.3.1.cmml" xref="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.3.1"></times><ci id="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.3.2.cmml" xref="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.3.2">𝑘</ci><ci id="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.3.3.cmml" xref="Sx3.Ex4.m1.4.4.3.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.cmml" xref="Sx3.Ex4.m1.5.5.4.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.1.cmml" xref="Sx3.Ex4.m1.5.5.4.2.2.2.2.2">subscript</csymbol><apply id="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.2.cmml" xref="Sx3.Ex4.m1.5.5.4.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.2.1.cmml" xref="Sx3.Ex4.m1.5.5.4.2.2.2.2.2">superscript</csymbol><ci id="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.2.2.cmml" xref="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.2.2">𝐶</ci><ci id="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.2.3.cmml" xref="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.2.3">′</ci></apply><apply id="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.3.cmml" xref="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.3"><times id="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.3.1.cmml" xref="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.3.1"></times><ci id="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.3.2.cmml" xref="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.3.2">𝑘</ci><ci id="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.3.3.cmml" xref="Sx3.Ex4.m1.5.5.4.2.2.2.2.2.3.3">𝑖</ci></apply></apply><apply id="Sx3.Ex4.m1.6.6.5.3.3.3.3.3.cmml" xref="Sx3.Ex4.m1.6.6.5.3.3.3.3.3"><csymbol cd="ambiguous" id="Sx3.Ex4.m1.6.6.5.3.3.3.3.3.1.cmml" xref="Sx3.Ex4.m1.6.6.5.3.3.3.3.3">subscript</csymbol><ci id="Sx3.Ex4.m1.6.6.5.3.3.3.3.3.2.cmml" xref="Sx3.Ex4.m1.6.6.5.3.3.3.3.3.2">𝐺</ci><ci id="Sx3.Ex4.m1.6.6.5.3.3.3.3.3.3.cmml" xref="Sx3.Ex4.m1.6.6.5.3.3.3.3.3.3">𝑖</ci></apply></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex4.m1.6c">\text{Win}(C_{k},C^{\prime}_{k},G):=\frac{100}{n}\sum_{i=1}^{n}R(C_{ki},C^{%
\prime}_{ki},G_{i})</annotation><annotation encoding="application/x-llamapun" id="Sx3.Ex4.m1.6d">Win ( italic_C start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_C start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_G ) := divide start_ARG 100 end_ARG start_ARG italic_n end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_R ( italic_C start_POSTSUBSCRIPT italic_k italic_i end_POSTSUBSCRIPT , italic_C start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k italic_i end_POSTSUBSCRIPT , italic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx3.SSx1.p5.12"><span class="ltx_text ltx_font_bold" id="Sx3.SSx1.p5.12.1">At-least-as-good rate</span> extends the win rate by including cases where the two sets achieve equal top-<math alttext="k" class="ltx_Math" display="inline" id="Sx3.SSx1.p5.10.m1.1"><semantics id="Sx3.SSx1.p5.10.m1.1a"><mi id="Sx3.SSx1.p5.10.m1.1.1" xref="Sx3.SSx1.p5.10.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p5.10.m1.1b"><ci id="Sx3.SSx1.p5.10.m1.1.1.cmml" xref="Sx3.SSx1.p5.10.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p5.10.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p5.10.m1.1d">italic_k</annotation></semantics></math> similarity (draws). This metric completes the information about direct models’ performance comparison by reflecting instances where predictions <math alttext="C_{k}" class="ltx_Math" display="inline" id="Sx3.SSx1.p5.11.m2.1"><semantics id="Sx3.SSx1.p5.11.m2.1a"><msub id="Sx3.SSx1.p5.11.m2.1.1" xref="Sx3.SSx1.p5.11.m2.1.1.cmml"><mi id="Sx3.SSx1.p5.11.m2.1.1.2" xref="Sx3.SSx1.p5.11.m2.1.1.2.cmml">C</mi><mi id="Sx3.SSx1.p5.11.m2.1.1.3" xref="Sx3.SSx1.p5.11.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p5.11.m2.1b"><apply id="Sx3.SSx1.p5.11.m2.1.1.cmml" xref="Sx3.SSx1.p5.11.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p5.11.m2.1.1.1.cmml" xref="Sx3.SSx1.p5.11.m2.1.1">subscript</csymbol><ci id="Sx3.SSx1.p5.11.m2.1.1.2.cmml" xref="Sx3.SSx1.p5.11.m2.1.1.2">𝐶</ci><ci id="Sx3.SSx1.p5.11.m2.1.1.3.cmml" xref="Sx3.SSx1.p5.11.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p5.11.m2.1c">C_{k}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p5.11.m2.1d">italic_C start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> are either better than or equivalent to predictions <math alttext="C^{\prime}_{k}" class="ltx_Math" display="inline" id="Sx3.SSx1.p5.12.m3.1"><semantics id="Sx3.SSx1.p5.12.m3.1a"><msubsup id="Sx3.SSx1.p5.12.m3.1.1" xref="Sx3.SSx1.p5.12.m3.1.1.cmml"><mi id="Sx3.SSx1.p5.12.m3.1.1.2.2" xref="Sx3.SSx1.p5.12.m3.1.1.2.2.cmml">C</mi><mi id="Sx3.SSx1.p5.12.m3.1.1.3" xref="Sx3.SSx1.p5.12.m3.1.1.3.cmml">k</mi><mo id="Sx3.SSx1.p5.12.m3.1.1.2.3" xref="Sx3.SSx1.p5.12.m3.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p5.12.m3.1b"><apply id="Sx3.SSx1.p5.12.m3.1.1.cmml" xref="Sx3.SSx1.p5.12.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p5.12.m3.1.1.1.cmml" xref="Sx3.SSx1.p5.12.m3.1.1">subscript</csymbol><apply id="Sx3.SSx1.p5.12.m3.1.1.2.cmml" xref="Sx3.SSx1.p5.12.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p5.12.m3.1.1.2.1.cmml" xref="Sx3.SSx1.p5.12.m3.1.1">superscript</csymbol><ci id="Sx3.SSx1.p5.12.m3.1.1.2.2.cmml" xref="Sx3.SSx1.p5.12.m3.1.1.2.2">𝐶</ci><ci id="Sx3.SSx1.p5.12.m3.1.1.2.3.cmml" xref="Sx3.SSx1.p5.12.m3.1.1.2.3">′</ci></apply><ci id="Sx3.SSx1.p5.12.m3.1.1.3.cmml" xref="Sx3.SSx1.p5.12.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p5.12.m3.1c">C^{\prime}_{k}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p5.12.m3.1d">italic_C start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx3.Ex5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\text{ALAG}(C_{k},C^{\prime}_{k},G):=100-\text{Win}(C^{\prime}_{k},C_{k},G)" class="ltx_Math" display="block" id="Sx3.Ex5.m1.6"><semantics id="Sx3.Ex5.m1.6a"><mrow id="Sx3.Ex5.m1.6.6" xref="Sx3.Ex5.m1.6.6.cmml"><mrow id="Sx3.Ex5.m1.4.4.2" xref="Sx3.Ex5.m1.4.4.2.cmml"><mtext id="Sx3.Ex5.m1.4.4.2.4" xref="Sx3.Ex5.m1.4.4.2.4a.cmml">ALAG</mtext><mo id="Sx3.Ex5.m1.4.4.2.3" xref="Sx3.Ex5.m1.4.4.2.3.cmml">⁢</mo><mrow id="Sx3.Ex5.m1.4.4.2.2.2" xref="Sx3.Ex5.m1.4.4.2.2.3.cmml"><mo id="Sx3.Ex5.m1.4.4.2.2.2.3" stretchy="false" xref="Sx3.Ex5.m1.4.4.2.2.3.cmml">(</mo><msub id="Sx3.Ex5.m1.3.3.1.1.1.1" xref="Sx3.Ex5.m1.3.3.1.1.1.1.cmml"><mi id="Sx3.Ex5.m1.3.3.1.1.1.1.2" xref="Sx3.Ex5.m1.3.3.1.1.1.1.2.cmml">C</mi><mi id="Sx3.Ex5.m1.3.3.1.1.1.1.3" xref="Sx3.Ex5.m1.3.3.1.1.1.1.3.cmml">k</mi></msub><mo id="Sx3.Ex5.m1.4.4.2.2.2.4" xref="Sx3.Ex5.m1.4.4.2.2.3.cmml">,</mo><msubsup id="Sx3.Ex5.m1.4.4.2.2.2.2" xref="Sx3.Ex5.m1.4.4.2.2.2.2.cmml"><mi id="Sx3.Ex5.m1.4.4.2.2.2.2.2.2" xref="Sx3.Ex5.m1.4.4.2.2.2.2.2.2.cmml">C</mi><mi id="Sx3.Ex5.m1.4.4.2.2.2.2.3" xref="Sx3.Ex5.m1.4.4.2.2.2.2.3.cmml">k</mi><mo id="Sx3.Ex5.m1.4.4.2.2.2.2.2.3" xref="Sx3.Ex5.m1.4.4.2.2.2.2.2.3.cmml">′</mo></msubsup><mo id="Sx3.Ex5.m1.4.4.2.2.2.5" xref="Sx3.Ex5.m1.4.4.2.2.3.cmml">,</mo><mi id="Sx3.Ex5.m1.1.1" xref="Sx3.Ex5.m1.1.1.cmml">G</mi><mo id="Sx3.Ex5.m1.4.4.2.2.2.6" rspace="0.278em" stretchy="false" xref="Sx3.Ex5.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow><mo id="Sx3.Ex5.m1.6.6.5" rspace="0.278em" xref="Sx3.Ex5.m1.6.6.5.cmml">:=</mo><mrow id="Sx3.Ex5.m1.6.6.4" xref="Sx3.Ex5.m1.6.6.4.cmml"><mn id="Sx3.Ex5.m1.6.6.4.4" xref="Sx3.Ex5.m1.6.6.4.4.cmml">100</mn><mo id="Sx3.Ex5.m1.6.6.4.3" xref="Sx3.Ex5.m1.6.6.4.3.cmml">−</mo><mrow id="Sx3.Ex5.m1.6.6.4.2" xref="Sx3.Ex5.m1.6.6.4.2.cmml"><mtext id="Sx3.Ex5.m1.6.6.4.2.4" xref="Sx3.Ex5.m1.6.6.4.2.4a.cmml">Win</mtext><mo id="Sx3.Ex5.m1.6.6.4.2.3" xref="Sx3.Ex5.m1.6.6.4.2.3.cmml">⁢</mo><mrow id="Sx3.Ex5.m1.6.6.4.2.2.2" xref="Sx3.Ex5.m1.6.6.4.2.2.3.cmml"><mo id="Sx3.Ex5.m1.6.6.4.2.2.2.3" stretchy="false" xref="Sx3.Ex5.m1.6.6.4.2.2.3.cmml">(</mo><msubsup id="Sx3.Ex5.m1.5.5.3.1.1.1.1" xref="Sx3.Ex5.m1.5.5.3.1.1.1.1.cmml"><mi id="Sx3.Ex5.m1.5.5.3.1.1.1.1.2.2" xref="Sx3.Ex5.m1.5.5.3.1.1.1.1.2.2.cmml">C</mi><mi id="Sx3.Ex5.m1.5.5.3.1.1.1.1.3" xref="Sx3.Ex5.m1.5.5.3.1.1.1.1.3.cmml">k</mi><mo id="Sx3.Ex5.m1.5.5.3.1.1.1.1.2.3" xref="Sx3.Ex5.m1.5.5.3.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="Sx3.Ex5.m1.6.6.4.2.2.2.4" xref="Sx3.Ex5.m1.6.6.4.2.2.3.cmml">,</mo><msub id="Sx3.Ex5.m1.6.6.4.2.2.2.2" xref="Sx3.Ex5.m1.6.6.4.2.2.2.2.cmml"><mi id="Sx3.Ex5.m1.6.6.4.2.2.2.2.2" xref="Sx3.Ex5.m1.6.6.4.2.2.2.2.2.cmml">C</mi><mi id="Sx3.Ex5.m1.6.6.4.2.2.2.2.3" xref="Sx3.Ex5.m1.6.6.4.2.2.2.2.3.cmml">k</mi></msub><mo id="Sx3.Ex5.m1.6.6.4.2.2.2.5" xref="Sx3.Ex5.m1.6.6.4.2.2.3.cmml">,</mo><mi id="Sx3.Ex5.m1.2.2" xref="Sx3.Ex5.m1.2.2.cmml">G</mi><mo id="Sx3.Ex5.m1.6.6.4.2.2.2.6" stretchy="false" xref="Sx3.Ex5.m1.6.6.4.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex5.m1.6b"><apply id="Sx3.Ex5.m1.6.6.cmml" xref="Sx3.Ex5.m1.6.6"><csymbol cd="latexml" id="Sx3.Ex5.m1.6.6.5.cmml" xref="Sx3.Ex5.m1.6.6.5">assign</csymbol><apply id="Sx3.Ex5.m1.4.4.2.cmml" xref="Sx3.Ex5.m1.4.4.2"><times id="Sx3.Ex5.m1.4.4.2.3.cmml" xref="Sx3.Ex5.m1.4.4.2.3"></times><ci id="Sx3.Ex5.m1.4.4.2.4a.cmml" xref="Sx3.Ex5.m1.4.4.2.4"><mtext id="Sx3.Ex5.m1.4.4.2.4.cmml" xref="Sx3.Ex5.m1.4.4.2.4">ALAG</mtext></ci><vector id="Sx3.Ex5.m1.4.4.2.2.3.cmml" xref="Sx3.Ex5.m1.4.4.2.2.2"><apply id="Sx3.Ex5.m1.3.3.1.1.1.1.cmml" xref="Sx3.Ex5.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex5.m1.3.3.1.1.1.1.1.cmml" xref="Sx3.Ex5.m1.3.3.1.1.1.1">subscript</csymbol><ci id="Sx3.Ex5.m1.3.3.1.1.1.1.2.cmml" xref="Sx3.Ex5.m1.3.3.1.1.1.1.2">𝐶</ci><ci id="Sx3.Ex5.m1.3.3.1.1.1.1.3.cmml" xref="Sx3.Ex5.m1.3.3.1.1.1.1.3">𝑘</ci></apply><apply id="Sx3.Ex5.m1.4.4.2.2.2.2.cmml" xref="Sx3.Ex5.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.Ex5.m1.4.4.2.2.2.2.1.cmml" xref="Sx3.Ex5.m1.4.4.2.2.2.2">subscript</csymbol><apply id="Sx3.Ex5.m1.4.4.2.2.2.2.2.cmml" xref="Sx3.Ex5.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.Ex5.m1.4.4.2.2.2.2.2.1.cmml" xref="Sx3.Ex5.m1.4.4.2.2.2.2">superscript</csymbol><ci id="Sx3.Ex5.m1.4.4.2.2.2.2.2.2.cmml" xref="Sx3.Ex5.m1.4.4.2.2.2.2.2.2">𝐶</ci><ci id="Sx3.Ex5.m1.4.4.2.2.2.2.2.3.cmml" xref="Sx3.Ex5.m1.4.4.2.2.2.2.2.3">′</ci></apply><ci id="Sx3.Ex5.m1.4.4.2.2.2.2.3.cmml" xref="Sx3.Ex5.m1.4.4.2.2.2.2.3">𝑘</ci></apply><ci id="Sx3.Ex5.m1.1.1.cmml" xref="Sx3.Ex5.m1.1.1">𝐺</ci></vector></apply><apply id="Sx3.Ex5.m1.6.6.4.cmml" xref="Sx3.Ex5.m1.6.6.4"><minus id="Sx3.Ex5.m1.6.6.4.3.cmml" xref="Sx3.Ex5.m1.6.6.4.3"></minus><cn id="Sx3.Ex5.m1.6.6.4.4.cmml" type="integer" xref="Sx3.Ex5.m1.6.6.4.4">100</cn><apply id="Sx3.Ex5.m1.6.6.4.2.cmml" xref="Sx3.Ex5.m1.6.6.4.2"><times id="Sx3.Ex5.m1.6.6.4.2.3.cmml" xref="Sx3.Ex5.m1.6.6.4.2.3"></times><ci id="Sx3.Ex5.m1.6.6.4.2.4a.cmml" xref="Sx3.Ex5.m1.6.6.4.2.4"><mtext id="Sx3.Ex5.m1.6.6.4.2.4.cmml" xref="Sx3.Ex5.m1.6.6.4.2.4">Win</mtext></ci><vector id="Sx3.Ex5.m1.6.6.4.2.2.3.cmml" xref="Sx3.Ex5.m1.6.6.4.2.2.2"><apply id="Sx3.Ex5.m1.5.5.3.1.1.1.1.cmml" xref="Sx3.Ex5.m1.5.5.3.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex5.m1.5.5.3.1.1.1.1.1.cmml" xref="Sx3.Ex5.m1.5.5.3.1.1.1.1">subscript</csymbol><apply id="Sx3.Ex5.m1.5.5.3.1.1.1.1.2.cmml" xref="Sx3.Ex5.m1.5.5.3.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex5.m1.5.5.3.1.1.1.1.2.1.cmml" xref="Sx3.Ex5.m1.5.5.3.1.1.1.1">superscript</csymbol><ci id="Sx3.Ex5.m1.5.5.3.1.1.1.1.2.2.cmml" xref="Sx3.Ex5.m1.5.5.3.1.1.1.1.2.2">𝐶</ci><ci id="Sx3.Ex5.m1.5.5.3.1.1.1.1.2.3.cmml" xref="Sx3.Ex5.m1.5.5.3.1.1.1.1.2.3">′</ci></apply><ci id="Sx3.Ex5.m1.5.5.3.1.1.1.1.3.cmml" xref="Sx3.Ex5.m1.5.5.3.1.1.1.1.3">𝑘</ci></apply><apply id="Sx3.Ex5.m1.6.6.4.2.2.2.2.cmml" xref="Sx3.Ex5.m1.6.6.4.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.Ex5.m1.6.6.4.2.2.2.2.1.cmml" xref="Sx3.Ex5.m1.6.6.4.2.2.2.2">subscript</csymbol><ci id="Sx3.Ex5.m1.6.6.4.2.2.2.2.2.cmml" xref="Sx3.Ex5.m1.6.6.4.2.2.2.2.2">𝐶</ci><ci id="Sx3.Ex5.m1.6.6.4.2.2.2.2.3.cmml" xref="Sx3.Ex5.m1.6.6.4.2.2.2.2.3">𝑘</ci></apply><ci id="Sx3.Ex5.m1.2.2.cmml" xref="Sx3.Ex5.m1.2.2">𝐺</ci></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex5.m1.6c">\text{ALAG}(C_{k},C^{\prime}_{k},G):=100-\text{Win}(C^{\prime}_{k},C_{k},G)</annotation><annotation encoding="application/x-llamapun" id="Sx3.Ex5.m1.6d">ALAG ( italic_C start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_C start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_G ) := 100 - Win ( italic_C start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_C start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_G )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="Sx3.SSx2">
<h3 class="ltx_title ltx_title_subsection">Model</h3>
<div class="ltx_para" id="Sx3.SSx2.p1">
<p class="ltx_p" id="Sx3.SSx2.p1.1">SpecTUS utilizes an encoder-decoder architecture with 12 encoder blocks and 12 decoder blocks, 16 attention heads, an embedding size of 1024, and hidden layers of feed-forward blocks of size 4096.</p>
</div>
<div class="ltx_para" id="Sx3.SSx2.p2">
<p class="ltx_p" id="Sx3.SSx2.p2.1">The model’s input is a set of peaks represented by m/z and intensity values. The output is an autoregressively generated molecular structure representation encoded as a SMILES string. SpecTUS was trained on low-resolution GC-EI-MS spectra, and since integer m/z values already encode the relative position of peaks (unlike words/tokens in language models), we use the original positional encoding channel to encode intensity information. Thus, the model has three trainable sets of embeddings – m/z values, binned intensities, and SMILES characters. The encoder receives a sum of embeddings representing m/z values and intensities – one aggregated embedding for each peak in the spectrum; the decoder generation is based on a sequence of embeddings, each representing one SMILES character.</p>
</div>
<div class="ltx_para" id="Sx3.SSx2.p3">
<p class="ltx_p" id="Sx3.SSx2.p3.1">Following the standard bounds for small molecules and NIST 20 library statistics, the model-specific thresholds for training and input data were set to a maximum of 300 peaks, an m/z limit of 500, and a maximum SMILES length of 100. Applying these thresholds resulted in excluding approximately 3% of the NIST dataset. A detailed analysis of the impact of these filters is presented in Figure <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A2.F6" title="Figure 6 ‣ Appendix B Methods ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
<div class="ltx_para" id="Sx3.SSx2.p4">
<p class="ltx_p" id="Sx3.SSx2.p4.1">In total, our model consists of 354 million trainable parameters.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx3.SSx3">
<h3 class="ltx_title ltx_title_subsection">Pretraining datasets</h3>
<div class="ltx_para" id="Sx3.SSx3.p1">
<p class="ltx_p" id="Sx3.SSx3.p1.1">Pretraining on synthetic spectra is a core component of the SpecTUS model. For the early experiments, we collected 4.7 million compounds (<span class="ltx_text ltx_font_italic" id="Sx3.SSx3.p1.1.1">synth1</span>) from the ZINC library and proved that pretraining greatly boosts the models’ performance. For the last stage of SpecTUS development, we decided to step up the pretraining stage and double the size of the pretraining dataset by repeating the collection process once again. This time we gathered another 4.8 million compounds (<span class="ltx_text ltx_font_italic" id="Sx3.SSx3.p1.1.2">synth2</span>).</p>
</div>
<div class="ltx_para" id="Sx3.SSx3.p2">
<p class="ltx_p" id="Sx3.SSx3.p2.1">To uniformly cover the chemical space, we first scraped 1.8 billion SMILES strings from the ZINC20 library using the 2D-standard-annotated-druglike query. From this dataset, we extracted a random sample of 30 million noncorrupted SMILES strings shorter than 100 characters in each round. Further, we canonicalized, deduplicated, and stripped the SMILES of stereochemical information.
Importantly, we removed all NIST20 compounds to prevent data leakage.
Filtering the 30-million sets to compounds RASSP can process (8 most common elements, number of possible subformulae)
reduces the dataset down to approx. 4.7 (<em class="ltx_emph ltx_font_italic" id="Sx3.SSx3.p2.1.1">synth1</em>) and 4.8 (<em class="ltx_emph ltx_font_italic" id="Sx3.SSx3.p2.1.2">synth2</em>) millions.
To evaluate the impact of RASSP and NEIMS respective spectrum prediction capabilities on SpecTUS performance,
we generated spectra for the same set of compounds by both models.
In total, the pretraining datasets comprises <math alttext="9.4+9.6" class="ltx_Math" display="inline" id="Sx3.SSx3.p2.1.m1.1"><semantics id="Sx3.SSx3.p2.1.m1.1a"><mrow id="Sx3.SSx3.p2.1.m1.1.1" xref="Sx3.SSx3.p2.1.m1.1.1.cmml"><mn id="Sx3.SSx3.p2.1.m1.1.1.2" xref="Sx3.SSx3.p2.1.m1.1.1.2.cmml">9.4</mn><mo id="Sx3.SSx3.p2.1.m1.1.1.1" xref="Sx3.SSx3.p2.1.m1.1.1.1.cmml">+</mo><mn id="Sx3.SSx3.p2.1.m1.1.1.3" xref="Sx3.SSx3.p2.1.m1.1.1.3.cmml">9.6</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.1.m1.1b"><apply id="Sx3.SSx3.p2.1.m1.1.1.cmml" xref="Sx3.SSx3.p2.1.m1.1.1"><plus id="Sx3.SSx3.p2.1.m1.1.1.1.cmml" xref="Sx3.SSx3.p2.1.m1.1.1.1"></plus><cn id="Sx3.SSx3.p2.1.m1.1.1.2.cmml" type="float" xref="Sx3.SSx3.p2.1.m1.1.1.2">9.4</cn><cn id="Sx3.SSx3.p2.1.m1.1.1.3.cmml" type="float" xref="Sx3.SSx3.p2.1.m1.1.1.3">9.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.1.m1.1c">9.4+9.6</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx3.p2.1.m1.1d">9.4 + 9.6</annotation></semantics></math> million spectra.</p>
</div>
<div class="ltx_para" id="Sx3.SSx3.p3">
<p class="ltx_p" id="Sx3.SSx3.p3.1">Lastly, we split each synthetic dataset into training, validation, and test sets using a <math alttext="0.9:0.05:0.05" class="ltx_Math" display="inline" id="Sx3.SSx3.p3.1.m1.1"><semantics id="Sx3.SSx3.p3.1.m1.1a"><mrow id="Sx3.SSx3.p3.1.m1.1.1" xref="Sx3.SSx3.p3.1.m1.1.1.cmml"><mn id="Sx3.SSx3.p3.1.m1.1.1.2" xref="Sx3.SSx3.p3.1.m1.1.1.2.cmml">0.9</mn><mo id="Sx3.SSx3.p3.1.m1.1.1.3" lspace="0.278em" rspace="0.278em" xref="Sx3.SSx3.p3.1.m1.1.1.3.cmml">:</mo><mn id="Sx3.SSx3.p3.1.m1.1.1.4" xref="Sx3.SSx3.p3.1.m1.1.1.4.cmml">0.05</mn><mo id="Sx3.SSx3.p3.1.m1.1.1.5" lspace="0.278em" rspace="0.278em" xref="Sx3.SSx3.p3.1.m1.1.1.5.cmml">:</mo><mn id="Sx3.SSx3.p3.1.m1.1.1.6" xref="Sx3.SSx3.p3.1.m1.1.1.6.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p3.1.m1.1b"><apply id="Sx3.SSx3.p3.1.m1.1.1.cmml" xref="Sx3.SSx3.p3.1.m1.1.1"><and id="Sx3.SSx3.p3.1.m1.1.1a.cmml" xref="Sx3.SSx3.p3.1.m1.1.1"></and><apply id="Sx3.SSx3.p3.1.m1.1.1b.cmml" xref="Sx3.SSx3.p3.1.m1.1.1"><ci id="Sx3.SSx3.p3.1.m1.1.1.3.cmml" xref="Sx3.SSx3.p3.1.m1.1.1.3">:</ci><cn id="Sx3.SSx3.p3.1.m1.1.1.2.cmml" type="float" xref="Sx3.SSx3.p3.1.m1.1.1.2">0.9</cn><cn id="Sx3.SSx3.p3.1.m1.1.1.4.cmml" type="float" xref="Sx3.SSx3.p3.1.m1.1.1.4">0.05</cn></apply><apply id="Sx3.SSx3.p3.1.m1.1.1c.cmml" xref="Sx3.SSx3.p3.1.m1.1.1"><ci id="Sx3.SSx3.p3.1.m1.1.1.5.cmml" xref="Sx3.SSx3.p3.1.m1.1.1.5">:</ci><share href="https://arxiv.org/html/2502.05114v1#Sx3.SSx3.p3.1.m1.1.1.4.cmml" id="Sx3.SSx3.p3.1.m1.1.1d.cmml" xref="Sx3.SSx3.p3.1.m1.1.1"></share><cn id="Sx3.SSx3.p3.1.m1.1.1.6.cmml" type="float" xref="Sx3.SSx3.p3.1.m1.1.1.6">0.05</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p3.1.m1.1c">0.9:0.05:0.05</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx3.p3.1.m1.1d">0.9 : 0.05 : 0.05</annotation></semantics></math> ratio. The splitting process was random, but corresponding splits (training, validation, and test sets) for the NEIMS and RASSP-generated spectra contained the same compounds to avoid cross-leak.
Both NEIMS- and RASSP-generated halves of both synthetic datasets (<span class="ltx_text ltx_font_italic" id="Sx3.SSx3.p3.1.1">synth1</span> and <span class="ltx_text ltx_font_italic" id="Sx3.SSx3.p3.1.2">synth2</span>) are available on the Hugging Face Hub for further research and replication.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx3.SSx4">
<h3 class="ltx_title ltx_title_subsection">Finetuning dataset</h3>
<div class="ltx_para" id="Sx3.SSx4.p1">
<p class="ltx_p" id="Sx3.SSx4.p1.1">For the finetuning stage, we filtered all corrupted or nonannotated spectra from the low-resolution NIST 20 GC-EI-MS library, removed stereochemistry information, and canonicalized the SMILES strings. The dataset was split into training, validation, and test sets with an <math alttext="0.8:0.1:0.1" class="ltx_Math" display="inline" id="Sx3.SSx4.p1.1.m1.1"><semantics id="Sx3.SSx4.p1.1.m1.1a"><mrow id="Sx3.SSx4.p1.1.m1.1.1" xref="Sx3.SSx4.p1.1.m1.1.1.cmml"><mn id="Sx3.SSx4.p1.1.m1.1.1.2" xref="Sx3.SSx4.p1.1.m1.1.1.2.cmml">0.8</mn><mo id="Sx3.SSx4.p1.1.m1.1.1.3" lspace="0.278em" rspace="0.278em" xref="Sx3.SSx4.p1.1.m1.1.1.3.cmml">:</mo><mn id="Sx3.SSx4.p1.1.m1.1.1.4" xref="Sx3.SSx4.p1.1.m1.1.1.4.cmml">0.1</mn><mo id="Sx3.SSx4.p1.1.m1.1.1.5" lspace="0.278em" rspace="0.278em" xref="Sx3.SSx4.p1.1.m1.1.1.5.cmml">:</mo><mn id="Sx3.SSx4.p1.1.m1.1.1.6" xref="Sx3.SSx4.p1.1.m1.1.1.6.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.p1.1.m1.1b"><apply id="Sx3.SSx4.p1.1.m1.1.1.cmml" xref="Sx3.SSx4.p1.1.m1.1.1"><and id="Sx3.SSx4.p1.1.m1.1.1a.cmml" xref="Sx3.SSx4.p1.1.m1.1.1"></and><apply id="Sx3.SSx4.p1.1.m1.1.1b.cmml" xref="Sx3.SSx4.p1.1.m1.1.1"><ci id="Sx3.SSx4.p1.1.m1.1.1.3.cmml" xref="Sx3.SSx4.p1.1.m1.1.1.3">:</ci><cn id="Sx3.SSx4.p1.1.m1.1.1.2.cmml" type="float" xref="Sx3.SSx4.p1.1.m1.1.1.2">0.8</cn><cn id="Sx3.SSx4.p1.1.m1.1.1.4.cmml" type="float" xref="Sx3.SSx4.p1.1.m1.1.1.4">0.1</cn></apply><apply id="Sx3.SSx4.p1.1.m1.1.1c.cmml" xref="Sx3.SSx4.p1.1.m1.1.1"><ci id="Sx3.SSx4.p1.1.m1.1.1.5.cmml" xref="Sx3.SSx4.p1.1.m1.1.1.5">:</ci><share href="https://arxiv.org/html/2502.05114v1#Sx3.SSx4.p1.1.m1.1.1.4.cmml" id="Sx3.SSx4.p1.1.m1.1.1d.cmml" xref="Sx3.SSx4.p1.1.m1.1.1"></share><cn id="Sx3.SSx4.p1.1.m1.1.1.6.cmml" type="float" xref="Sx3.SSx4.p1.1.m1.1.1.6">0.1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.p1.1.m1.1c">0.8:0.1:0.1</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx4.p1.1.m1.1d">0.8 : 0.1 : 0.1</annotation></semantics></math> ratio, ensuring that duplicates were always placed in the same split. After applying model-specific filters, the final dataset included <span class="ltx_text ltx_number" id="Sx3.SSx4.p1.1.1">224 737</span> training spectra, <span class="ltx_text ltx_number" id="Sx3.SSx4.p1.1.2">28 177</span> validation spectra, and <span class="ltx_text ltx_number" id="Sx3.SSx4.p1.1.3">28 267</span> testing spectra.
The lists of compounds forming all three datasets are provided in the project’s GitHub repository.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx3.SSx5">
<h3 class="ltx_title ltx_title_subsection">Preprocessing</h3>
<div class="ltx_para" id="Sx3.SSx5.p1">
<p class="ltx_p" id="Sx3.SSx5.p1.1">The preprocessing pipeline for spectra includes two key steps: rounding the m/z values to the nearest integer and logarithmically binning the relative intensity values into one of 30 bins using a logarithm base of 1.28 (details in Section <a class="ltx_ref ltx_refmacro_nameref" href="https://arxiv.org/html/2502.05114v1#Sx3.SSx8.SSSx1" title="In Hyperparameter search ‣ Methods ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_title">Experiment 1: Intensity binning</span></a>). Additionally, each encoded SMILES sequence is enriched with a special token indicating the source of the spectra (<span class="ltx_text ltx_font_italic" id="Sx3.SSx5.p1.1.1">&lt;rassp&gt;</span>, <span class="ltx_text ltx_font_italic" id="Sx3.SSx5.p1.1.2">&lt;neims&gt;</span>, <span class="ltx_text ltx_font_italic" id="Sx3.SSx5.p1.1.3">&lt;nist&gt;</span>). This strategy, inspired by multilingual language models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib23" title="">23</a>]</cite>, was designed to enable the model to adapt to the unique characteristics of spectra from different sources.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx3.SSx6">
<h3 class="ltx_title ltx_title_subsection">Pretraining</h3>
<div class="ltx_para" id="Sx3.SSx6.p1">
<p class="ltx_p" id="Sx3.SSx6.p1.1">SpecTUS was pretrained on both <span class="ltx_text ltx_font_italic" id="Sx3.SSx6.p1.1.1">synth1</span> and <span class="ltx_text ltx_font_italic" id="Sx3.SSx6.p1.1.2">synth2</span>, using a balanced 1:1 mixture of NEIMS-generated and RASSP-generated synthetic spectra. This pretraining stage provided the model with a broad understanding of the chemical space of small molecules, enhancing its ability to generalize effectively (as demonstrated in Section <a class="ltx_ref ltx_refmacro_nameref" href="https://arxiv.org/html/2502.05114v1#Sx3.SSx8.SSSx3" title="In Hyperparameter search ‣ Methods ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_title">Experiment 3: Pretraining dataset mixing</span></a>). Pretraining was conducted with a batch size of 128 for <span class="ltx_text ltx_number" id="Sx3.SSx6.p1.1.3">448 000</span> updating steps, allowing the model to process each of the 17.2 million spectra approximately three times.</p>
</div>
<div class="ltx_para" id="Sx3.SSx6.p2">
<p class="ltx_p" id="Sx3.SSx6.p2.1">The entire pretraining process, including control evaluations on validation sets (single candidate) every <span class="ltx_text ltx_number" id="Sx3.SSx6.p2.1.1">16 000</span> steps, was completed in 58 hours using a single NVIDIA H100 GPU. To save time and computational resources during these evaluations, we used a random subset of <span class="ltx_text ltx_number" id="Sx3.SSx6.p2.1.2">10 000</span> NIST validation spectra and <span class="ltx_text ltx_number" id="Sx3.SSx6.p2.1.3">30 000</span> synthetic spectra.</p>
</div>
<div class="ltx_para" id="Sx3.SSx6.p3">
<p class="ltx_p" id="Sx3.SSx6.p3.1">During pretraining, the percentage of correctly reconstructed structures increased steadily but it remained relatively low at the end of the stage: 38% for RASSP-generated spectra, 29% for NEIMS-generated spectra, and 3% for NIST spectra. However, 96% of the generated SMILES strings (RASSP, NEIMS) were valid canonical molecules, with 91% (RASSP), 78% (NEIMS), and 14% (NIST) having correct molecular formulas, though possibly incorrect structures. These results suggest that during the pretraining phase, the model successfully learned molecular structure rules and the relationship between atomic weight and m/z values, forming a good foundation for subsequent finetuning.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx3.SSx7">
<h3 class="ltx_title ltx_title_subsection">Finetuning</h3>
<div class="ltx_para" id="Sx3.SSx7.p1">
<p class="ltx_p" id="Sx3.SSx7.p1.1">In the second stage, SpecTUS was finetuned to enhance its ability to recognize and process real-world experimental data. The model was trained for <span class="ltx_text ltx_number" id="Sx3.SSx7.p1.1.1">296 000</span> steps on the NIST training set, allowing it to process each spectrum approximately 80 times.</p>
</div>
<div class="ltx_para" id="Sx3.SSx7.p2">
<p class="ltx_p" id="Sx3.SSx7.p2.1">The finetuning process, including control evaluations on validation sets every <span class="ltx_text ltx_number" id="Sx3.SSx7.p2.1.1">21 068</span> steps (approximately every 12 epochs), was completed in 28 hours on a single NVIDIA H100 GPU. To conserve time and computational resources, control evaluations used the full NIST validation set but were limited to a subset of <span class="ltx_text ltx_number" id="Sx3.SSx7.p2.1.2">2 000</span> synthetic spectra.</p>
</div>
<div class="ltx_para" id="Sx3.SSx7.p3">
<p class="ltx_p" id="Sx3.SSx7.p3.1">During finetuning, the model’s ability to reconstruct structures from synthetic spectra dropped sharply to zero, with formula-matching accuracy decreasing to 19% for NEIMS-generated spectra and 17% for RASSP-generated spectra after just six epochs. However, validation results for NIST spectra skyrocketed above the convergence level of models trained exclusively on experimental spectra, as demonstrated in Section <a class="ltx_ref ltx_refmacro_nameref" href="https://arxiv.org/html/2502.05114v1#Sx3.SSx8.SSSx3" title="In Hyperparameter search ‣ Methods ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_title">Experiment 3: Pretraining dataset mixing</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx3.SSx8">
<h3 class="ltx_title ltx_title_subsection">Hyperparameter search</h3>
<div class="ltx_para" id="Sx3.SSx8.p1">
<p class="ltx_p" id="Sx3.SSx8.p1.1">One of the main contributions of this paper is a series of experiments that offer practical insights and best practices for developing machine-learning models, particularly transformer-based architectures, for spectrometry and chemistry. While some findings are technical, they provide valuable guidance to streamline the design and optimization of future models.</p>
</div>
<div class="ltx_para" id="Sx3.SSx8.p2">
<p class="ltx_p" id="Sx3.SSx8.p2.1">First, we investigated different methods for binning relative intensity values to effectively represent continuous data. We compared the performance of two molecular representations—SELFIES <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib29" title="">29</a>]</cite> and SMILES <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib15" title="">15</a>]</cite>—in a generative modelling task and experimented with tokenization techniques for text-based molecular structures. Next, we examined the benefits of pretraining on synthetic data and identified best practices for dataset labeling and dataset mixing strategies. Lastly, we pushed the performance boundaries by leveraging larger datasets and extended training durations.</p>
</div>
<div class="ltx_para" id="Sx3.SSx8.p3">
<p class="ltx_p" id="Sx3.SSx8.p3.1">To optimize computational resources, we tailored our experimental approach. For the first two experiments, we skipped the pretraining phase and conducted only finetuning on the NIST dataset, using <span class="ltx_text ltx_number" id="Sx3.SSx8.p3.1.1">74 000</span> updating steps. For experiments focused on pretraining, we included a pretraining phase of <span class="ltx_text ltx_number" id="Sx3.SSx8.p3.1.2">124 000</span> steps, followed by a finetuning phase of <span class="ltx_text ltx_number" id="Sx3.SSx8.p3.1.3">74 000</span> steps. These run lengths were chosen to identify meaningful trends while maintaining manageable computational costs.</p>
</div>
<section class="ltx_subsubsection" id="Sx3.SSx8.SSSx1">
<h4 class="ltx_title ltx_title_subsubsection">Experiment 1: Intensity binning</h4>
<div class="ltx_para" id="Sx3.SSx8.SSSx1.p1">
<p class="ltx_p" id="Sx3.SSx8.SSSx1.p1.8">In the first experiment, we tried to find the optimal method for binning relative intensity values, enabling each value to be represented as a trainable embedding vector. We compared several variants of linear and logarithmic binning methods. For linear binning, we tested precision levels of 2, 3, and 4 decimal places, corresponding to 100, <span class="ltx_text ltx_number" id="Sx3.SSx8.SSSx1.p1.8.1">1 000</span>, and <span class="ltx_text ltx_number" id="Sx3.SSx8.SSSx1.p1.8.2">10 000</span> bins, respectively, each with its own trainable embedding. For logarithmic binning, we used the formula</p>
<table class="ltx_equation ltx_eqn_table" id="Sx3.Ex6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="n=\max(\lfloor\log_{b}(i)\rfloor+s),\ 0)" class="ltx_math_unparsed" display="block" id="Sx3.Ex6.m1.3"><semantics id="Sx3.Ex6.m1.3a"><mrow id="Sx3.Ex6.m1.3b"><mi id="Sx3.Ex6.m1.3.4">n</mi><mo id="Sx3.Ex6.m1.3.5">=</mo><mi id="Sx3.Ex6.m1.2.2">max</mi><mrow id="Sx3.Ex6.m1.3.6"><mo id="Sx3.Ex6.m1.3.6.1" stretchy="false">(</mo><mrow id="Sx3.Ex6.m1.3.6.2"><mo id="Sx3.Ex6.m1.3.6.2.1" stretchy="false">⌊</mo><msub id="Sx3.Ex6.m1.3.6.2.2"><mi id="Sx3.Ex6.m1.3.6.2.2.2">log</mi><mi id="Sx3.Ex6.m1.3.6.2.2.3">b</mi></msub><mrow id="Sx3.Ex6.m1.3.6.2.3"><mo id="Sx3.Ex6.m1.3.6.2.3.1" stretchy="false">(</mo><mi id="Sx3.Ex6.m1.1.1">i</mi><mo id="Sx3.Ex6.m1.3.6.2.3.2" stretchy="false">)</mo></mrow><mo id="Sx3.Ex6.m1.3.6.2.4" stretchy="false">⌋</mo></mrow><mo id="Sx3.Ex6.m1.3.6.3">+</mo><mi id="Sx3.Ex6.m1.3.6.4">s</mi><mo id="Sx3.Ex6.m1.3.6.5" stretchy="false">)</mo></mrow><mo id="Sx3.Ex6.m1.3.7">,</mo><mn id="Sx3.Ex6.m1.3.3"> 0</mn><mo id="Sx3.Ex6.m1.3.8" stretchy="false">)</mo></mrow><annotation encoding="application/x-tex" id="Sx3.Ex6.m1.3c">n=\max(\lfloor\log_{b}(i)\rfloor+s),\ 0)</annotation><annotation encoding="application/x-llamapun" id="Sx3.Ex6.m1.3d">italic_n = roman_max ( ⌊ roman_log start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( italic_i ) ⌋ + italic_s ) , 0 )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx3.SSx8.SSSx1.p1.7">where <math alttext="n" class="ltx_Math" display="inline" id="Sx3.SSx8.SSSx1.p1.1.m1.1"><semantics id="Sx3.SSx8.SSSx1.p1.1.m1.1a"><mi id="Sx3.SSx8.SSSx1.p1.1.m1.1.1" xref="Sx3.SSx8.SSSx1.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx8.SSSx1.p1.1.m1.1b"><ci id="Sx3.SSx8.SSSx1.p1.1.m1.1.1.cmml" xref="Sx3.SSx8.SSSx1.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx8.SSSx1.p1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx8.SSSx1.p1.1.m1.1d">italic_n</annotation></semantics></math> is the assigned bin index to intensity value <math alttext="i" class="ltx_Math" display="inline" id="Sx3.SSx8.SSSx1.p1.2.m2.1"><semantics id="Sx3.SSx8.SSSx1.p1.2.m2.1a"><mi id="Sx3.SSx8.SSSx1.p1.2.m2.1.1" xref="Sx3.SSx8.SSSx1.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx8.SSSx1.p1.2.m2.1b"><ci id="Sx3.SSx8.SSSx1.p1.2.m2.1.1.cmml" xref="Sx3.SSx8.SSSx1.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx8.SSSx1.p1.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx8.SSSx1.p1.2.m2.1d">italic_i</annotation></semantics></math>, logarithm base <math alttext="b" class="ltx_Math" display="inline" id="Sx3.SSx8.SSSx1.p1.3.m3.1"><semantics id="Sx3.SSx8.SSSx1.p1.3.m3.1a"><mi id="Sx3.SSx8.SSSx1.p1.3.m3.1.1" xref="Sx3.SSx8.SSSx1.p1.3.m3.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx8.SSSx1.p1.3.m3.1b"><ci id="Sx3.SSx8.SSSx1.p1.3.m3.1.1.cmml" xref="Sx3.SSx8.SSSx1.p1.3.m3.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx8.SSSx1.p1.3.m3.1c">b</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx8.SSSx1.p1.3.m3.1d">italic_b</annotation></semantics></math> changes the shape of the final bin distribution, and shift <math alttext="s" class="ltx_Math" display="inline" id="Sx3.SSx8.SSSx1.p1.4.m4.1"><semantics id="Sx3.SSx8.SSSx1.p1.4.m4.1a"><mi id="Sx3.SSx8.SSSx1.p1.4.m4.1.1" xref="Sx3.SSx8.SSSx1.p1.4.m4.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx8.SSSx1.p1.4.m4.1b"><ci id="Sx3.SSx8.SSSx1.p1.4.m4.1.1.cmml" xref="Sx3.SSx8.SSSx1.p1.4.m4.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx8.SSSx1.p1.4.m4.1c">s</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx8.SSSx1.p1.4.m4.1d">italic_s</annotation></semantics></math> helps to set a particular number of bins for relative intensity values between 0 and 1. The <math alttext="\max" class="ltx_Math" display="inline" id="Sx3.SSx8.SSSx1.p1.5.m5.1"><semantics id="Sx3.SSx8.SSSx1.p1.5.m5.1a"><mi id="Sx3.SSx8.SSSx1.p1.5.m5.1.1" xref="Sx3.SSx8.SSSx1.p1.5.m5.1.1.cmml">max</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx8.SSSx1.p1.5.m5.1b"><max id="Sx3.SSx8.SSSx1.p1.5.m5.1.1.cmml" xref="Sx3.SSx8.SSSx1.p1.5.m5.1.1"></max></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx8.SSSx1.p1.5.m5.1c">\max</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx8.SSSx1.p1.5.m5.1d">roman_max</annotation></semantics></math> function ensures all the lowest intensities transformed to negative values fall into the bin 0. We evaluated four configurations, with the total number of bins (<math alttext="s+1" class="ltx_Math" display="inline" id="Sx3.SSx8.SSSx1.p1.6.m6.1"><semantics id="Sx3.SSx8.SSSx1.p1.6.m6.1a"><mrow id="Sx3.SSx8.SSSx1.p1.6.m6.1.1" xref="Sx3.SSx8.SSSx1.p1.6.m6.1.1.cmml"><mi id="Sx3.SSx8.SSSx1.p1.6.m6.1.1.2" xref="Sx3.SSx8.SSSx1.p1.6.m6.1.1.2.cmml">s</mi><mo id="Sx3.SSx8.SSSx1.p1.6.m6.1.1.1" xref="Sx3.SSx8.SSSx1.p1.6.m6.1.1.1.cmml">+</mo><mn id="Sx3.SSx8.SSSx1.p1.6.m6.1.1.3" xref="Sx3.SSx8.SSSx1.p1.6.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx8.SSSx1.p1.6.m6.1b"><apply id="Sx3.SSx8.SSSx1.p1.6.m6.1.1.cmml" xref="Sx3.SSx8.SSSx1.p1.6.m6.1.1"><plus id="Sx3.SSx8.SSSx1.p1.6.m6.1.1.1.cmml" xref="Sx3.SSx8.SSSx1.p1.6.m6.1.1.1"></plus><ci id="Sx3.SSx8.SSSx1.p1.6.m6.1.1.2.cmml" xref="Sx3.SSx8.SSSx1.p1.6.m6.1.1.2">𝑠</ci><cn id="Sx3.SSx8.SSSx1.p1.6.m6.1.1.3.cmml" type="integer" xref="Sx3.SSx8.SSSx1.p1.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx8.SSSx1.p1.6.m6.1c">s+1</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx8.SSSx1.p1.6.m6.1d">italic_s + 1</annotation></semantics></math>) being 10, 21, 30, and 40. For each variant, we tuned the parameter <math alttext="b" class="ltx_Math" display="inline" id="Sx3.SSx8.SSSx1.p1.7.m7.1"><semantics id="Sx3.SSx8.SSSx1.p1.7.m7.1a"><mi id="Sx3.SSx8.SSSx1.p1.7.m7.1.1" xref="Sx3.SSx8.SSSx1.p1.7.m7.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx8.SSSx1.p1.7.m7.1b"><ci id="Sx3.SSx8.SSSx1.p1.7.m7.1.1.cmml" xref="Sx3.SSx8.SSSx1.p1.7.m7.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx8.SSSx1.p1.7.m7.1c">b</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx8.SSSx1.p1.7.m7.1d">italic_b</annotation></semantics></math> on the NIST training set intensities to distribute the values into bins as evenly as possible (see the distributions in Section <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A3.SS1" title="C.1 Experiment 1: Intensity binning ‣ Appendix C Experiments ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">C.1</span></a>). Binning beyond 40 bins was not practical, as the bin ranges became excessively narrow, leaving many bins empty and thus non-trainable.</p>
</div>
<div class="ltx_para" id="Sx3.SSx8.SSSx1.p2">
<p class="ltx_p" id="Sx3.SSx8.SSSx1.p2.1">Over-simplified binning approaches (linear binning with 2 decimal places and logarithmic binning with 10 bins) led to a 3–4% drop in validation Acc<sub class="ltx_sub" id="Sx3.SSx8.SSSx1.p2.1.1">1</sub> compared to the other models in the experiment. This performance decline was likely caused by significant information loss: for example, 47% of the smallest intensity values were set to zero with 2-decimal-place linear binning. Similarly, 10-bin logarithmic binning lacked sufficient granularity for lower intensity values, as illustrated by histogram comparisons in Section <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A3.SS1" title="C.1 Experiment 1: Intensity binning ‣ Appendix C Experiments ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">C.1</span></a>.</p>
</div>
<div class="ltx_para" id="Sx3.SSx8.SSSx1.p3">
<p class="ltx_p" id="Sx3.SSx8.SSSx1.p3.1">Higher-resolution binning methods—linear binning with 3 or 4 decimal places and logarithmic binning with 21, 30, or 40 bins—achieved comparable results, with validation performance varying within a 1% margin. Among these, logarithmic binning with 30 bins emerged as the optimal choice. It provided a 0.9% improvement in validation Acc<sub class="ltx_sub" id="Sx3.SSx8.SSSx1.p3.1.1">1</sub> compared to 4-decimal-place linear binning while reducing the number of trainable parameters by 10 million, demonstrating its efficiency and validity as a binning strategy.</p>
</div>
<div class="ltx_para" id="Sx3.SSx8.SSSx1.p4">
<p class="ltx_p" id="Sx3.SSx8.SSSx1.p4.1">The tracked control evaluations for this experiment can be found in Figure <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A3.F11" title="Figure 11 ‣ C.1 Experiment 1: Intensity binning ‣ Appendix C Experiments ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">11</span></a>, and the comparison with the rest of the experiment runs is in Table <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A3.T9" title="Table 9 ‣ Appendix C Experiments ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">9</span></a>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="Sx3.SSx8.SSSx2">
<h4 class="ltx_title ltx_title_subsubsection">Experiment 2: Molecular Representations and Tokenization</h4>
<div class="ltx_para" id="Sx3.SSx8.SSSx2.p1">
<p class="ltx_p" id="Sx3.SSx8.SSSx2.p1.1">In this experiment, we aimed to find the optimal molecular representation generated by the model’s decoder. First, we evaluated two different structural representations for molecules, comparing SMILES and SELFIES. SELFIES, a token-based successor to the well-established SMILES representation, was specifically designed for generative neural networks, guaranteeing the validity of every sequence by construction.
Further, we explored enhancing classic character-level SMILES encoding through Byte Pair Encoding (BPE) tokenization <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib30" title="">30</a>]</cite>, which segments strings into frequent multi-character groups. This technique, widely adopted in early natural language generation (NLG) applications <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#bib.bib32" title="">32</a>]</cite>, allows models to directly generate tokens with higher-level semantic meanings, potentially corresponding to molecular functional groups.</p>
</div>
<div class="ltx_para" id="Sx3.SSx8.SSSx2.p2">
<p class="ltx_p" id="Sx3.SSx8.SSSx2.p2.1">To investigate the impact of BPE tokenization, we trained four BPE tokenizers with varying vocabulary sizes on a random set of one million SMILES strings sampled from the synth dataset. The vocabulary size was indirectly controlled by adjusting the minimal substring frequency hyperparameter (mf) to values of 10, 100, 10K, and 10M. These settings yielded vocabulary sizes of <span class="ltx_text ltx_number" id="Sx3.SSx8.SSSx2.p2.1.1">1 286</span>, 780, 367, and 267 tokens, respectively, with the smallest vocabulary (mf10M <math alttext="\rightarrow" class="ltx_Math" display="inline" id="Sx3.SSx8.SSSx2.p2.1.m1.1"><semantics id="Sx3.SSx8.SSSx2.p2.1.m1.1a"><mo id="Sx3.SSx8.SSSx2.p2.1.m1.1.1" stretchy="false" xref="Sx3.SSx8.SSSx2.p2.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="Sx3.SSx8.SSSx2.p2.1.m1.1b"><ci id="Sx3.SSx8.SSSx2.p2.1.m1.1.1.cmml" xref="Sx3.SSx8.SSSx2.p2.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx8.SSSx2.p2.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx8.SSSx2.p2.1.m1.1d">→</annotation></semantics></math> 256 byte tokens + 11 special tokens) corresponding to a character-level encoding. The relationship between vocabulary size and minimal substring frequency is visualized in Figure <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A3.F12" title="Figure 12 ‣ C.2 Experiment 2: Molecular Representations and Tokenization ‣ Appendix C Experiments ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">12</span></a>.</p>
</div>
<div class="ltx_para" id="Sx3.SSx8.SSSx2.p3">
<p class="ltx_p" id="Sx3.SSx8.SSSx2.p3.2">Models using SMILES strings with BPE tokenization consistently outperformed the model trained on SELFIES, achieving improvements of 1.7–5.8% in validation Acc<sub class="ltx_sub" id="Sx3.SSx8.SSSx2.p3.2.1">1</sub>. Interestingly, contrary to expectations based on NLG, larger BPE vocabularies did not lead to better performance. Instead, the character-level encoding (mf10M) outperformed all the BPE tokenizations by a margin of 3.5–4% on validation Acc<sub class="ltx_sub" id="Sx3.SSx8.SSSx2.p3.2.2">1</sub>. The trend suggests not only that “the smaller the vocabulary, the better the performance” but also that even introducing relatively few aggregated tokens into the vocabulary can significantly degrade performance.</p>
</div>
<div class="ltx_para" id="Sx3.SSx8.SSSx2.p4">
<p class="ltx_p" id="Sx3.SSx8.SSSx2.p4.1">We currently lack a clear hypothesis to explain why SMILES outperformed SELFIES. However, based on the results of the models’ comparison, we infer that the Transformer architecture effectively constructs higher-level molecular semantics internally within its decoder blocks. This suggests that keeping the representation simple, such as through character-level encoding, grants the model greater expressive freedom, ultimately leading to better performance.</p>
</div>
<div class="ltx_para" id="Sx3.SSx8.SSSx2.p5">
<p class="ltx_p" id="Sx3.SSx8.SSSx2.p5.1">The tracked control evaluations for the tokenization experiment can be found in Figure <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A3.F13" title="Figure 13 ‣ C.2 Experiment 2: Molecular Representations and Tokenization ‣ Appendix C Experiments ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">13</span></a>, and the comparison with the rest of the experiment runs is in Table <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A3.T9" title="Table 9 ‣ Appendix C Experiments ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">9</span></a>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="Sx3.SSx8.SSSx3">
<h4 class="ltx_title ltx_title_subsubsection">Experiment 3: Pretraining dataset mixing</h4>
<div class="ltx_para" id="Sx3.SSx8.SSSx3.p1">
<p class="ltx_p" id="Sx3.SSx8.SSSx3.p1.1">For pertaining experiments, we used the <span class="ltx_text ltx_font_italic" id="Sx3.SSx8.SSSx3.p1.1.1">synth1</span> dataset (see Section <a class="ltx_ref ltx_refmacro_nameref" href="https://arxiv.org/html/2502.05114v1#Sx3.SSx3" title="In Methods ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_title">Pretraining datasets</span></a>) containing 4.7 million compounds or 9.4 million spectra generated by the NEIMS and RASSP models. To assess the impact of pretraining on the final model performance, we compared the 30-bin non-pretrained model from the last experiment to four models that were first pretrained on different mixtures of datasets and then finetuned on the NIST training set. The dataset mixing strategy involved random sampling from all datasets in the mixture without repetition, with the proportion of each dataset controlled by a weight parameter.</p>
</div>
<div class="ltx_para" id="Sx3.SSx8.SSSx3.p2">
<p class="ltx_p" id="Sx3.SSx8.SSSx3.p2.1">The pretraining experiments used four dataset combinations: RASSP-only, NEIMS-only, a 1:1 mix of NEIMS and RASSP (NEIMS:RASSP), and a mixture of NEIMS, RASSP, and a small fraction of NIST data in a 1:1:0.1 ratio (NEIMS:RASSP:NIST). The inclusion of NIST data in the last configuration was intended to accelerate the initial stage of finetuning and potentially keep this advantage throughout the training process.</p>
</div>
<div class="ltx_para" id="Sx3.SSx8.SSSx3.p3">
<p class="ltx_p" id="Sx3.SSx8.SSSx3.p3.1">Pretraining was conducted for a fixed number of <span class="ltx_text ltx_number" id="Sx3.SSx8.SSSx3.p3.1.1">112 000</span> steps, and with a batch size of 128, approximately 14.3 million examples were processed during pretraining. The number of epochs varied depending on the dataset mixture; for example, in the NEIMS:RASSP mix, each spectrum was seen approximately 1.7 times on average, while for the RASSP-only mixture, each spectrum was encountered about twice as many times. The performance of all models was compared on the NIST validation set after the finetuning phase.</p>
</div>
<div class="ltx_para" id="Sx3.SSx8.SSSx3.p4">
<p class="ltx_p" id="Sx3.SSx8.SSSx3.p4.2">In the experiment, the models pretrained on synthetic datasets outperformed the finetuned-only model by 7–10% on validation Acc<sub class="ltx_sub" id="Sx3.SSx8.SSSx3.p4.2.1">1</sub>, clearly exceeding the convergence level of the non-pretrained model. Among the pretrained models, the NEIMS-only model achieved 2% better Acc<sub class="ltx_sub" id="Sx3.SSx8.SSSx3.p4.2.2">1</sub> than the RASSP-only model. However, combining NEIMS and RASSP datasets in a 1:1 ratio led to the best performance, improving accuracy by an additional 1% compared to NEIMS-only pretraining. Including a small fraction of experimental NIST data in the pretraining mix (NEIMS:RASSP:NIST) did not improve the final performance.</p>
</div>
<div class="ltx_para" id="Sx3.SSx8.SSSx3.p5">
<p class="ltx_p" id="Sx3.SSx8.SSSx3.p5.1">From these results, we deduce that despite the questionable quality of synthetic spectra, having broader coverage of the chemical space during pretraining helps the model generalize better. Combining spectra from two sources is more effective than training on a single source for twice as many epochs.</p>
</div>
<div class="ltx_para" id="Sx3.SSx8.SSSx3.p6">
<p class="ltx_p" id="Sx3.SSx8.SSSx3.p6.1">The tracked control evaluations for this experiment can be found in Figure <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A3.F14" title="Figure 14 ‣ C.3 Experiment 3: Pretraining dataset mixing ‣ Appendix C Experiments ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">14</span></a>, and the comparison with the rest of the experiment runs is in Table <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A3.T9" title="Table 9 ‣ Appendix C Experiments ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">9</span></a>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="Sx3.SSx8.SSSx4">
<h4 class="ltx_title ltx_title_subsubsection">Experiment 4: Source indication</h4>
<div class="ltx_para" id="Sx3.SSx8.SSSx4.p1">
<p class="ltx_p" id="Sx3.SSx8.SSSx4.p1.1">After identifying the optimal pretraining strategy, we evaluated whether the model benefits from including source indication via a special token preceding the generated SMILES sequence (see Section <a class="ltx_ref ltx_refmacro_nameref" href="https://arxiv.org/html/2502.05114v1#Sx3.SSx5" title="In Methods ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_title">Preprocessing</span></a>). To test this, we compared the RASSP:NEIMS pretrained and NIST finetuned model from the previous experiment, which used distinct source tokens to indicate the origin of each spectrum, with an otherwise identical setting that utilized a single generic source token for all datasets.</p>
</div>
<div class="ltx_para" id="Sx3.SSx8.SSSx4.p2">
<p class="ltx_p" id="Sx3.SSx8.SSSx4.p2.1">The experiment revealed that the source indication had no substantial impact on performance. It did not affect control validations during pretraining, and at the end of finetuning, the model with a single source token performed 0.2% better on Acc<sub class="ltx_sub" id="Sx3.SSx8.SSSx4.p2.1.1">1</sub> than the one with three distinct source tokens. Despite this, we retained the source indication mechanism in the final model to allow for potential use in future finetuning experiments on smaller custom datasets. Users can decide whether to explore this feature further or use the default &lt;nist&gt; token on their data.</p>
</div>
<div class="ltx_para" id="Sx3.SSx8.SSSx4.p3">
<p class="ltx_p" id="Sx3.SSx8.SSSx4.p3.1">The tracked control evaluations for this experiment can be found in Figure <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A3.F15" title="Figure 15 ‣ C.4 Experiment 4: Source indication ‣ Appendix C Experiments ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">15</span></a> and the comparison with the rest of the experiments runs is in Table <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A3.T9" title="Table 9 ‣ Appendix C Experiments ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">9</span></a>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="Sx3.SSx8.SSSx5">
<h4 class="ltx_title ltx_title_subsubsection">Experiment 5: Training length and dataset size</h4>
<div class="ltx_para" id="Sx3.SSx8.SSSx5.p1">
<p class="ltx_p" id="Sx3.SSx8.SSSx5.p1.1">In the final experiment, we assessed the impact of extended training duration and a larger dataset on the model’s performance. Using the best-performing model from Experiment 3 as the baseline – pretrained on <span class="ltx_text ltx_font_italic" id="Sx3.SSx8.SSSx5.p1.1.1">synth1</span> NEIMS:RASSP balanced mix (4.2 million training compounds) for <span class="ltx_text ltx_number" id="Sx3.SSx8.SSSx5.p1.1.2">112 000</span> steps and finetuned on the NIST experimental spectra for <span class="ltx_text ltx_number" id="Sx3.SSx8.SSSx5.p1.1.3">74 000</span> steps – we explored various combinations of extended pretraining and finetuning lengths, as well as larger training datasets. All other hyperparameters, including those related to binning, tokenization, and dataset mixing, were kept consistent with the findings of Experiments 1-3.</p>
</div>
<div class="ltx_para" id="Sx3.SSx8.SSSx5.p2">
<p class="ltx_p" id="Sx3.SSx8.SSSx5.p2.1">To simplify comparisons, we used a naming convention: the number of pretraining compounds, pretraining steps, and finetuning steps (e.g., 4.2M_112k_74k for the baseline model). The tested combinations included (1) doubling the pretraining duration to 224k steps while keeping finetuning at 74k steps (4.2M_224k_74k), (2) doubling both pretraining and finetuning steps (4.2M_224k_148k), (3) pretraining on the combined <span class="ltx_text ltx_font_italic" id="Sx3.SSx8.SSSx5.p2.1.1">synth1</span> and <span class="ltx_text ltx_font_italic" id="Sx3.SSx8.SSSx5.p2.1.2">synth2</span> datasets with prolonged pretraining and finetuning (8.6M_224k_148k), and (4) a full-scale training setting with both datasets and quadrupled pretraining and finetuning to maximize convergence (8.6M_448k_296k).</p>
</div>
<div class="ltx_para" id="Sx3.SSx8.SSSx5.p3">
<p class="ltx_p" id="Sx3.SSx8.SSSx5.p3.3">Doubling the pretraining stage alone to <span class="ltx_text ltx_number" id="Sx3.SSx8.SSSx5.p3.3.1">224 000</span> steps (4.2M_224k_74k) improved Acc<sub class="ltx_sub" id="Sx3.SSx8.SSSx5.p3.3.2">1</sub> by 1.2%. Further doubling the finetuning stage (4.2M_224k_148k) increased Acc<sub class="ltx_sub" id="Sx3.SSx8.SSSx5.p3.3.3">1</sub> by another 0.7%. Expanding the dataset size to include both <span class="ltx_text ltx_font_italic" id="Sx3.SSx8.SSSx5.p3.3.4">synth1</span> and <span class="ltx_text ltx_font_italic" id="Sx3.SSx8.SSSx5.p3.3.5">synth2</span> (8.6M_224k_148k) yielded a 0.9% gain in Acc<sub class="ltx_sub" id="Sx3.SSx8.SSSx5.p3.3.6">1</sub>. These isolated improvements indicate that extending training duration and increasing dataset size independently benefit the model. While we lack the analysis of all combinations to draw definitive conclusions, the results suggest that scaling pretraining, finetuning, and dataset size contribute similarly to performance gains. Still, among the tested approaches, expanding the dataset size was the most effective option, as it required no additional computing power.</p>
</div>
<div class="ltx_para" id="Sx3.SSx8.SSSx5.p4">
<p class="ltx_p" id="Sx3.SSx8.SSSx5.p4.1">The best results were achieved by combining all three strategies. The final configuration (8.6M_448k_296k) improved Acc<sub class="ltx_sub" id="Sx3.SSx8.SSSx5.p4.1.1">1</sub> by 2.6% compared to the intermediate 8.6M_224k_148k setting and by 5.4% compared to the baseline 4.2M_112k_74k model. This fully converged SpecTUS model represents the highest-performing configuration across all experiments.</p>
</div>
<div class="ltx_para" id="Sx3.SSx8.SSSx5.p5">
<p class="ltx_p" id="Sx3.SSx8.SSSx5.p5.1">The tracked control evaluations for this experiment can be found in Figure <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A3.F16" title="Figure 16 ‣ C.5 Experiment 5: Training length and dataset size ‣ Appendix C Experiments ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">16</span></a>, and the comparison with the rest of the experiment runs is in Table <a class="ltx_ref" href="https://arxiv.org/html/2502.05114v1#A3.T9" title="Table 9 ‣ Appendix C Experiments ‣ SpecTUS: Spectral Translator for Unknown Structures annotation from EI-MS spectra"><span class="ltx_text ltx_ref_tag">9</span></a>.</p>
</div>
<div class="ltx_para" id="Sx3.SSx8.SSSx5.p6">
<span class="ltx_ERROR undefined" id="Sx3.SSx8.SSSx5.p6.1">\bmhead</span>
<p class="ltx_p" id="Sx3.SSx8.SSSx5.p6.2">Supplementary information</p>
</div>
<div class="ltx_para" id="Sx3.SSx8.SSSx5.p7">
<ul class="ltx_itemize" id="Sx3.I3">
<li class="ltx_item" id="Sx3.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx3.I3.i1.p1">
<p class="ltx_p" id="Sx3.I3.i1.p1.1">For quick, zero-install demonstration, SpecTUS inference (with limited throughput) is exposed via REST API at our cluster,
accessible with a Binder-ready Jupyter notebook at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/ljocha/spectus-demo" title="">https://github.com/ljocha/spectus-demo</a>.</p>
</div>
</li>
<li class="ltx_item" id="Sx3.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx3.I3.i2.p1">
<p class="ltx_p" id="Sx3.I3.i2.p1.1">Complete source code of SpecTUS is available on GitHub: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/hejjack/SpecTUS" title="">https://github.com/hejjack/SpecTUS</a>.</p>
</div>
</li>
<li class="ltx_item" id="Sx3.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx3.I3.i3.p1">
<p class="ltx_p" id="Sx3.I3.i3.p1.1">The whole process of building the model
from scratch or fine-tuning the pretrained model, and reproducing the test results of this paper,
is implemented in a series of Jupyter notebooks included in the repository above.</p>
</div>
</li>
<li class="ltx_item" id="Sx3.I3.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx3.I3.i4.p1">
<p class="ltx_p" id="Sx3.I3.i4.p1.1">Pretrained model and synthetic datasets are published at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/MS-ML" title="">https://huggingface.co/MS-ML</a>.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="Sx3.SSx8.SSSx5.p8">
<span class="ltx_ERROR undefined" id="Sx3.SSx8.SSSx5.p8.1">\bmhead</span>
<p class="ltx_p" id="Sx3.SSx8.SSSx5.p8.2">Acknowledgements
This work was supported by the Ministry of Education, Youth and Sports of the Czech Republic through the e-INFRA CZ (ID:90254).
</p>
</div>
</section>
</section>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.1.1">
<span class="ltx_bibblock"><span class="ltx_ERROR undefined" id="bib.1.1.1.1">\bibcommenthead</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Kelly, K. &amp; Bell, S.

</span>
<span class="ltx_bibblock">Evaluation of the reproducibility and repeatability
of gcms retention indices and mass spectra of novel psychoactive substances.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Forensic Chemistry</em>
<span class="ltx_text ltx_font_bold" id="bib.bib1.2.2">7</span>, 10–18 (2018).

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.sciencedirect.com/science/article/pii/S2468170917301157" title="">https://www.sciencedirect.com/science/article/pii/S2468170917301157</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Moorthy, A. S., Wallace, W. E.,
Kearsley, A. J., Tchekhovskoi, D. V. &amp;
Stein, S. E.

</span>
<span class="ltx_bibblock">Combining Fragment-Ion and Neutral-Loss
Matching during Mass Spectral Library Searching: A New
General Purpose Algorithm Applicable to Illicit Drug
Identification.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Analytical Chemistry</em>
<span class="ltx_text ltx_font_bold" id="bib.bib2.2.2">89</span>, 13261–13268
(2017).

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1021/acs.analchem.7b03320" title="">https://doi.org/10.1021/acs.analchem.7b03320</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Cooper, B. <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">et al.</em>
</span>
<span class="ltx_bibblock">Hybrid search: a method for identifying metabolites
absent from tandem mass spectrometry libraries.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.2.1">Analytical Chemistry</em>
<span class="ltx_text ltx_font_bold" id="bib.bib3.3.2">91</span> (2019).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Wakoli, J. <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">et al.</em>
</span>
<span class="ltx_bibblock">GCMS-ID: a webserver for identifying compounds from
gas chromatography mass spectrometry experiments.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.2.1">Nucleic Acids Research</em>
<span class="ltx_text ltx_font_bold" id="bib.bib4.3.2">52</span>, W381–W389
(2024).

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1093/nar/gkae425" title="">https://doi.org/10.1093/nar/gkae425</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Bauer, C. A. &amp; Grimme, S.

</span>
<span class="ltx_bibblock">How to compute electron ionization mass spectra from
first principles.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">J. Phys. Chem. A</em>
<span class="ltx_text ltx_font_bold" id="bib.bib5.2.2">120</span>, 3755–3766
(2016).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Hecht, H. <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">et al.</em>
</span>
<span class="ltx_bibblock">Quantum chemistry-based prediction of electron
ionization mass spectra for environmental chemicals.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.2.1">Anal Chem.</em> <span class="ltx_text ltx_font_bold" id="bib.bib6.3.2">96</span>,
13652–13662 (2024).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Schymanski, E. L., Meringer, M. &amp;
Brack, W.

</span>
<span class="ltx_bibblock">Matching structures to mass spectra using
fragmentation patterns: Are the results as good as they look?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Analytical Chemistry</em>
<span class="ltx_text ltx_font_bold" id="bib.bib7.2.2">81</span>, 3608–3617
(2009).

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1021/ac802715e" title="">https://doi.org/10.1021/ac802715e</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Advanced Chemistry Development, Inc. (ACD/Labs).

</span>
<span class="ltx_bibblock">ACD/MS Fragmenter.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.acdlabs.com/products/spectrus-platform/ms-fragmenter/" title="">https://www.acdlabs.com/products/spectrus-platform/ms-fragmenter/</a>.

</span>
<span class="ltx_bibblock">Accessed: 2025-01-21.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Wei, J. N., Belanger, D.,
Adams, R. P. &amp; Sculley, D.

</span>
<span class="ltx_bibblock">Rapid prediction of electron–ionization mass
spectrometry using neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">ACS Cent. Sci.</em>
<span class="ltx_text ltx_font_bold" id="bib.bib9.2.2">5</span>, 700––708
(2019).

</span>
<span class="ltx_bibblock">Doi: 10.1021/acscentsci.9b00085.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Rogers, D. &amp; Hahn, M.

</span>
<span class="ltx_bibblock">Extended-connectivity fingerprints.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">J. Chem. Inf. Model.</em>
<span class="ltx_text ltx_font_bold" id="bib.bib10.2.2">50</span>, 742–754
(2010).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Ji, H., Deng, H., Lu, H.
&amp; Zhang, Z.

</span>
<span class="ltx_bibblock">Predicting a molecular fingerprint from an electron
ionization mass spectrum with deep neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Analytical Chemistry</em>
<span class="ltx_text ltx_font_bold" id="bib.bib11.2.2">92</span>, 8649–8653
(2020).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Yang, Q. <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">et al.</em>
</span>
<span class="ltx_bibblock">Ultra-fast and accurate electron ionization mass
spectrum matching for compound identification with million-scale in-silico
library.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.2.1">Nature Communications</em>
<span class="ltx_text ltx_font_bold" id="bib.bib12.3.2">14</span> (2023).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Zhu, R. L. &amp; Jonas, E.

</span>
<span class="ltx_bibblock">Rapid approximate subset-based spectra prediction for
electron ionization-mass spectrometry.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Anal Chem.</em> <span class="ltx_text ltx_font_bold" id="bib.bib13.2.2">95</span>,
2653–2663 (2023).

</span>
<span class="ltx_bibblock">Doi: 10.1021/acs.analchem.2c02093.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Mikolov, T., Chen, K.,
Corrado, G. &amp; Dean, J.

</span>
<span class="ltx_bibblock">Efficient estimation of word representations in
vector space.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:1301.3781</em>
(2013).

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/1301.3781" title="">https://arxiv.org/abs/1301.3781</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Weininger, D.

</span>
<span class="ltx_bibblock">Smiles, a chemical language and information system.
1. introduction to methodology and encoding rules.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Journal of Chemical Information and Computer
Sciences</em> <span class="ltx_text ltx_font_bold" id="bib.bib15.2.2">28</span>, 31–36
(1988).

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1021/ci00057a005" title="">https://doi.org/10.1021/ci00057a005</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Shrivastava, A. D. <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">et al.</em>
</span>
<span class="ltx_bibblock">MassGenie: A transformer-based deep learning method
for identifying small molecules from their mass spectra.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.2.1">Biomolecules</em> <span class="ltx_text ltx_font_bold" id="bib.bib16.3.2">11</span>,
1793 (2021).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Litsa, E. E., Chenthamarakshan, V.,
Das, P. &amp; Kavraki, L. E.

</span>
<span class="ltx_bibblock">An end-to-end deep learning framework for translating
mass spectra to de-novo molecules.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Communications Chemistry</em>
<span class="ltx_text ltx_font_bold" id="bib.bib17.2.2">6</span>, 132 (2023).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Stravs, M. A., Dührkop, K.,
Böcker, S. <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">et al.</em>
</span>
<span class="ltx_bibblock">MSNovelist: de novo structure generation from mass
spectra.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.2.1">Nature Methods</em>
<span class="ltx_text ltx_font_bold" id="bib.bib18.3.2">19</span>, 865–870
(2022).

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1038/s41592-022-01486-3" title="">https://doi.org/10.1038/s41592-022-01486-3</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Dührkop, K., Fleischauer, M.,
Ludwig, M. <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">et al.</em>
</span>
<span class="ltx_bibblock">SIRIUS 4: a rapid tool for turning tandem mass
spectra into metabolite structure information.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.2.1">Nature Methods</em>
<span class="ltx_text ltx_font_bold" id="bib.bib19.3.2">16</span>, 299–302
(2019).

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1038/s41592-019-0344-8" title="">https://doi.org/10.1038/s41592-019-0344-8</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Butler, T. <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">et al.</em>
</span>
<span class="ltx_bibblock">MS2Mol: A transformer model for illuminating dark
chemical space from mass spectra.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.2.1">ChemRxiv</em> (2023).

</span>
<span class="ltx_bibblock">Preprint.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Elser, D., Huber, F. &amp;
Gaquerel, E.

</span>
<span class="ltx_bibblock">Mass2SMILES: deep learning based fast prediction of
structures and functional groups directly from high-resolution MS/MS
spectra.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">bioRxiv</em> (2023).

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:259834060" title="">https://api.semanticscholar.org/CorpusID:259834060</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Moorthy, A. S., Kearsley, A. J.,
Mallard, W. G., Wallace, W. E. &amp;
Stein, S. E.

</span>
<span class="ltx_bibblock">Inferring the nominal molecular mass of an analyte
from its electron ionization mass spectrum.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Analytical Chemistry</em>
<span class="ltx_text ltx_font_bold" id="bib.bib22.2.2">95</span>, 13132–13139
(2023).

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1021/acs.analchem.3c01815" title="">https://doi.org/10.1021/acs.analchem.3c01815</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Liu, Y. <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">et al.</em>
</span>
<span class="ltx_bibblock">Multilingual denoising pre-training for neural
machine translation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.2.1">Transactions of the Association for
Computational Linguistics</em> <span class="ltx_text ltx_font_bold" id="bib.bib23.3.2">8</span>,
726–742 (2020).

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1162/tacl_a_00343" title="">https://doi.org/10.1162/tacl_a_00343</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Hufsky, F., Rempt, M.,
Rasche, F., Pohnert, G. &amp;
Böcker, S.

</span>
<span class="ltx_bibblock">De novo analysis of electron impact mass spectra
using fragmentation trees.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Analytica Chimica Acta</em>
<span class="ltx_text ltx_font_bold" id="bib.bib24.2.2">739</span>, 67–76
(2012).

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.sciencedirect.com/science/article/pii/S0003267012008884" title="">https://www.sciencedirect.com/science/article/pii/S0003267012008884</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Wakoli, J. <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">et al.</em>
</span>
<span class="ltx_bibblock">Gcms-id: a webserver for identifying compounds from
gas chromatography mass spectrometry experiments.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.2.1">Nucleic Acids Research</em>
<span class="ltx_text ltx_font_bold" id="bib.bib25.3.2">52</span>, W381–W389
(2024).

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1093/nar/gkae425" title="">https://doi.org/10.1093/nar/gkae425</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Reymond, J.-L. &amp; Awale, M.

</span>
<span class="ltx_bibblock">Exploring chemical space for drug discovery using the
chemical universe database.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">ACS Chemical Neuroscience</em>
<span class="ltx_text ltx_font_bold" id="bib.bib26.2.2">3</span>, 649–657
(2012).

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1021/cn3000422" title="">https://doi.org/10.1021/cn3000422</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Vaswani, A. <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">et al.</em>
</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.2.1">Advances in neural information processing
systems</em> <span class="ltx_text ltx_font_bold" id="bib.bib27.3.2">30</span> (2017).

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper_files/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf" title="">https://proceedings.neurips.cc/paper_files/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
CONNEAU, A. &amp; Lample, G.

</span>
<span class="ltx_bibblock">Wallach, H. <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">et al.</em> (eds)
<em class="ltx_emph ltx_font_italic" id="bib.bib28.2.2">Cross-lingual language model pretraining</em>.

</span>
<span class="ltx_bibblock">(eds Wallach, H. <em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">et al.</em>)
<em class="ltx_emph ltx_font_italic" id="bib.bib28.4.2">Advances in Neural Information Processing
Systems</em>, Vol. 32 (Curran Associates,
Inc., 2019).

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper_files/paper/2019/file/c04c19c2c2474dbf5f7ac4372c5b9af1-Paper.pdf" title="">https://proceedings.neurips.cc/paper_files/paper/2019/file/c04c19c2c2474dbf5f7ac4372c5b9af1-Paper.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Krenn, M., Häse, F.,
Nigam, A., Friederich, P. &amp;
Aspuru-Guzik, A.

</span>
<span class="ltx_bibblock">Self-referencing embedded strings (selfies): A 100%
robust molecular string representation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Machine Learning: Science and Technology</em>
<span class="ltx_text ltx_font_bold" id="bib.bib29.2.2">1</span>, 045024 (2020).

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://dx.doi.org/10.1088/2632-2153/aba947" title="">https://dx.doi.org/10.1088/2632-2153/aba947</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Sennrich, R., Haddow, B. &amp;
Birch, A.

</span>
<span class="ltx_bibblock">Erk, K. &amp; Smith, N. A. (eds)
<em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Neural machine translation of rare words with subword
units</em>.

</span>
<span class="ltx_bibblock">(eds Erk, K. &amp; Smith, N. A.)
<em class="ltx_emph ltx_font_italic" id="bib.bib30.2.1">Proceedings of the 54th Annual Meeting of the
Association for Computational Linguistics (Volume 1: Long Papers)</em>,
1715–1725 (Association for
Computational Linguistics, Berlin, Germany,
2016).

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/P16-1162/" title="">https://aclanthology.org/P16-1162/</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Radford, A. &amp; Narasimhan, K.

</span>
<span class="ltx_bibblock">Improving language understanding by generative
pre-training (2018).

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:49313245" title="">https://api.semanticscholar.org/CorpusID:49313245</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Radford, A. <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">et al.</em>
</span>
<span class="ltx_bibblock">Language models are unsupervised multitask learners
(2019).

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:160025533" title="">https://api.semanticscholar.org/CorpusID:160025533</a>.

</span>
<span class="ltx_bibblock">OpenAI Technical Report.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Results</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Baseline results</h3>
<figure class="ltx_table" id="A1.T3">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T3.6">
<tr class="ltx_tr" id="A1.T3.6.7">
<td class="ltx_td ltx_border_r" id="A1.T3.6.7.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T3.6.7.2">NIST</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T3.6.7.3">SWGDRUG</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T3.6.7.4">Cayman</td>
<td class="ltx_td ltx_align_left" id="A1.T3.6.7.5">MONA</td>
</tr>
<tr class="ltx_tr" id="A1.T3.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T3.1.1.1">HSS<sub class="ltx_sub" id="A1.T3.1.1.1.1"><span class="ltx_text ltx_font_italic" id="A1.T3.1.1.1.1.1">50</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T3.1.1.2">45.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T3.1.1.3">55.2%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T3.1.1.4">58.2%</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.1.1.5">22.2%</td>
</tr>
<tr class="ltx_tr" id="A1.T3.2.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T3.2.2.1">HSS<sub class="ltx_sub" id="A1.T3.2.2.1.1"><span class="ltx_text ltx_font_italic" id="A1.T3.2.2.1.1.1">10</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T3.2.2.2">35.5%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T3.2.2.3">47.1%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T3.2.2.4">50.3%</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.2.2.5">16.0%</td>
</tr>
<tr class="ltx_tr" id="A1.T3.3.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T3.3.3.1">HSS<sub class="ltx_sub" id="A1.T3.3.3.1.1"><span class="ltx_text ltx_font_italic" id="A1.T3.3.3.1.1.1">1</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T3.3.3.2">18.8%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T3.3.3.3">21.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T3.3.3.4">23.9%</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.3.3.5">5.9%</td>
</tr>
<tr class="ltx_tr" id="A1.T3.4.4">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T3.4.4.1">SSS<sub class="ltx_sub" id="A1.T3.4.4.1.1"><span class="ltx_text ltx_font_italic" id="A1.T3.4.4.1.1.1">50</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T3.4.4.2">29.4%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T3.4.4.3">29.3%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T3.4.4.4">26.4%</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.4.4.5">16.1%</td>
</tr>
<tr class="ltx_tr" id="A1.T3.5.5">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T3.5.5.1">SSS<sub class="ltx_sub" id="A1.T3.5.5.1.1"><span class="ltx_text ltx_font_italic" id="A1.T3.5.5.1.1.1">10</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T3.5.5.2">23.2%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T3.5.5.3">23.2%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T3.5.5.4">23.5%</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.5.5.5">11.7%</td>
</tr>
<tr class="ltx_tr" id="A1.T3.6.6">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T3.6.6.1">SSS<sub class="ltx_sub" id="A1.T3.6.6.1.1"><span class="ltx_text ltx_font_italic" id="A1.T3.6.6.1.1.1">1</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T3.6.6.2">12.5%</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T3.6.6.3">9.5%</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T3.6.6.4">9.4%</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_t" id="A1.T3.6.6.5">5.2%</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Percentage of cases where database search methods (SSS and HSS) successfully retrieved the closest structure from the reference database among the top-1, top-10, and top-50 suggested candidates. Performance is evaluated across all test sets: NIST test split, SWGDRUG, Cayman, and MONA.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>SpecTUS results</h3>
<figure class="ltx_table" id="A1.T4">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T4.17">
<tr class="ltx_tr" id="A1.T4.17.18">
<td class="ltx_td ltx_border_r" id="A1.T4.17.18.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="2" id="A1.T4.17.18.2">NIST</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="2" id="A1.T4.17.18.3">SWGDRUG</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="2" id="A1.T4.17.18.4">Cayman</td>
<td class="ltx_td ltx_align_center" colspan="2" id="A1.T4.17.18.5">MONA</td>
</tr>
<tr class="ltx_tr" id="A1.T4.8.8">
<td class="ltx_td ltx_border_r" id="A1.T4.8.8.9"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T4.1.1.1">Sim<sub class="ltx_sub" id="A1.T4.1.1.1.1"><span class="ltx_text ltx_font_italic" id="A1.T4.1.1.1.1.1">k</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T4.2.2.2">Acc<sub class="ltx_sub" id="A1.T4.2.2.2.1"><span class="ltx_text ltx_font_italic" id="A1.T4.2.2.2.1.1">k</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T4.3.3.3">Sim<sub class="ltx_sub" id="A1.T4.3.3.3.1"><span class="ltx_text ltx_font_italic" id="A1.T4.3.3.3.1.1">k</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T4.4.4.4">Acc<sub class="ltx_sub" id="A1.T4.4.4.4.1"><span class="ltx_text ltx_font_italic" id="A1.T4.4.4.4.1.1">k</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T4.5.5.5">Sim<sub class="ltx_sub" id="A1.T4.5.5.5.1"><span class="ltx_text ltx_font_italic" id="A1.T4.5.5.5.1.1">k</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T4.6.6.6">Acc<sub class="ltx_sub" id="A1.T4.6.6.6.1"><span class="ltx_text ltx_font_italic" id="A1.T4.6.6.6.1.1">k</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T4.7.7.7">Sim<sub class="ltx_sub" id="A1.T4.7.7.7.1"><span class="ltx_text ltx_font_italic" id="A1.T4.7.7.7.1.1">k</span></sub>
</td>
<td class="ltx_td ltx_align_left" id="A1.T4.8.8.8">Acc<sub class="ltx_sub" id="A1.T4.8.8.8.1"><span class="ltx_text ltx_font_italic" id="A1.T4.8.8.8.1.1">k</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="A1.T4.17.19">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A1.T4.17.19.1">BDC</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A1.T4.17.19.2">0.72</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A1.T4.17.19.3">0.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A1.T4.17.19.4">0.68</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A1.T4.17.19.5">0.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A1.T4.17.19.6">0.68</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A1.T4.17.19.7">0.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A1.T4.17.19.8">0.70</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="A1.T4.17.19.9">0.0%</td>
</tr>
<tr class="ltx_tr" id="A1.T4.9.9">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.9.9.1">HSS<sub class="ltx_sub" id="A1.T4.9.9.1.1"><span class="ltx_text ltx_font_italic" id="A1.T4.9.9.1.1.1">50</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.9.9.2">0.62</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.9.9.3">0.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.9.9.4">0.61</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.9.9.5">0.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.9.9.6">0.61</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.9.9.7">0.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.9.9.8">0.47</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T4.9.9.9">0.0%</td>
</tr>
<tr class="ltx_tr" id="A1.T4.10.10">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.10.10.1">HSS<sub class="ltx_sub" id="A1.T4.10.10.1.1"><span class="ltx_text ltx_font_italic" id="A1.T4.10.10.1.1.1">10</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.10.10.2">0.57</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.10.10.3">0.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.10.10.4">0.58</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.10.10.5">0.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.10.10.6">0.57</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.10.10.7">0.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.10.10.8">0.42</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T4.10.10.9">0.0%</td>
</tr>
<tr class="ltx_tr" id="A1.T4.11.11">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.11.11.1">HSS<sub class="ltx_sub" id="A1.T4.11.11.1.1">1</sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.11.11.2">0.45</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.11.11.3">0.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.11.11.4">0.46</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.11.11.5">0.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.11.11.6">0.46</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.11.11.7">0.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.11.11.8">0.27</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T4.11.11.9">0.0%</td>
</tr>
<tr class="ltx_tr" id="A1.T4.12.12">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.12.12.1">SSS<sub class="ltx_sub" id="A1.T4.12.12.1.1"><span class="ltx_text ltx_font_italic" id="A1.T4.12.12.1.1.1">50</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.12.12.2">0.55</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.12.12.3">0.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.12.12.4">0.50</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.12.12.5">0.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.12.12.6">0.47</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.12.12.7">0.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.12.12.8">0.44</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T4.12.12.9">0.0%</td>
</tr>
<tr class="ltx_tr" id="A1.T4.13.13">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.13.13.1">SSS<sub class="ltx_sub" id="A1.T4.13.13.1.1"><span class="ltx_text ltx_font_italic" id="A1.T4.13.13.1.1.1">10</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.13.13.2">0.50</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.13.13.3">0.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.13.13.4">0.46</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.13.13.5">0.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.13.13.6">0.43</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.13.13.7">0.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.13.13.8">0.38</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T4.13.13.9">0.0%</td>
</tr>
<tr class="ltx_tr" id="A1.T4.14.14">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.14.14.1">SSS<sub class="ltx_sub" id="A1.T4.14.14.1.1">1</sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.14.14.2">0.39</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.14.14.3">0.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.14.14.4">0.34</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.14.14.5">0.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.14.14.6">0.34</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.14.14.7">0.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.14.14.8">0.26</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T4.14.14.9">0.0%</td>
</tr>
<tr class="ltx_tr" id="A1.T4.15.15">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T4.15.15.1">
<span class="ltx_rule" style="width:100%;height:1.2pt;background:black;display:inline-block;"> </span>
SpecTUS<sub class="ltx_sub" id="A1.T4.15.15.1.1"><span class="ltx_text ltx_font_italic" id="A1.T4.15.15.1.1.1">50</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T4.15.15.2">0.84</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T4.15.15.3">69.8%</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T4.15.15.4">0.86</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T4.15.15.5">64.6%</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T4.15.15.6">0.78</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T4.15.15.7">45.2%</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T4.15.15.8">0.58</td>
<td class="ltx_td ltx_align_left" id="A1.T4.15.15.9">37.2%</td>
</tr>
<tr class="ltx_tr" id="A1.T4.16.16">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.16.16.1">SpecTUS<sub class="ltx_sub" id="A1.T4.16.16.1.1"><span class="ltx_text ltx_font_italic" id="A1.T4.16.16.1.1.1">10</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.16.16.2">0.81</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.16.16.3">65.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.16.16.4">0.82</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.16.16.5">58.5%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.16.16.6">0.74</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.16.16.7">38.8%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.16.16.8">0.54</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T4.16.16.9">34.0%</td>
</tr>
<tr class="ltx_tr" id="A1.T4.17.17">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T4.17.17.1">SpecTUS<sub class="ltx_sub" id="A1.T4.17.17.1.1">1</sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T4.17.17.2">0.67</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T4.17.17.3">43.3%</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T4.17.17.4">0.69</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T4.17.17.5">35.0%</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T4.17.17.6">0.60</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T4.17.17.7">20.7%</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T4.17.17.8">0.41</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_t" id="A1.T4.17.17.9">20.8%</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Comparison of Sim<sub class="ltx_sub" id="A1.T4.24.1"><span class="ltx_text ltx_font_italic" id="A1.T4.24.1.1">k</span></sub> and Acc<sub class="ltx_sub" id="A1.T4.25.2"><span class="ltx_text ltx_font_italic" id="A1.T4.25.2.1">k</span></sub> metrics between the final SpecTUS model and database search methods across all testing datasets (NIST test, SWGDRUG, Cayman, MONA).</figcaption>
</figure>
<figure class="ltx_table" id="A1.T5">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T5.3">
<tr class="ltx_tr" id="A1.T5.3.4">
<td class="ltx_td ltx_border_r" id="A1.T5.3.4.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.3.4.2">BDC</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.3.4.3">HSS</td>
<td class="ltx_td ltx_align_left" id="A1.T5.3.4.4">SSS</td>
</tr>
<tr class="ltx_tr" id="A1.T5.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T5.1.1.1">SpecTUS<sub class="ltx_sub" id="A1.T5.1.1.1.1">1</sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T5.1.1.2">46.8% <span class="ltx_text ltx_font_bold" id="A1.T5.1.1.2.1">/</span> 50.8%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T5.1.1.3">76.4% <span class="ltx_text ltx_font_bold" id="A1.T5.1.1.3.1">/</span> 83.6%</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T5.1.1.4">79.6% <span class="ltx_text ltx_font_bold" id="A1.T5.1.1.4.1">/</span> 88.1%</td>
</tr>
<tr class="ltx_tr" id="A1.T5.2.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T5.2.2.1">SpecTUS<sub class="ltx_sub" id="A1.T5.2.2.1.1"><span class="ltx_text ltx_font_italic" id="A1.T5.2.2.1.1.1">10</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T5.2.2.2">69.9% <span class="ltx_text ltx_font_bold" id="A1.T5.2.2.2.1">/</span> 72.2%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T5.2.2.3">84.4% <span class="ltx_text ltx_font_bold" id="A1.T5.2.2.3.1">/</span> 87.3%</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T5.2.2.4">87.8% <span class="ltx_text ltx_font_bold" id="A1.T5.2.2.4.1">/</span> 91.2%</td>
</tr>
<tr class="ltx_tr" id="A1.T5.3.3">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T5.3.3.1">SpecTUS<sub class="ltx_sub" id="A1.T5.3.3.1.1"><span class="ltx_text ltx_font_italic" id="A1.T5.3.3.1.1.1">50</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T5.3.3.2">75.8% <span class="ltx_text ltx_font_bold" id="A1.T5.3.3.2.1">/</span> 77.9%</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T5.3.3.3">85.6% <span class="ltx_text ltx_font_bold" id="A1.T5.3.3.3.1">/</span> 88.0%</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_t" id="A1.T5.3.3.4">88.9% <span class="ltx_text ltx_font_bold" id="A1.T5.3.3.4.1">/</span> 91.9%</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span><span class="ltx_text ltx_font_italic" id="A1.T5.10.1">Win Rate</span> <span class="ltx_text ltx_font_bold" id="A1.T5.11.2">/</span> <span class="ltx_text ltx_font_italic" id="A1.T5.12.3">At-least-as-good Rate</span> of SpecTUS over database search methods on the <span class="ltx_text ltx_font_bold" id="A1.T5.13.4">NIST test</span> set. For all values, the compared performance involves the same number of candidates, e.g., <math alttext="\text{ALAG}(\text{SpecTUS}_{10},\text{HSS}_{10}" class="ltx_math_unparsed" display="inline" id="A1.T5.5.m1.1"><semantics id="A1.T5.5.m1.1b"><mrow id="A1.T5.5.m1.1c"><mtext id="A1.T5.5.m1.1.1">ALAG</mtext><mrow id="A1.T5.5.m1.1.2"><mo id="A1.T5.5.m1.1.2.1" stretchy="false">(</mo><msub id="A1.T5.5.m1.1.2.2"><mtext id="A1.T5.5.m1.1.2.2.2">SpecTUS</mtext><mn id="A1.T5.5.m1.1.2.2.3">10</mn></msub><mo id="A1.T5.5.m1.1.2.3">,</mo><msub id="A1.T5.5.m1.1.2.4"><mtext id="A1.T5.5.m1.1.2.4.2">HSS</mtext><mn id="A1.T5.5.m1.1.2.4.3">10</mn></msub></mrow></mrow><annotation encoding="application/x-tex" id="A1.T5.5.m1.1d">\text{ALAG}(\text{SpecTUS}_{10},\text{HSS}_{10}</annotation><annotation encoding="application/x-llamapun" id="A1.T5.5.m1.1e">ALAG ( SpecTUS start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT , HSS start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT</annotation></semantics></math>).</figcaption>
</figure>
<figure class="ltx_table" id="A1.T6">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T6.3">
<tr class="ltx_tr" id="A1.T6.3.4">
<td class="ltx_td ltx_border_r" id="A1.T6.3.4.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.3.4.2">BDC</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T6.3.4.3">HSS</td>
<td class="ltx_td ltx_align_left" id="A1.T6.3.4.4">SSS</td>
</tr>
<tr class="ltx_tr" id="A1.T6.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T6.1.1.1">SpecTUS<sub class="ltx_sub" id="A1.T6.1.1.1.1">1</sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T6.1.1.2">44.8% <span class="ltx_text ltx_font_bold" id="A1.T6.1.1.2.1">/</span> 49.5%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T6.1.1.3">72.3% <span class="ltx_text ltx_font_bold" id="A1.T6.1.1.3.1">/</span> 81.2%</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T6.1.1.4">87.7% <span class="ltx_text ltx_font_bold" id="A1.T6.1.1.4.1">/</span> 90.2%</td>
</tr>
<tr class="ltx_tr" id="A1.T6.2.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T6.2.2.1">SpecTUS<sub class="ltx_sub" id="A1.T6.2.2.1.1"><span class="ltx_text ltx_font_italic" id="A1.T6.2.2.1.1.1">10</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T6.2.2.2">70.2% <span class="ltx_text ltx_font_bold" id="A1.T6.2.2.2.1">/</span> 73.7%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T6.2.2.3">81.3% <span class="ltx_text ltx_font_bold" id="A1.T6.2.2.3.1">/</span> 84.9%</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T6.2.2.4">88.9% <span class="ltx_text ltx_font_bold" id="A1.T6.2.2.4.1">/</span> 92.3%</td>
</tr>
<tr class="ltx_tr" id="A1.T6.3.3">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T6.3.3.1">SpecTUS<sub class="ltx_sub" id="A1.T6.3.3.1.1"><span class="ltx_text ltx_font_italic" id="A1.T6.3.3.1.1.1">50</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T6.3.3.2">77.5% <span class="ltx_text ltx_font_bold" id="A1.T6.3.3.2.1">/</span> 80.7%</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T6.3.3.3">85.3% <span class="ltx_text ltx_font_bold" id="A1.T6.3.3.3.1">/</span> 88.0%</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_t" id="A1.T6.3.3.4">90.9% <span class="ltx_text ltx_font_bold" id="A1.T6.3.3.4.1">/</span> 93.1%</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span><span class="ltx_text ltx_font_italic" id="A1.T6.10.1">Win Rate</span> <span class="ltx_text ltx_font_bold" id="A1.T6.11.2">/</span> <span class="ltx_text ltx_font_italic" id="A1.T6.12.3">At-least-as-good Rate</span> of SpecTUS over database search methods on the <span class="ltx_text ltx_font_bold" id="A1.T6.13.4">SWGDRUG</span> dataset. For all values, the compared performance involves the same number of candidates, e.g., <math alttext="\text{ALAG}(\text{SpecTUS}_{10},\text{HSS}_{10}" class="ltx_math_unparsed" display="inline" id="A1.T6.5.m1.1"><semantics id="A1.T6.5.m1.1b"><mrow id="A1.T6.5.m1.1c"><mtext id="A1.T6.5.m1.1.1">ALAG</mtext><mrow id="A1.T6.5.m1.1.2"><mo id="A1.T6.5.m1.1.2.1" stretchy="false">(</mo><msub id="A1.T6.5.m1.1.2.2"><mtext id="A1.T6.5.m1.1.2.2.2">SpecTUS</mtext><mn id="A1.T6.5.m1.1.2.2.3">10</mn></msub><mo id="A1.T6.5.m1.1.2.3">,</mo><msub id="A1.T6.5.m1.1.2.4"><mtext id="A1.T6.5.m1.1.2.4.2">HSS</mtext><mn id="A1.T6.5.m1.1.2.4.3">10</mn></msub></mrow></mrow><annotation encoding="application/x-tex" id="A1.T6.5.m1.1d">\text{ALAG}(\text{SpecTUS}_{10},\text{HSS}_{10}</annotation><annotation encoding="application/x-llamapun" id="A1.T6.5.m1.1e">ALAG ( SpecTUS start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT , HSS start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT</annotation></semantics></math>).</figcaption>
</figure>
<figure class="ltx_table" id="A1.T7">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T7.3">
<tr class="ltx_tr" id="A1.T7.3.4">
<td class="ltx_td ltx_border_r" id="A1.T7.3.4.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T7.3.4.2">BDC</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T7.3.4.3">HSS</td>
<td class="ltx_td ltx_align_left" id="A1.T7.3.4.4">SSS</td>
</tr>
<tr class="ltx_tr" id="A1.T7.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T7.1.1.1">SpecTUS<sub class="ltx_sub" id="A1.T7.1.1.1.1">1</sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T7.1.1.2">31.3% <span class="ltx_text ltx_font_bold" id="A1.T7.1.1.2.1">/</span> 35.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T7.1.1.3">63.1% <span class="ltx_text ltx_font_bold" id="A1.T7.1.1.3.1">/</span> 67.4%</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T7.1.1.4">77.0% <span class="ltx_text ltx_font_bold" id="A1.T7.1.1.4.1">/</span> 81.7%</td>
</tr>
<tr class="ltx_tr" id="A1.T7.2.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T7.2.2.1">SpecTUS<sub class="ltx_sub" id="A1.T7.2.2.1.1"><span class="ltx_text ltx_font_italic" id="A1.T7.2.2.1.1.1">10</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T7.2.2.2">56.3% <span class="ltx_text ltx_font_bold" id="A1.T7.2.2.2.1">/</span> 60.3%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T7.2.2.3">71.0% <span class="ltx_text ltx_font_bold" id="A1.T7.2.2.3.1">/</span> 74.2%</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T7.2.2.4">82.7% <span class="ltx_text ltx_font_bold" id="A1.T7.2.2.4.1">/</span> 84.6%</td>
</tr>
<tr class="ltx_tr" id="A1.T7.3.3">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T7.3.3.1">SpecTUS<sub class="ltx_sub" id="A1.T7.3.3.1.1"><span class="ltx_text ltx_font_italic" id="A1.T7.3.3.1.1.1">50</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T7.3.3.2">64.2% <span class="ltx_text ltx_font_bold" id="A1.T7.3.3.2.1">/</span> 68.7%</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T7.3.3.3">74.2% <span class="ltx_text ltx_font_bold" id="A1.T7.3.3.3.1">/</span> 77.2%</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_t" id="A1.T7.3.3.4">84.2% <span class="ltx_text ltx_font_bold" id="A1.T7.3.3.4.1">/</span> 86.4%</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span><span class="ltx_text ltx_font_italic" id="A1.T7.10.1">Win Rate</span> <span class="ltx_text ltx_font_bold" id="A1.T7.11.2">/</span> <span class="ltx_text ltx_font_italic" id="A1.T7.12.3">At-least-as-good Rate</span> of SpecTUS over database search methods on the <span class="ltx_text ltx_font_bold" id="A1.T7.13.4">Cayman</span> library. For all values, the compared performance involves the same number of candidates, e.g., <math alttext="\text{ALAG}(\text{SpecTUS}_{10},\text{HSS}_{10}" class="ltx_math_unparsed" display="inline" id="A1.T7.5.m1.1"><semantics id="A1.T7.5.m1.1b"><mrow id="A1.T7.5.m1.1c"><mtext id="A1.T7.5.m1.1.1">ALAG</mtext><mrow id="A1.T7.5.m1.1.2"><mo id="A1.T7.5.m1.1.2.1" stretchy="false">(</mo><msub id="A1.T7.5.m1.1.2.2"><mtext id="A1.T7.5.m1.1.2.2.2">SpecTUS</mtext><mn id="A1.T7.5.m1.1.2.2.3">10</mn></msub><mo id="A1.T7.5.m1.1.2.3">,</mo><msub id="A1.T7.5.m1.1.2.4"><mtext id="A1.T7.5.m1.1.2.4.2">HSS</mtext><mn id="A1.T7.5.m1.1.2.4.3">10</mn></msub></mrow></mrow><annotation encoding="application/x-tex" id="A1.T7.5.m1.1d">\text{ALAG}(\text{SpecTUS}_{10},\text{HSS}_{10}</annotation><annotation encoding="application/x-llamapun" id="A1.T7.5.m1.1e">ALAG ( SpecTUS start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT , HSS start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT</annotation></semantics></math>).</figcaption>
</figure>
<figure class="ltx_table" id="A1.T8">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T8.3">
<tr class="ltx_tr" id="A1.T8.3.4">
<td class="ltx_td ltx_border_r" id="A1.T8.3.4.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T8.3.4.2">BDC</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T8.3.4.3">HSS</td>
<td class="ltx_td ltx_align_left" id="A1.T8.3.4.4">SSS</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.1.1">SpecTUS<sub class="ltx_sub" id="A1.T8.1.1.1.1">1</sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.1.2">21.3% <span class="ltx_text ltx_font_bold" id="A1.T8.1.1.2.1">/</span> 23.4%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.1.3">65.0% <span class="ltx_text ltx_font_bold" id="A1.T8.1.1.3.1">/</span> 70.6%</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T8.1.1.4">65.5% <span class="ltx_text ltx_font_bold" id="A1.T8.1.1.4.1">/</span> 72.4%</td>
</tr>
<tr class="ltx_tr" id="A1.T8.2.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.2.2.1">SpecTUS<sub class="ltx_sub" id="A1.T8.2.2.1.1"><span class="ltx_text ltx_font_italic" id="A1.T8.2.2.1.1.1">10</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.2.2.2">35.6% <span class="ltx_text ltx_font_bold" id="A1.T8.2.2.2.1">/</span> 37.4%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.2.2.3">63.7% <span class="ltx_text ltx_font_bold" id="A1.T8.2.2.3.1">/</span> 66.8%</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T8.2.2.4">66.8% <span class="ltx_text ltx_font_bold" id="A1.T8.2.2.4.1">/</span> 70.4%</td>
</tr>
<tr class="ltx_tr" id="A1.T8.3.3">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T8.3.3.1">SpecTUS<sub class="ltx_sub" id="A1.T8.3.3.1.1"><span class="ltx_text ltx_font_italic" id="A1.T8.3.3.1.1.1">50</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T8.3.3.2">39.6% <span class="ltx_text ltx_font_bold" id="A1.T8.3.3.2.1">/</span> 41.6%</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T8.3.3.3">61.6% <span class="ltx_text ltx_font_bold" id="A1.T8.3.3.3.1">/</span> 64.9%</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_t" id="A1.T8.3.3.4">64.2% <span class="ltx_text ltx_font_bold" id="A1.T8.3.3.4.1">/</span> 68.0%</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span><span class="ltx_text ltx_font_italic" id="A1.T8.10.1">Win Rate</span> <span class="ltx_text ltx_font_bold" id="A1.T8.11.2">/</span> <span class="ltx_text ltx_font_italic" id="A1.T8.12.3">At-least-as-good Rate</span> of SpecTUS over database search methods on the <span class="ltx_text ltx_font_bold" id="A1.T8.13.4">MONA</span> library. For all values, the compared performance involves the same number of candidates, e.g., <math alttext="\text{ALAG}(\text{SpecTUS}_{10},\text{HSS}_{10}" class="ltx_math_unparsed" display="inline" id="A1.T8.5.m1.1"><semantics id="A1.T8.5.m1.1b"><mrow id="A1.T8.5.m1.1c"><mtext id="A1.T8.5.m1.1.1">ALAG</mtext><mrow id="A1.T8.5.m1.1.2"><mo id="A1.T8.5.m1.1.2.1" stretchy="false">(</mo><msub id="A1.T8.5.m1.1.2.2"><mtext id="A1.T8.5.m1.1.2.2.2">SpecTUS</mtext><mn id="A1.T8.5.m1.1.2.2.3">10</mn></msub><mo id="A1.T8.5.m1.1.2.3">,</mo><msub id="A1.T8.5.m1.1.2.4"><mtext id="A1.T8.5.m1.1.2.4.2">HSS</mtext><mn id="A1.T8.5.m1.1.2.4.3">10</mn></msub></mrow></mrow><annotation encoding="application/x-tex" id="A1.T8.5.m1.1d">\text{ALAG}(\text{SpecTUS}_{10},\text{HSS}_{10}</annotation><annotation encoding="application/x-llamapun" id="A1.T8.5.m1.1e">ALAG ( SpecTUS start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT , HSS start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT</annotation></semantics></math>).</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Methods</h2>
<figure class="ltx_figure" id="A2.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="238" id="A2.F6.g1" src="extracted/6187077/figures/max_mz_filter.png" width="293"/></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="238" id="A2.F6.g2" src="extracted/6187077/figures/num_of_peaks_filter.png" width="293"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="238" id="A2.F6.g3" src="extracted/6187077/figures/smiles_len_filter.png" width="293"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Frequency plots of the three data filtering criteria, measured on the NIST train set.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Experiments</h2>
<figure class="ltx_table" id="A3.T9">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A3.T9.4">
<tr class="ltx_tr" id="A3.T9.4.4">
<td class="ltx_td ltx_border_r" id="A3.T9.4.4.5"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A3.T9.1.1.1">Acc<sub class="ltx_sub" id="A3.T9.1.1.1.1">1</sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A3.T9.2.2.2">Acc<sub class="ltx_sub" id="A3.T9.2.2.2.1"><span class="ltx_text ltx_font_italic" id="A3.T9.2.2.2.1.1">10</span></sub>
</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="A3.T9.3.3.3">Sim<sub class="ltx_sub" id="A3.T9.3.3.3.1">1</sub>
</td>
<td class="ltx_td ltx_align_left" id="A3.T9.4.4.4">Sim<sub class="ltx_sub" id="A3.T9.4.4.4.1"><span class="ltx_text ltx_font_italic" id="A3.T9.4.4.4.1.1">10</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.5">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.5.1">exp5: 8.6M_448k+296k (SpecTUS)</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.5.2">43.3%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.5.3">64.8%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.5.4">0.67</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.4.5.5">0.81</td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.6">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.6.1">exp5: 8.6M_224k+148k</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.6.2">40.7%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.6.3">62.8%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.6.4">0.65</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.4.6.5">0.80</td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.7">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.7.1">exp5: 4.2M_224k_148k</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.7.2">39.8%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.7.3">61.8%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.7.4">0.64</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.4.7.5">0.79</td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.8">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.8.1">exp5: 4.2M_224k_74k</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.8.2">39.1%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.8.3">61.8%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.8.4">0.64</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.4.8.5">0.79</td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.9">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.9.1">exp4: one src token</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.9.2">38.1%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.9.3">61.4%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.9.4">0.63</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.4.9.5">0.79</td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.10">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.10.1">exp3: RASSP:NEIMS / exp5: 4.2M_112k_74k</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.10.2">37.9%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.10.3">60.7%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.10.4">0.63</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.4.10.5">0.78</td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.11">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.11.1">exp3: RASSP:NEIMS:NIST</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.11.2">37.6%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.11.3">60.6%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.11.4">0.62</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.4.11.5">0.78</td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.12">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.12.1">exp3: NEIMS-only</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.12.2">36.8%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.12.3">59.7%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.12.4">0.62</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.4.12.5">0.77</td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.13">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.13.1">exp3: RASSP-only</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.13.2">34.8%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.13.3">57.6%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.13.4">0.61</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.4.13.5">0.76</td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.14">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.14.1">exp1: log30bins / exp2: mf10M (char-level) / exp3: no pretraining</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.14.2">28.1%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.14.3">50.7%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.14.4">0.56</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.4.14.5">0.72</td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.15">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.15.1">exp1: log40bins</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.15.2">27.6%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.15.3">49.7%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.15.4">0.55</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.4.15.5">0.72</td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.16">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.16.1">exp1: lin4dec</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.16.2">27.4%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.16.3">49.9%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.16.4">0.55</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.4.16.5">0.72</td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.17">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.17.1">exp1: lin3dec</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.17.2">27.3%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.17.3">49.8%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.17.4">0.55</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.4.17.5">0.72</td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.18">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.18.1">exp1: log21bins</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.18.2">27.2%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.18.3">49.6%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.18.4">0.55</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.4.18.5">0.72</td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.19">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.19.1">exp1: log10bins</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.19.2">24.7%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.19.3">47.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.19.4">0.54</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.4.19.5">0.70</td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.20">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.20.1">exp2: mf10K</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.20.2">24.5%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.20.3">46.4%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.20.4">0.54</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.4.20.5">0.70</td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.21">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.21.1">exp2: mf100</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.21.2">24.5%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.21.3">47.2%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.21.4">0.55</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.4.21.5">0.71</td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.22">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.22.1">exp2 mf10</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.22.2">24.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.22.3">46.1%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.22.4">0.54</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.4.22.5">0.70</td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.23">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.23.1">exp1: lin2dec</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.23.2">24.0%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.23.3">46.1%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A3.T9.4.23.4">0.53</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A3.T9.4.23.5">0.69</td>
</tr>
<tr class="ltx_tr" id="A3.T9.4.24">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A3.T9.4.24.1">exp2: SELFIES</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A3.T9.4.24.2">22.3%</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A3.T9.4.24.3">41.1%</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A3.T9.4.24.4">0.49</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_t" id="A3.T9.4.24.5">0.65</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 9: </span>Summary of all experiments conducted during the development of the final SpecTUS model. The metrics were evaluated on the NIST validation set. The experiments are ordered by Acc<sub class="ltx_sub" id="A3.T9.8.1">1</sub> values, which served as the primary criterion for assessing the results.</figcaption>
</figure>
<section class="ltx_subsection" id="A3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Experiment 1: Intensity binning</h3>
<figure class="ltx_figure" id="A3.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="263" id="A3.F7.g1" src="extracted/6187077/figures/histo_10bin.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Bin frequency plot after logarithmic binning with a log base of 2.2 and a shift of 9, producing 10 bins. The distribution is calculated on our train split of the NIST dataset.</figcaption>
</figure>
<figure class="ltx_figure" id="A3.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="263" id="A3.F8.g1" src="extracted/6187077/figures/histo_21bin.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Bin frequency plot after logarithmic binning with a log base of 1.43 and a shift of 20, producing 21 bins. The distribution is calculated on our train split of the NIST dataset.</figcaption>
</figure>
<figure class="ltx_figure" id="A3.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="263" id="A3.F9.g1" src="extracted/6187077/figures/histo_30bin.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Bin frequency plot after logarithmic binning with a log base of 1.28 and a shift of 29, producing 30 bins. The distribution is calculated on our train split of the NIST dataset.</figcaption>
</figure>
<figure class="ltx_figure" id="A3.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="263" id="A3.F10.g1" src="extracted/6187077/figures/histo_40bin.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Bin frequency plot after logarithmic binning with a log base of 1.2 and a shift of 39, producing 40 bins. The distribution is calculated on our train split of the NIST dataset.</figcaption>
</figure>
<figure class="ltx_figure" id="A3.F11"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="341" id="A3.F11.g1" src="extracted/6187077/figures/exp_binning.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Tracked control evaluations of the <span class="ltx_text ltx_font_bold" id="A3.F11.8.1">intensity binning</span> experiment.
Displays the dependency of Acc<sub class="ltx_sub" id="A3.F11.9.2">1</sub> on global step measured on the full NIST validation set. The table shows the final Acc<sub class="ltx_sub" id="A3.F11.10.3">1</sub> values.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_subsection" id="A3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.2 </span>Experiment 2: Molecular Representations and Tokenization</h3>
<figure class="ltx_figure" id="A3.F12"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="270" id="A3.F12.g1" src="extracted/6187077/figures/selected_tokenizers.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>Dependence of the number of learned tokens on the minimal frequency parameter. The highlighted points denote the tokenizers that we selected for examination. The x-axis is in logarithmic scale.</figcaption>
</figure>
<figure class="ltx_figure" id="A3.F13"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="338" id="A3.F13.g1" src="extracted/6187077/figures/exp_token.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span>Tracked control evaluations of the <span class="ltx_text ltx_font_bold" id="A3.F13.8.1">tokenization</span> experiment.
Displays the dependency of Acc<sub class="ltx_sub" id="A3.F13.9.2">1</sub> on global step measured on the full NIST validation set. The table shows the final Acc<sub class="ltx_sub" id="A3.F13.10.3">1</sub> values.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_subsection" id="A3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.3 </span>Experiment 3: Pretraining dataset mixing</h3>
<figure class="ltx_figure" id="A3.F14"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="337" id="A3.F14.g1" src="extracted/6187077/figures/exp_mixing.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 14: </span>Tracked control evaluations of the <span class="ltx_text ltx_font_bold" id="A3.F14.8.1">pretraining dataset mixing</span> experiment.
Displays the dependency of Acc<sub class="ltx_sub" id="A3.F14.9.2">1</sub> on global step measured on the full NIST validation set. The table shows the final Acc<sub class="ltx_sub" id="A3.F14.10.3">1</sub> values.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_subsection" id="A3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.4 </span>Experiment 4: Source indication</h3>
<figure class="ltx_figure" id="A3.F15"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="339" id="A3.F15.g1" src="extracted/6187077/figures/exp_source_ind.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 15: </span>Tracked control evaluations of the <span class="ltx_text ltx_font_bold" id="A3.F15.8.1">source indication</span> experiment.
Displays the dependency of Acc<sub class="ltx_sub" id="A3.F15.9.2">1</sub> on global step measured on the full NIST validation set. The table shows the final Acc<sub class="ltx_sub" id="A3.F15.10.3">1</sub> values.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_subsection" id="A3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.5 </span>Experiment 5: Training length and dataset size</h3>
<figure class="ltx_figure" id="A3.F16"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="340" id="A3.F16.g1" src="extracted/6187077/figures/exp_train_len.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 16: </span>Tracked control evaluations of the <span class="ltx_text ltx_font_bold" id="A3.F16.8.1">training length and dataset size</span> experiment.
Displays the dependency of Acc<sub class="ltx_sub" id="A3.F16.9.2">1</sub> on global step measured on the full NIST validation set. The table shows the final Acc<sub class="ltx_sub" id="A3.F16.10.3">1</sub> values.</figcaption>
</figure>
</section>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Feb  7 17:32:54 2025 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
